(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,function(e,t,n){"use strict";var o=L(n(6)),r=L(n(11)),i=L(n(34)),a=L(n(141)),s=L(n(140)),u=L(n(44)),l=L(n(55)),c=L(n(43)),f=L(n(139)),h=L(n(288)),d=L(n(33)),v=L(n(287)),p=L(n(54)),_=L(n(138)),m=L(n(286)),b=L(n(76)),y=L(n(137)),g=L(n(75)),x=L(n(285)),w=L(n(74)),E=L(n(284)),O=L(n(283)),M=L(n(281)),P=L(n(279)),T=L(n(276)),S=L(n(275)),R=L(n(273)),C=L(n(271)),A=L(n(270)),k=L(n(268));function L(e){return e&&e.__esModule?e:{default:e}}function D(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var j=new(function(){function e(){for(var t in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.glm=o.default,this.GL=r.default,this.GLTool=r.default,this.GLShader=i.default,this.GLTexture=a.default,this.GLCubeTexture=s.default,this.Mesh=u.default,this.Geom=l.default,this.Batch=c.default,this.FrameBuffer=f.default,this.CubeFrameBuffer=h.default,this.Scheduler=d.default,this.EventDispatcher=v.default,this.EaseNumber=p.default,this.Camera=b.default,this.CameraOrtho=y.default,this.CameraPerspective=g.default,this.CameraCube=x.default,this.OrbitalControl=_.default,this.QuatRotation=m.default,this.BinaryLoader=w.default,this.ObjLoader=E.default,this.HDRLoader=O.default,this.BatchCopy=M.default,this.BatchAxis=P.default,this.BatchBall=T.default,this.BatchBall=T.default,this.BatchDotsPlane=S.default,this.Scene=R.default,this.View=C.default,this.EffectComposer=k.default,this.ShaderLibs=A.default,o.default)o.default[t]&&(window[t]=o.default[t])}var t,n,L;return t=e,(n=[{key:"log",value:function(){for(var e in navigator.userAgent.indexOf("Chrome")>-1?console.log("%clib alfrid : VERSION 0.0.1","background: #193441; color: #FCFFF5"):console.log("lib alfrid : VERSION ","0.0.1"),console.log("%cClasses : ","color: #193441"),this)this[e]&&console.log("%c - "+e,"color: #3E606F")}}])&&D(t.prototype,n),L&&D(t,L),e}());e.exports=j},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAsset=function(e){for(var t=0;t<assets.length;t++)if(e===assets[t].id)return assets[t].file},t.getMouse=function(e,t){var n=t||{};e.touches?(n.x=e.touches[0].pageX,n.y=e.touches[0].pageY):(n.x=e.clientX,n.y=e.clientY);return n},t.default=void 0;var o={calculateNormals:function(e,t){for(var n=[],o=0;o<e.length;o+=3)n[o+0]=0,n[o+1]=0,n[o+2]=0;for(o=0;o<t.length;o+=3){var r=[],i=[],a=[];for(r[0]=e[3*t[o+2]+0]-e[3*t[o+1]+0],r[1]=e[3*t[o+2]+1]-e[3*t[o+1]+1],r[2]=e[3*t[o+2]+2]-e[3*t[o+1]+2],i[0]=e[3*t[o]+0]-e[3*t[o+1]+0],i[1]=e[3*t[o]+1]-e[3*t[o+1]+1],i[2]=e[3*t[o]+2]-e[3*t[o+1]+2],a[0]=r[1]*i[2]-r[2]*i[1],a[1]=r[2]*i[0]-r[0]*i[2],a[2]=r[0]*i[1]-r[1]*i[0],j=0;j<3;j++)n[3*t[o+j]+0]=n[3*t[o+j]+0]+a[0],n[3*t[o+j]+1]=n[3*t[o+j]+1]+a[1],n[3*t[o+j]+2]=n[3*t[o+j]+2]+a[2]}for(o=0;o<e.length;o+=3){var s=[];s[0]=n[o+0],s[1]=n[o+1],s[2]=n[o+2];var u=Math.sqrt(s[0]*s[0]+s[1]*s[1]+s[2]*s[2]);0==u&&(u=1),s[0]=s[0]/u,s[1]=s[1]/u,s[2]=s[2]/u,n[o+0]=s[0],n[o+1]=s[1],n[o+2]=s[2]}return n},calculateTangents:function(e,t){for(var n=e,o=[],r=0;r<n.length;r++)o[r]=0;return o},getRandom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=void 0;if(e.length){for(;!t;){t=e[Math.floor(Math.random()*e.length)]}return t}},resizeEl:function(e,t,n,o,r,i){var a,s,u,l=n/o,c=r/i;a=l>c?n/r:o/i,l===c?s=u=0:(s=.5*(n-r*a)/a,u=.5*(o-i*a)/a),s=Number(s.toFixed(1)),u=Number(u.toFixed(1)),e.css("transform","scale3d("+a+", "+a+", 1) translate3d("+s+"px,"+u+"px,0)"),e.css("transform-origin","0% 0% 0px")}};t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}(n(6));function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas,this._viewport=[0,0,0,0],this._enabledVertexAttribute=[],console.log(o),this.identityMatrix=o.mat4.create(),this._normalMatrix=o.mat3.create(),this._inverseModelViewMatrix=o.mat3.create(),this._modelMatrix=o.mat4.create(),this._matrix=o.mat4.create(),o.mat4.identity(this.identityMatrix,this.identityMatrix),this.isMobile=!1,/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(this.isMobile=!0)}var t,n,i;return t=e,(n=[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null!==e&&void 0!==e){void 0!==this.canvas&&null!==this.canvas&&this.destroy(),this.canvas=e,this.setSize(window.innerWidth,window.innerHeight),this.gl=this.canvas.getContext("webgl",t)||this.canvas.getContext("experimental-webgl",t);var n=["EXT_shader_texture_lod","EXT_sRGB","EXT_frag_depth","OES_texture_float","OES_texture_half_float","OES_texture_float_linear","OES_texture_half_float_linear","OES_standard_derivatives","WEBGL_depth_texture"];this.extensions={};for(var o=0;o<n.length;o++)this.extensions[n[o]]=this.gl.getExtension(n[o]);var r=this.gl;this.VERTEX_SHADER=r.VERTEX_SHADER,this.FRAGMENT_SHADER=r.FRAGMENT_SHADER,this.COMPILE_STATUS=r.COMPILE_STATUS,this.DEPTH_TEST=r.DEPTH_TEST,this.CULL_FACE=r.CULL_FACE,this.BLEND=r.BLEND,this.POINTS=r.POINTS,this.LINES=r.LINES,this.TRIANGLES=r.TRIANGLES,this.LINEAR=r.LINEAR,this.NEAREST=r.NEAREST,this.LINEAR_MIPMAP_NEAREST=r.LINEAR_MIPMAP_NEAREST,this.MIRRORED_REPEAT=r.MIRRORED_REPEAT,this.CLAMP_TO_EDGE=r.CLAMP_TO_EDGE,this.SCISSOR_TEST=r.SCISSOR_TEST,this.enable(this.DEPTH_TEST),this.enable(this.CULL_FACE),this.enable(this.BLEND)}else console.error("Canvas not exist")}},{key:"setViewport",value:function(e,t,n,o){var r=!1;e!==this._viewport[0]&&(r=!0),t!==this._viewport[1]&&(r=!0),n!==this._viewport[2]&&(r=!0),o!==this._viewport[3]&&(r=!0),r&&(this.gl.viewport(e,t,n,o),this._viewport=[e,t,n,o])}},{key:"scissor",value:function(e,t,n,o){this.gl.scissor(e,t,n,o)}},{key:"clear",value:function(e,t,n,o){this.gl.clearColor(e,t,n,o),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},{key:"setMatrices",value:function(e){this.camera=e,this.rotate(this.identityMatrix)}},{key:"useShader",value:function(e){this.shader=e,this.shaderProgram=this.shader.shaderProgram}},{key:"useLight",value:function(e){e?(this.light=e,this._lightEnabled=!0):this._lightEnabled=!1}},{key:"rotate",value:function(e){o.mat4.copy(this._modelMatrix,e),o.mat4.multiply(this._matrix,this.camera.matrix,this._modelMatrix),o.mat3.fromMat4(this._normalMatrix,this._matrix),o.mat3.invert(this._normalMatrix,this._normalMatrix),o.mat3.transpose(this._normalMatrix,this._normalMatrix),o.mat3.fromMat4(this._inverseModelViewMatrix,this._matrix),o.mat3.invert(this._inverseModelViewMatrix,this._inverseModelViewMatrix)}},{key:"_getAttribLoc",value:function(e,t,n){return void 0===t.cacheAttribLoc&&(t.cacheAttribLoc={}),void 0===t.cacheAttribLoc[n]&&(t.cacheAttribLoc[n]=e.getAttribLocation(t,n)),t.cacheAttribLoc[n]}},{key:"draw",value:function(e,t){if(e.length)for(var n=0;n<e.length;n++)this.draw(e[n]);else{for(var o=0;o<e.attributes.length;o++){var r=e.attributes[o];this.gl.bindBuffer(this.gl.ARRAY_BUFFER,r.buffer);var i=this._getAttribLoc(this.gl,this.shaderProgram,r.name);this.gl.vertexAttribPointer(i,r.itemSize,this.gl.FLOAT,!1,0,0),-1===this._enabledVertexAttribute.indexOf(i)&&(this.gl.enableVertexAttribArray(i),this._enabledVertexAttribute.push(i))}this._lightEnabled&&(this.shader.uniform("uLightPosition","vec3",this.light.position),this.shader.uniform("uLightAmbient","vec4",this.light.ambient),this.shader.uniform("uLightDiffuse","vec4",this.light.diffuse)),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,e.iBuffer),void 0!==this.camera&&(this.shader.uniform("uProjectionMatrix","mat4",this.camera.projection),this.shader.uniform("uViewMatrix","mat4",this.camera.matrix)),this.shader.uniform("uModelMatrix","mat4",this._modelMatrix),this.shader.uniform("uNormalMatrix","mat3",this._normalMatrix),this.shader.uniform("uModelViewMatrixInverse","mat3",this._inverseModelViewMatrix);var a=e.drawType;void 0!==t&&(a=t),a===this.gl.POINTS?this.gl.drawArrays(a,0,e.vertexSize):this.gl.drawElements(a,e.iBuffer.numItems,this.gl.UNSIGNED_SHORT,0)}}},{key:"setSize",value:function(e,t){this._width=e,this._height=t,this.canvas.width=this._width,this.canvas.height=this._height,this._aspectRatio=this._width/this._height,this.gl&&this.viewport(0,0,this._width,this._height)}},{key:"showExtensions",value:function(){for(var e in console.log("Extensions : ",this.extensions),this.extensions)this.extensions[e]&&console.log(e,":",this.extensions[e])}},{key:"checkExtension",value:function(e){return!!this.extensions[e]}},{key:"getExtension",value:function(e){return this.extensions[e]}},{key:"enableAlphaBlending",value:function(){this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)}},{key:"enableAdditiveBlending",value:function(){this.gl.blendFunc(this.gl.ONE,this.gl.ONE)}},{key:"enable",value:function(e){this.gl.enable(e)}},{key:"disable",value:function(e){this.gl.disable(e)}},{key:"viewport",value:function(e,t,n,o){this.setViewport(e,t,n,o)}},{key:"destroy",value:function(){if(this.canvas.parentNode)try{this.canvas.parentNode.removeChild(this.canvas)}catch(e){console.log("Error : ",e)}this.canvas=null}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"aspectRatio",get:function(){return this._aspectRatio}}])&&r(t.prototype,n),i&&r(t,i),e}());t.default=i},,,,,,,,,function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listeners=new Map}var t,n,r;return t=e,(n=[{key:"on",value:function(e,t){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(t)}},{key:"off",value:function(e,t){var n,o=this.listeners.get(e);return!!(o&&o.length&&(n=o.reduce(function(e,n,o){return"function"==typeof n&&n===t?e=o:e},-1))>-1)&&(o.splice(n,1),this.listeners.set(e,o),!0)}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];var r=this.listeners.get(e);return!(!r||!r.length)&&(r.forEach(function(e){e.apply(void 0,n)}),!0)}}])&&o(t.prototype,n),r&&o(t,r),e}());t.default=r},,,,,,,,,,,,,function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,void 0===window.requestAnimFrame&&(window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)});var r=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._delayTasks=[],this._nextTasks=[],this._deferTasks=[],this._highTasks=[],this._usurpTask=[],this._enterframeTasks=[],this._idTable=0,this._loop()}var t,n,r;return t=e,(n=[{key:"addEF",value:function(e,t){t=t||[];var n=this._idTable;return this._enterframeTasks[n]={func:e,params:t},this._idTable++,n}},{key:"removeEF",value:function(e){return void 0!==this._enterframeTasks[e]&&(this._enterframeTasks[e]=null),-1}},{key:"delay",value:function(e,t,n){var o={func:e,params:t,delay:n,time:(new Date).getTime()};this._delayTasks.push(o)}},{key:"defer",value:function(e,t){var n={func:e,params:t};this._deferTasks.push(n)}},{key:"next",value:function(e,t){var n={func:e,params:t};this._nextTasks.push(n)}},{key:"usurp",value:function(e,t){var n={func:e,params:t};this._usurpTask.push(n)}},{key:"_process",value:function(){var e,t,n=0;for(n=0;n<this._enterframeTasks.length;n++)null!==(e=this._enterframeTasks[n])&&void 0!==e&&e.func(e.params);for(;this._highTasks.length>0;)(e=this._highTasks.pop()).func(e.params);var o=(new Date).getTime();for(n=0;n<this._delayTasks.length;n++)o-(e=this._delayTasks[n]).time>e.delay&&(e.func(e.params),this._delayTasks.splice(n,1));for(o=(new Date).getTime(),t=1e3/60;this._deferTasks.length>0;){if(e=this._deferTasks.shift(),!((new Date).getTime()-o<t)){this._deferTasks.unshift(e);break}e.func(e.params)}for(o=(new Date).getTime(),t=1e3/60;this._usurpTask.length>0&&(e=this._usurpTask.shift(),(new Date).getTime()-o<t);)e.func(e.params);this._highTasks=this._highTasks.concat(this._nextTasks),this._nextTasks=[],this._usurpTask=[]}},{key:"_loop",value:function(){var e=this;this._process(),window.requestAnimFrame(function(){return e._loop()})}}])&&o(t.prototype,n),r&&o(t,r),e}());t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(11))&&o.__esModule?o:{default:o};function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}var s,u=n(290),l=n(289),c={float:"uniform1f",vec2:"uniform2fv",vec3:"uniform3fv",vec4:"uniform4fv",int:"uniform1i",mat3:"uniformMatrix3fv",mat4:"uniformMatrix4fv"},f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s=r.default.gl,this.parameters=[],this.uniformValues={},this.uniformTextures=[],t||(t=u),n||(n=u);var o=this._createShaderProgram(t,!0),i=this._createShaderProgram(n,!1);this._vsShader=o,this._fsShader=i,this._attachShaderProgram(o,i)}var t,n,o;return t=e,(n=[{key:"bind",value:function(){s.useProgram(this.shaderProgram),r.default.useShader(this),this.uniformTextures=[]}},{key:"uniform",value:function(e,t,n){function o(e){return e.slice?e.slice(0):new Float32Array(e)}if(void 0!==n&&null!==n){for(var r,i=c[t]||t,u="uniform1i"===i||"uniform1f"===i,l=!1,f=-1,h=0;h<this.parameters.length;h++)if((r=this.parameters[h]).name===e){l=!0,f=h;break}if(l?this.shaderProgram[e]=r.uniformLoc:(this.shaderProgram[e]=s.getUniformLocation(this.shaderProgram,e),u?this.parameters.push({name:e,type:i,value:n,uniformLoc:this.shaderProgram[e]}):this.parameters.push({name:e,type:i,value:o(n),uniformLoc:this.shaderProgram[e]}),f=this.parameters.length-1),this.parameters[f].uniformLoc)if(-1===i.indexOf("Matrix"))if(u)(this.parameters[f].value!==n||!l)&&(s[i](this.shaderProgram[e],n),this.parameters[f].value=n);else a(this.parameters[f].value,n)&&l||(s[i](this.shaderProgram[e],n),this.parameters[f].value=o(n));else a(this.parameters[f].value,n)&&l||(s[i](this.shaderProgram[e],!1,n),this.parameters[f].value=o(n))}else console.warn("mValue Error:",e)}},{key:"_createShaderProgram",value:function(e,t){var n=t?r.default.VERTEX_SHADER:r.default.FRAGMENT_SHADER,o=s.createShader(n);return s.shaderSource(o,e),s.compileShader(o),s.getShaderParameter(o,s.COMPILE_STATUS)?o:(console.warn("Error in Shader : ",s.getShaderInfoLog(o)),console.log(function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(e)),null)}},{key:"_attachShaderProgram",value:function(e,t){this.shaderProgram=s.createProgram(),s.attachShader(this.shaderProgram,e),s.attachShader(this.shaderProgram,t),s.linkProgram(this.shaderProgram)}},{key:"destroy",value:function(){this._deleteShader(this.shaderProgram,this._vsShader),this._deleteShader(this.shaderProgram,this._fsShader),this._deleteShaderProgram(this.shaderProgram)}},{key:"_deleteShader",value:function(e,t){s.detachShader(e,t),s.deleteShader(t)}},{key:"_deleteShaderProgram",value:function(e){s.deleteProgram(e)}}])&&i(t.prototype,n),o&&i(t,o),e}();t.default=f},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.spotFrag=t.spotVert=void 0;var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}(n(4)),r=n(6);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e,t,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,t);if(void 0===o){var r=Object.getPrototypeOf(e);return null===r?void 0:l(r,t,n)}if("value"in o)return o.value;var i=o.get;return void 0!==i?i.call(n):void 0}var c=o.default.GL;t.spotVert="\n    uniform vec3 lightPosition;\n    uniform mat4 lightViewMat;\n    uniform mat4 lightProjectionMat;\n\n    varying vec3 vLightToPoint;\n    varying vec3 vEyeToPoint;\n    varying vec4 vShadowPosition;\n\n    const mat4 depthScaleMatrix = mat4(0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.5, 0.5, 0.5, 1.0);\n\n    void setupLight(vec3 worldPosition) {\n       vLightToPoint = lightPosition - worldPosition;\n       vEyeToPoint = -worldPosition;\n    }\n\n    void setupShadow(vec4 worldPosition) {\n       //vShadowPosition = depthScaleMatrix * lightProjectionMat * lightViewMat * worldPosition;\n       vShadowPosition = depthScaleMatrix * lightProjectionMat * lightViewMat * worldPosition;\n    }\n";t.spotFrag="    \n    varying vec3 vLightToPoint;\n    varying vec3 vEyeToPoint;\n    varying vec4 vShadowPosition;\n\n    uniform vec3 lightPosition;\n    uniform sampler2D shadowMap;\n    uniform vec3 lightColor;\n    uniform float lightRadius;\n\n    uniform vec3 lightSpotDirection;\n    uniform float lightSpotInnerAngle;\n    uniform float lightSpotOuterAngle;\n\n    vec3 computeLight(vec3 normal, float specularLevel) {\n    // Lambert term\n       vec3 l = normalize(vLightToPoint);\n       vec3 n = normalize(normal);\n       float lambertTerm = max(dot(n, l), 0.0);\n\n    if(lambertTerm < 0.0) { return vec3(0.0, 0.0, 0.0); }\n\n    // Light attenuation\n       float lightDist = length(vLightToPoint);\n       float d = max(lightDist - lightRadius, 0.0) / lightRadius + 1.0;\n       float distAttn = 1.0 / (d * d);\n\n    // Spot attenuation\n       vec3 sd = normalize(lightSpotDirection);\n       float spotAngleDelta = lightSpotInnerAngle - lightSpotOuterAngle;\n       float spotAngle = dot(-l, sd);\n       float spotAttn = clamp((spotAngle - lightSpotOuterAngle) / spotAngleDelta, 0.0, 1.0);\n\n       vec3 lightValue = (lightColor * lambertTerm * distAttn * spotAttn);\n\n    // Specular\n       vec3 e = normalize(vEyeToPoint);\n       vec3 r = reflect(-l, n);\n       float shininess = 8.0;\n       float specularFactor = pow(clamp(dot(r, e), 0.0, 1.0), shininess) * specularLevel;\n       vec3 specularColor = lightColor;\n       lightValue += (specularColor * specularFactor);\n\n       return lightValue;//vec3(lambertTerm);\n    }\n\n    float computeShadow() {\n       vec3 depth = vShadowPosition.xyz / vShadowPosition.w;\n       float shadowValue = texture2D(shadowMap, depth.xy).r;\n       depth.z *= 0.9999;\n      // float ff = smoothstep(0.999, 1., depth.z);\n       float step = step(0.999, shadowValue);\n       float mm = max(step, (1.-vShadowPosition.x));\n       return mm;\n       return mm + -vShadowPosition.y;\n       //return (vTextureCoord.x * .3) * mm;\n       //return  * mm;\n\n       return smoothstep(mm - 0.05, mm + 0.05, 0.5);\n       //if(shadowValue < depth.z) { return 0.0 + (1.-vShadowPosition.x); }\n       //return ff;\n       //if(shadowValue < depth.z) { return (1.-vTextureCoord.x) * .2 + (1.-vShadowPosition.x); }\n       //if(shadowValue < depth.z) { return 0.0 + (1.-vShadowPosition.x); }\n       return 1.0;\n    }\n";var f=function(e){function t(e,n,o){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,o)))._position=r.vec3.fromValues(4,2,4),i._target=r.vec3.fromValues(0,0,0),i._direction=r.vec3.create(),i._viewMat=r.mat4.create(),i._upVec=r.vec3.fromValues(0,0,1),i._projectionMat=r.mat4.create(),i._dirty=!0,i._cameraViewMat=r.mat4.create(),i._cameraProjMat=r.mat4.create(),i.color=r.vec3.fromValues(1,1,1),i.brightness=0,i._scaledColor=r.vec3.create(),i.radius=100,i.innerAngle=.1*Math.PI,i.outerAngle=.15*Math.PI,i.bound=!1,i}var n,i,f;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.FrameBuffer),n=t,(i=[{key:"bind",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"bind",this).call(this);var e=c.gl;c.gl.colorMask(!1,!1,!1,!1),c.gl.clear(e.DEPTH_BUFFER_BIT),this._camera&&(r.mat4.copy(this._cameraViewMat,this._camera.matrix),r.mat4.copy(this._cameraProjMat,this._camera.projection),r.mat4.copy(this._camera.matrix,this._getViewMat()),r.mat4.copy(this._camera.projection,this._getProjectionMat())),this.bound=!0}},{key:"unbind",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unbind",this).call(this),c.gl.colorMask(!0,!0,!0,!0),this._camera&&(r.mat4.copy(this._camera.matrix,this._cameraViewMat),r.mat4.copy(this._camera.projection,this._cameraProjMat)),this.bound=!1}},{key:"bindUniforms",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;r.vec3.subtract(this._direction,this._target,this._position),r.vec3.scale(this._scaledColor,this.color,this.brightness),e.uniform("lightPosition","vec3",this._position),e.uniform("lightColor","vec3",this._scaledColor),e.uniform("lightSpotDirection","vec3",this._direction),e.uniform("lightRadius","float",this.radius),e.uniform("lightSpotInnerAngle","float",Math.cos(this.innerAngle)),e.uniform("lightSpotOuterAngle","float",Math.cos(this.outerAngle)),e.uniform("lightViewMat","mat4",this._getViewMat()),e.uniform("lightProjectionMat","mat4",this._getProjectionMat()),e.uniform("shadowMap","uniform1i",t),this.getDepthTexture().bind(t)}},{key:"_getProjectionMat",value:function(){if(!this._camera)return this._projectionMat;this.outerAngle,Math.PI;return r.mat4.perspective(this._projectionMat,this._camera._fov,this._camera._aspectRatio,.1,128),this._projectionMat}},{key:"_getViewMat",value:function(){return r.mat4.lookAt(this._viewMat,this._position,this._target,this._upVec),this._viewMat}},{key:"camera",set:function(e){this._camera=e}},{key:"position",set:function(e){r.vec3.fromValues.apply(r.vec3,a(e));r.vec3.set.apply(r.vec3,[this._position].concat(a(e)))},get:function(){return this._position}},{key:"target",set:function(e){r.vec3.set.apply(r.vec3,[this._target].concat(a(e)))},get:function(){return this._target}},{key:"dotProduct",get:function(){return r.vec3.dot(this._target,this._position)}}])&&s(n.prototype,i),f&&s(n,f),t}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(20))&&o.__esModule?o:{default:o};function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var a=256,s=1536,u=256,l=256,c=-s/2,f=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._z=c,this._passes=0,this._height=s,this._width=a,this._start=c,this._offset=u,this._reset=l,this._incre=0,this._needsUpdate=!0}var t,n,o;return t=e,(n=[{key:"setParams",value:function(e){var t=this;Object.keys(e).forEach(function(n){t[n]=e[n]})}},{key:"update",value:function(){this._paused||(this._incre+=1,this._z+=1,this._needsUpdate=!1,this._z>this._reset&&(this._z=this._start,this._passes++,this._worldMaxZ=this._height*this._passes+this._height,this._worldMinZ=this._height*this._passes,r.default.emit("movement:complete"),this._needsUpdate=!0))}},{key:"z",get:function(){return this._z},set:function(e){this._z=e}},{key:"width",set:function(e){this._width=e}},{key:"height",set:function(e){this._height=e,this._z=this._start+4}},{key:"start",set:function(e){this._start=e}},{key:"offset",set:function(e){this._offset=e}},{key:"reset",set:function(e){this._reset=e}},{key:"worldZ",get:function(){return this._height*this._passes+this._z}},{key:"worldZMin",get:function(){return this._worldMinZ||0}},{key:"worldZMax",get:function(){return this._worldMaxZ||this._height}},{key:"needsUpdate",get:function(){return this._needsUpdate}},{key:"incre",get:function(){return this._incre}},{key:"pause",set:function(e){this._paused=e},get:function(){return this._paused||!1}}])&&i(t.prototype,n),o&&i(t,o),e}());t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(11))&&o.__esModule?o:{default:o};function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var a=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._mesh=t,this._shader=n}var t,n,o;return t=e,(n=[{key:"draw",value:function(){this._shader.bind(),r.default.draw(this.mesh)}},{key:"mesh",get:function(){return this._mesh}},{key:"shader",get:function(){return this._shader}}])&&i(t.prototype,n),o&&i(t,o),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r,i=(o=n(11))&&o.__esModule?o:{default:o};function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}(n(6)).vec3,u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.default.gl.TRIANGLES;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r=i.default.gl,this.drawType=t,this._attributes=[],this._vertexSize=0,this._vertices=[],this._texCoords=[],this._normals=[],this._faceNormals=[],this._tangents=[],this._indices=[],this._faces=[]}var t,n,o;return t=e,(n=[{key:"bufferVertex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._vertexSize=e.length,this.bufferData(e,"aVertexPosition",3,t),this._vertices=e}},{key:"bufferTexCoords",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.bufferData(e,"aTextureCoord",2,t),this._texCoords=e}},{key:"bufferNormal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.bufferData(e,"aNormal",3,t),this._normals=e}},{key:"bufferIndices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?r.DYNAMIC_DRAW:r.STATIC_DRAW;this._indices=e,this.iBuffer=r.createBuffer(),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,this.iBuffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,new Uint16Array(e),t),this.iBuffer.itemSize=1,this.iBuffer.numItems=e.length,this._indices=e}},{key:"bufferData",value:function(e,t,n){var o,i,a=-1,s=0,u=arguments.length>3&&void 0!==arguments[3]&&arguments[3]?r.DYNAMIC_DRAW:r.STATIC_DRAW,l=[];for(s=0;s<this._attributes.length;s++)if(this._attributes[s].name===t){this._attributes[s].data=e,a=s;break}for(s=0;s<e.length;s++)for(var c=0;c<e[s].length;c++)l.push(e[s][c]);if(-1===a)o=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,o),i=new Float32Array(l),r.bufferData(r.ARRAY_BUFFER,i,u),this._attributes.push({name:t,data:e,itemSize:n,buffer:o,dataArray:i});else{for(o=this._attributes[a].buffer,r.bindBuffer(r.ARRAY_BUFFER,o),i=this._attributes[a].dataArray,s=0;s<l.length;s++)i[s]=l[s];r.bufferData(r.ARRAY_BUFFER,i,u)}}},{key:"computeNormals",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._generateFaces(),e?this._computeFaceNormals():this._computeVertexNormals()}},{key:"computeTangents",value:function(){}},{key:"_computeFaceNormals",value:function(){for(var e,t,n=[],o=0;o<this._indices.length;o+=3){e=o/3;var r=(t=this._faces[e]).normal;n[t.indices[0]]=r,n[t.indices[1]]=r,n[t.indices[2]]=r}this.bufferNormal(n)}},{key:"_computeVertexNormals",value:function(){for(var e,t=s.create(),n=[],o=0;o<this._vertices.length;o++){s.set(t,0,0,0);for(var r=0;r<this._faces.length;r++)(e=this._faces[r]).indices.indexOf(o)>=0&&(t[0]+=e.normal[0],t[1]+=e.normal[1],t[2]+=e.normal[2]);s.normalize(t,t),n.push([t[0],t[1],t[2]])}this.bufferNormal(n)}},{key:"_generateFaces",value:function(){for(var e,t,n,o,r,i,a=s.create(),u=s.create(),l=s.create(),c=0;c<this._indices.length;c+=3){e=this._indices[c],t=this._indices[c+1],n=this._indices[c+2],o=s.clone(this._vertices[e]),r=s.clone(this._vertices[t]),i=s.clone(this._vertices[n]),s.sub(a,r,o),s.sub(u,i,o),s.cross(l,a,u),s.normalize(l,l);var f={indices:[e,t,n],normal:[l[0],l[1],l[2]]};this._faces.push(f)}}},{key:"destroy",value:function(){for(var e=0;e<this._attributes.length;e++){var t=this._attributes[e].buffer;"WebGLBuffer"==typeof t&&r.deleteBuffer(t)}this._attributes.length=0,this._vertices.length=0,this._texCoords.length=0,this._normals.length=0,this._faceNormals.length=0,this._tangents.length=0,this._indices.length=0,this._faces.length=0,this._vertices=null,this._texCoords=null,this._normals=null,this._faceNormals=null,this._tangents=null,this._indices=null,this._faces=null,console.log("destroy mesh")}},{key:"vertices",get:function(){return this._vertices}},{key:"normals",get:function(){return this._normals}},{key:"attributes",get:function(){return this._attributes}},{key:"vertexSize",get:function(){return this._vertexSize}},{key:"hasNormals",get:function(){return 0!==this._normals.length}},{key:"hasTangents",get:function(){return 0!==this._tangents.length}}])&&a(t.prototype,n),o&&a(t,o),e}();t.default=u},,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mixMorningEvening=t.SUN_EVENING=t.SUN_MORNING=t.sunSkyPosition=void 0;t.sunSkyPosition="\nfloat sunSkyPosition(in float _sinSun){\n\tfloat _sunSkyPosition = -1. * _sinSun  * (1. - (_sinSun - step(_sinSun, 0.)));\n\treturn _sunSkyPosition;\n}\n";t.SUN_MORNING="\n\tconst vec3 SUN_MORNING = vec3(.819607843, .635294118, .431372549);\n";t.SUN_EVENING="\n\tconst vec3 SUN_EVENING = vec3(.116862745, .126666667, .22745098);\n";t.mixMorningEvening="\n\tvec3 mixMorningEvening(in float amount){\n\t\tvec3 skyHue = mix(SUN_EVENING, SUN_MORNING, amount);\n\t\treturn skyHue;\n\t}\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findObjectsWithKey=function e(t,n){if(r.default.has(t,n))return[t];return r.default.flattenDeep(r.default.map(t,function(t){return"object"==i(t)?e(t,n):[]}),!0);var o=[];r.default.forEach(t,function(t){"object"==i(t)&&(t=e(t,n)).length&&o.push.apply(o,t)});return o},t.default=t.MARS_COLORS=void 0;var o,r=(o=n(12))&&o.__esModule?o:{default:o};function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var a=Math.PI/2;t.MARS_COLORS={darkColor:[151,92,54],baseColor:[204,131,88],lightColor:[237,174,126],fogColor:[155,134,144]};var s=[{id:"intro",type:"intro",scenes:[{duration:8,transitionDuration:4,camera:{position:[0,0,0]},scale:1,marsUniforms:{atmosphereIntensity:.4,fresnelBias:.03,fresnelAmp:1},animations:{outUniforms:{atmosphereIntensity:0}},outUniforms:{atmosphereIntensity:0}},{duration:12,transitionDuration:3,camera:{position:[0,-20,-30]},scale:1,marsUniforms:{atmosphereIntensity:.4,fresnelBias:.05,fresnelAmp:1},outUniforms:{atmosphereIntensity:0}},{camera:{position:[30,0,-60]},scale:1,duration:12,transitionDuration:2,marsUniforms:{atmosphereIntensity:1,fresnelBias:.1,fresnelAmp:.98},outUniforms:{noiseAtmosphere:1,atmosphereIntensity:0}},{animations:{moveTo:{value:[30.5,0,-100],props:{duration:2,delay:2}},outUniforms:{atmosphereIntensity:3}},camera:{position:[30,0,-90]},scale:1,duration:6,transitionDuration:2,shake:!0,shakeIntensity:.2,marsUniforms:{atmosphereIntensity:1.2,fresnelBias:.3,fresnelAmp:.6},outUniforms:{atmosphereIntensity:1}}],animation:[{getMoveTo:{value:[0,0,0],delay:10},rotate:{value:-a,delay:10},radiusTo:{value:50,delay:10,limit:[15,800]}}],textures:[{id:"space",url:"intro/space2.jpg"},{id:"nebula",url:"intro/nebula.jpg"},{id:"diffuse",url:"intro/final.png"},{id:"albedo",url:"intro/albedo.png"},{id:"height",url:"intro/height.jpg"},{id:"ao",url:"intro/ao.jpg"},{id:"irr_posx",url:"intro/hdr/irr_posx.hdr",type:"binary"},{id:"irr_posy",url:"intro/hdr/irr_posy.hdr",type:"binary"},{id:"irr_posz",url:"intro/hdr/irr_posz.hdr",type:"binary"},{id:"irr_negx",url:"intro/hdr/irr_negx.hdr",type:"binary"},{id:"irr_negy",url:"intro/hdr/irr_negy.hdr",type:"binary"},{id:"irr_negz",url:"intro/hdr/irr_negz.hdr",type:"binary"}]}];t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(33))&&o.__esModule?o:{default:o};function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var a=function(){function e(t){var n=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.easing=o,this._value=t,this._targetValue=t,r.default.addEF(function(){return n._update()})}var t,n,o;return t=e,(n=[{key:"_update",value:function(){this._checkLimit(),this._value+=(this._targetValue-this._value)*this.easing}},{key:"setTo",value:function(e){this._targetValue=this._value=e}},{key:"add",value:function(e){this._targetValue+=e}},{key:"limit",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e>t?this.limit(t,e):(this._loop=n,this._min=e,this._max=t,this._checkLimit())}},{key:"_checkLimit",value:function(){void 0!==this._min&&this._targetValue<this._min&&(this._loop?this._targetValue=this._max:this._targetValue=this._min),void 0!==this._max&&this._targetValue>this._max&&(this._loop?this._targetValue=this._min:this._targetValue=this._max)}},{key:"value",set:function(e){this._targetValue=e},get:function(){return this._value}},{key:"targetValue",get:function(){return this._targetValue}}])&&i(t.prototype,n),o&&i(t,o),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(44))&&o.__esModule?o:{default:o};var i={plane:function(e,t,n){for(var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"xy",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:4,s=[],u=[],l=[],c=[],f=e/n,h=t/n,d=1/n,v=0,p=.5*-e,_=.5*-t,m=0;m<n;m++)for(var b=0;b<n;b++){var y=f*m+p,g=h*b+_;"xz"===i?(s.push([y,0,-g+h]),s.push([y+f,0,-g+h]),s.push([y+f,0,-g]),s.push([y,0,-g]),c.push([0,1,0]),c.push([0,1,0]),c.push([0,1,0]),c.push([0,1,0])):"yz"===i?(s.push([0,y,g]),s.push([0,y+f,g]),s.push([0,y+f,g+h]),s.push([0,y,g+h]),c.push([1,0,0]),c.push([1,0,0]),c.push([1,0,0]),c.push([1,0,0])):(s.push([y,g,0]),s.push([y+f,g,0]),s.push([y+f,g+h,0]),s.push([y,g+h,0]),c.push([0,0,1]),c.push([0,0,1]),c.push([0,0,1]),c.push([0,0,1]));var x=m/n,w=b/n;u.push([x,w]),u.push([x+d,w]),u.push([x+d,w+d]),u.push([x,w+d]),l.push(4*v+0),l.push(4*v+1),l.push(4*v+2),l.push(4*v+0),l.push(4*v+2),l.push(4*v+3),v++}var E=new r.default(a);return E.bufferVertex(s),E.bufferTexCoords(u),E.bufferIndices(l),o&&E.bufferNormal(c),E},sphere:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4,a=[],s=[],u=[],l=[],c=0,f=1/t,h=function(n,o){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=n/t*Math.PI-.5*Math.PI,a=o/t*Math.PI*2,s=r?1:e,u=[];u[1]=Math.sin(i)*s;var l=Math.cos(i)*s;u[0]=Math.cos(a)*l,u[2]=Math.sin(a)*l;return u[0]=Math.floor(1e4*u[0])/1e4,u[1]=Math.floor(1e4*u[1])/1e4,u[2]=Math.floor(1e4*u[2])/1e4,u},d=0;d<t;d++)for(var v=0;v<t;v++){a.push(h(d,v)),a.push(h(d+1,v)),a.push(h(d+1,v+1)),a.push(h(d,v+1)),n&&(l.push(h(d,v,!0)),l.push(h(d+1,v,!0)),l.push(h(d+1,v+1,!0)),l.push(h(d,v+1,!0)));var p=v/t,_=d/t;s.push([1-p,_]),s.push([1-p,_+f]),s.push([1-p-f,_+f]),s.push([1-p-f,_]),u.push(4*c+0),u.push(4*c+1),u.push(4*c+2),u.push(4*c+0),u.push(4*c+2),u.push(4*c+3),c++}o&&u.reverse();var m=new r.default(i);return m.bufferVertex(a),m.bufferTexCoords(s),m.bufferIndices(u),n&&m.bufferNormal(l),m},cube:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4,a=e/2,s=(t=t||e)/2,u=(n=n||e)/2,l=[],c=[],f=[],h=[],d=0;l.push([-a,s,-u]),l.push([a,s,-u]),l.push([a,-s,-u]),l.push([-a,-s,-u]),h.push([0,0,-1]),h.push([0,0,-1]),h.push([0,0,-1]),h.push([0,0,-1]),c.push([0,0]),c.push([1,0]),c.push([1,1]),c.push([0,1]),f.push(4*d+0),f.push(4*d+1),f.push(4*d+2),f.push(4*d+0),f.push(4*d+2),f.push(4*d+3),d++,l.push([a,s,-u]),l.push([a,s,u]),l.push([a,-s,u]),l.push([a,-s,-u]),h.push([1,0,0]),h.push([1,0,0]),h.push([1,0,0]),h.push([1,0,0]),c.push([0,0]),c.push([1,0]),c.push([1,1]),c.push([0,1]),f.push(4*d+0),f.push(4*d+1),f.push(4*d+2),f.push(4*d+0),f.push(4*d+2),f.push(4*d+3),d++,l.push([a,s,u]),l.push([-a,s,u]),l.push([-a,-s,u]),l.push([a,-s,u]),h.push([0,0,1]),h.push([0,0,1]),h.push([0,0,1]),h.push([0,0,1]),c.push([0,0]),c.push([1,0]),c.push([1,1]),c.push([0,1]),f.push(4*d+0),f.push(4*d+1),f.push(4*d+2),f.push(4*d+0),f.push(4*d+2),f.push(4*d+3),d++,l.push([-a,s,u]),l.push([-a,s,-u]),l.push([-a,-s,-u]),l.push([-a,-s,u]),h.push([-1,0,0]),h.push([-1,0,0]),h.push([-1,0,0]),h.push([-1,0,0]),c.push([0,0]),c.push([1,0]),c.push([1,1]),c.push([0,1]),f.push(4*d+0),f.push(4*d+1),f.push(4*d+2),f.push(4*d+0),f.push(4*d+2),f.push(4*d+3),d++,l.push([-a,s,u]),l.push([a,s,u]),l.push([a,s,-u]),l.push([-a,s,-u]),h.push([0,1,0]),h.push([0,1,0]),h.push([0,1,0]),h.push([0,1,0]),c.push([0,0]),c.push([1,0]),c.push([1,1]),c.push([0,1]),f.push(4*d+0),f.push(4*d+1),f.push(4*d+2),f.push(4*d+0),f.push(4*d+2),f.push(4*d+3),d++,l.push([-a,-s,-u]),l.push([a,-s,-u]),l.push([a,-s,u]),l.push([-a,-s,u]),h.push([0,-1,0]),h.push([0,-1,0]),h.push([0,-1,0]),h.push([0,-1,0]),c.push([0,0]),c.push([1,0]),c.push([1,1]),c.push([0,1]),f.push(4*d+0),f.push(4*d+1),f.push(4*d+2),f.push(4*d+0),f.push(4*d+2),f.push(4*d+3),d++;var v=new r.default(i);return v.bufferVertex(l),v.bufferTexCoords(c),v.bufferIndices(f),o&&v.bufferNormal(h),v},skybox:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,o=[],i=[],a=[],s=[],u=0;o.push([e,e,-e]),o.push([-e,e,-e]),o.push([-e,-e,-e]),o.push([e,-e,-e]),s.push([0,0,-1]),s.push([0,0,-1]),s.push([0,0,-1]),s.push([0,0,-1]),i.push([0,0]),i.push([1,0]),i.push([1,1]),i.push([0,1]),a.push(4*u+0),a.push(4*u+1),a.push(4*u+2),a.push(4*u+0),a.push(4*u+2),a.push(4*u+3),u++,o.push([e,-e,-e]),o.push([e,-e,e]),o.push([e,e,e]),o.push([e,e,-e]),s.push([1,0,0]),s.push([1,0,0]),s.push([1,0,0]),s.push([1,0,0]),i.push([0,0]),i.push([1,0]),i.push([1,1]),i.push([0,1]),a.push(4*u+0),a.push(4*u+1),a.push(4*u+2),a.push(4*u+0),a.push(4*u+2),a.push(4*u+3),u++,o.push([-e,e,e]),o.push([e,e,e]),o.push([e,-e,e]),o.push([-e,-e,e]),s.push([0,0,1]),s.push([0,0,1]),s.push([0,0,1]),s.push([0,0,1]),i.push([0,0]),i.push([1,0]),i.push([1,1]),i.push([0,1]),a.push(4*u+0),a.push(4*u+1),a.push(4*u+2),a.push(4*u+0),a.push(4*u+2),a.push(4*u+3),u++,o.push([-e,-e,e]),o.push([-e,-e,-e]),o.push([-e,e,-e]),o.push([-e,e,e]),s.push([-1,0,0]),s.push([-1,0,0]),s.push([-1,0,0]),s.push([-1,0,0]),i.push([0,0]),i.push([1,0]),i.push([1,1]),i.push([0,1]),a.push(4*u+0),a.push(4*u+1),a.push(4*u+2),a.push(4*u+0),a.push(4*u+2),a.push(4*u+3),u++,o.push([e,e,e]),o.push([-e,e,e]),o.push([-e,e,-e]),o.push([e,e,-e]),s.push([0,1,0]),s.push([0,1,0]),s.push([0,1,0]),s.push([0,1,0]),i.push([0,0]),i.push([1,0]),i.push([1,1]),i.push([0,1]),a.push(4*u+0),a.push(4*u+1),a.push(4*u+2),a.push(4*u+0),a.push(4*u+2),a.push(4*u+3),u++,o.push([e,-e,-e]),o.push([-e,-e,-e]),o.push([-e,-e,e]),o.push([e,-e,e]),s.push([0,-1,0]),s.push([0,-1,0]),s.push([0,-1,0]),s.push([0,-1,0]),i.push([0,0]),i.push([1,0]),i.push([1,1]),i.push([0,1]),a.push(4*u+0),a.push(4*u+1),a.push(4*u+2),a.push(4*u+0),a.push(4*u+2),a.push(4*u+3);var l=new r.default(n);return l.bufferVertex(o),l.bufferTexCoords(i),l.bufferIndices(a),t&&l.bufferNormal(s),l},bigTriangle:function(){var e=new r.default;return e.bufferData([[-1,-1],[-1,4],[4,-1]],"aPosition",2),e.bufferIndices([2,1,0]),e}},a=i;t.default=a},,,,,,,,,,,,,,,,,,function(e,t){e.exports="// simpleColor.frag\n\n#define SHADER_NAME SIMPLE_COLOR\n\nprecision highp float;\n\nuniform vec3 color;\nuniform float opacity;\n\nvoid main(void) {\n    gl_FragColor = vec4(color, opacity);\n}"},function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._req=new XMLHttpRequest,this._req.addEventListener("load",function(e){return t._onLoaded(e)}),this._req.addEventListener("progress",function(e){return t._onProgress(e)}),n&&(this._req.responseType="arraybuffer")}var t,n,r;return t=e,(n=[{key:"load",value:function(e,t){console.log("Loading : ",e),this._callback=t,this._req.open("GET",e),this._req.send()}},{key:"_onLoaded",value:function(){this._callback(this._req.response)}},{key:"_onProgress",value:function(){}}])&&o(t.prototype,n),r&&o(t,r),e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(76))&&o.__esModule?o:{default:o},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}(n(6));function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),n=t,(o=[{key:"setPerspective",value:function(e,t,n,o){this._fov=e,this._near=n,this._far=o,this._aspectRatio=t,i.mat4.perspective(this._projection,e,t,n,o)}},{key:"reset",value:function(){i.mat4.perspective(this._projection,this._fov,this._aspectRatio,this._near,this._far)}},{key:"setAspectRatio",value:function(e){this._aspectRatio=e,i.mat4.perspective(this.projection,this._fov,e,this._near,this._far)}}])&&s(n.prototype,o),a&&s(n,a),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}(n(6));function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._matrix=o.mat4.create(),this._projection=o.mat4.create(),this.position=o.vec3.create()}var t,n,i;return t=e,(n=[{key:"lookAt",value:function(e,t,n){o.vec3.copy(this.position,e),o.mat4.identity(this._matrix),o.mat4.lookAt(this._matrix,e,t,n)}},{key:"matrix",get:function(){return this._matrix}},{key:"viewMatrix",get:function(){return this._matrix}},{key:"projection",get:function(){return this._projection}},{key:"projectionMatrix",get:function(){return this._projection}}])&&r(t.prototype,n),i&&r(t,i),e}();t.default=i},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=n(52),i=n(239),a=(o=n(238))&&o.__esModule?o:{default:o};var s="\n\n// basic.frag\n\n#define SHADER_NAME SIMPLE_TEXTURE\n#define SUN_RADIUS 0.000001\n#define SUN_AMP 1. //HIgh is smaller\n#define SUN_SPEED 0.08\n#define SUN_INTENS 0.2\n\nprecision highp float;\nuniform sampler2D uHorizon;\nuniform float uTime;\nuniform float uAngle;\nuniform float washOutFactor;\nuniform vec3 sunTarget;\nuniform vec3 sunPosition;\nvarying vec2 vTextureCoord;\n\n".concat(r.SUN_MORNING,"\n").concat(r.SUN_EVENING,"\n").concat(i.circle,"\n").concat(r.sunSkyPosition,"\n").concat(r.mixMorningEvening,"\n\n").concat(a.default,"\n\nfloat qinticIn(float t) {\n  return pow(t, 5.0);\n}\n\n\nvoid main(void) {\n\tvec2 st = vTextureCoord;\n\tvec4 color = texture2D(uHorizon, vTextureCoord);\n\tfloat noise = fBm(st, uTime, 0.5);\n\n\t//float sunAngle = dot(normalize(sunTarget), -normalize(sunPosition));\n\tfloat _angle = uAngle + ((noise * 2. - 1.));\n\tfloat _sinSun = sin(-_angle);\n\tvec2 translateSun = vec2(cos(-_angle),_sinSun);\n\t//vec2 translateSun = vec2(sunPosition.xy);\n\tst.x+=0.25; //90degs\n\tst+=translateSun*SUN_SPEED;\n\n\tfloat _sunSkyPosition = sunSkyPosition(_sinSun);\n\tvec3 skyHue = mixMorningEvening(_sunSkyPosition);\n\n\tvec3 sunColor = vec3(circle(st, SUN_RADIUS / 8., SUN_RADIUS, 0.5 ,SUN_AMP));\n\n\tfloat sunGlowSlope = qinticIn(circle(st, 0.05 / 8., 0.05, 100. ,500.));\n\tvec3 sunGlow = skyHue * vec3(sunGlowSlope);\n\tsunGlow *= SUN_INTENS;\n\tsunGlow += sunColor * (skyHue*vec3(.8,.8,.8));\n\n\tskyHue += sunGlow;\n\n\tvec3 finalColor = mix(color.rgb, skyHue, clamp(_sunSkyPosition, 0.3, .5));\n\n\tfinalColor += sunColor * (skyHue*vec3(.8,.8,.8));\n\n  vec3 washOut = vec3(skyHue) * washOutFactor;\n\n    //gl_FragColor = vec4(color.rgb,1.0);\n    //gl_FragColor = vec4(skyHue + sunGlow,1.0);\n    //gl_FragColor = vec4(vec3(noise),1.0);\n    //gl_FragColor = vec4(skyHue,1.0);\n    gl_FragColor = vec4((finalColor *(1. - washOutFactor)) + washOut, 1.0);//vec4(1.0, 0.0, 0.0, 1.0);\n}\n\n");t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="\n\n// basic.vert\n\nprecision highp float;\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nuniform vec3 position;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n\tvec3 pos \t\t\t\t= aVertexPosition;\n\tpos \t\t\t\t\t=  pos + position;\n    gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(pos, 1.0);\n    vTextureCoord = aTextureCoord;\n}\n\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(124),r=n(52),i=n(123),a=c(n(122)),s=c(n(121)),u=(c(n(120)),c(n(119)),n(118)),l=n(41);function c(e){return e&&e.__esModule?e:{default:e}}var f="\n\n#extension GL_EXT_shader_texture_lod : enable\n#define EXPOSURE 4.6\n#define GAMMA 1.\n#define FOG 0.8\n//*** USED FOR THE HORIZON\n#define NEAR -1024.\n#define FAR 1024.\n#define SHADOW_INTENSITY .7\n\n\nprecision highp float;\n\nuniform float rotation;\nuniform sampler2D \tuHeightMap;\nuniform sampler2D \tuAoMap;\n\nuniform mat4 uViewMatrix;\n\nuniform vec3 uLightPosition;\nuniform vec4 uLightAmbient;\nuniform vec4 uLightDiffuse;\n\nuniform vec3 baseColor;\nuniform vec3 uLightColor;\nuniform vec3 darkColor;\nuniform vec3 fogColor;\n\nuniform vec3 sunPosition;\nuniform vec3 position;\n\nuniform int sceneDepth;\nuniform float heightMap;\nuniform float washOutFactor;\nuniform float uAngle;\n\nvarying vec3        vNormal;\nvarying vec3        vPosition;\nvarying vec3\t\tvEyePosition;\nvarying vec3\t\tvWsNormal;\nvarying vec3\t\tvWsPosition;\nvarying vec3\t\tvVertexPosition;\n\nvarying vec2 \t\tvTextureCoord;\n\nvarying vec3 vLightRay;\nvarying vec3 vEyeVec;\n\n\n// Filmic tonemapping from\n// http://filmicgames.com/archives/75\n\nconst float A = 0.15;\nconst float B = 0.50;\nconst float C = 0.10;\nconst float D = 0.20;\nconst float E = 0.02;\nconst float F = 0.30;\n\n\n\n".concat(o.Uncharted2Tonemap,"\n").concat(o.EnvBRDFApprox,"\n").concat(o.FixCubeLookup,"\n").concat(o.correctGamma,"\n").concat(o.COLOR0,"\n").concat(o.COLOR1,"\n\n").concat(i.changeContrast,"\n\n").concat(a.default,"\n\n//").concat(l.spotFrag,"\n\n").concat(r.SUN_MORNING,"\n").concat(r.SUN_EVENING,"\n").concat(r.sunSkyPosition,"\n").concat(r.mixMorningEvening,"\n\n//").concat(u.applyFog,"\n\n").concat(s.default,"\n\n\nvoid main() {\n\tvec2 st = vTextureCoord;\n\n\t//vec4 dv = texture2D( uHeightMap, vTextureCoord );\n\tvec3 L = normalize(sunPosition);\n\tvec3 N = normalize(vNormal * 2.0 - 1.0);\n\n\tL.y *= -1.;\n\tL.x *= -1.;\n\tL.x *= 4.;\n\tfloat _lDot = dot(N, -L);\n\tfloat lambertTerm = max(_lDot,.1);\n\n\n\t//float shadowValue = min(computeShadow(), 1.);\n\n\t// vec3 E = normalize(vEyePosition);\n\t// vec3 P = normalize(vPosition);\n\t// vec3 _pp = P - E;\n\n\n\t//****** THIS IS THE HORIZON linearDepth\n\tfloat _sinSun = sin(-uAngle);\n\tfloat _sunSkyPosition = sunSkyPosition(_sinSun);\n\tvec3 skyHue = mixMorningEvening(_sunSkyPosition);\n\n\t//****** THIS IS FOCAL LENGTH\n\tfloat _near = NEAR + position.z;\n\tfloat _far = FAR + position.z;\n\tfloat linearDepth = clamp(length(vPosition) / (_far - _near), 0., .9);\n\n\t//vec3 mixFogColor = mix(mix(fogColor, baseColor, clamp(_sunSkyPosition, 0., 1.)), skyHue, 0.2);\n\n\t//vec3 color = mix(skyHue, vec3(1.), 0.2);\n\tvec2 _st = st;\n\t_st.y *=2.0;\n\t_st.y = fract(_st.y);\n\tfloat heightMod  = texture2D( uHeightMap, _st ).x;\n\t//****reduce the height 0.5-1.0\n\tfloat heightMapReduced = heightMod * .5 + 0.5;\n\n\t//**** color contrast from the textures\n\tst.y *= 2.0;\n\tst.y = fract(st.y);\n\tvec3 color \t\t = texture2D(uAoMap, st).rgb;\n\tvec3 colorLambert = color * (lambertTerm * 0.2);\n\tcolor +=  colorLambert;\n\tcolor = clamp(color, 0., 1.);\n\n\tcolor *= changeContrast(color, heightMod * 2.5);\n\tfloat ssao \t\t\t= smoothstep(0.02, 1.0, heightMapReduced);\n\tcolor \t\t\t\t*= ssao;\n\n\tcolor += 0.2;\n\n\tvec3 gradientMap = mix(darkColor, lightColor, 1.-heightMod);\n\tgradientMap *= max((lambertTerm - 0.3),.4);\n\n\tvec3 gradientWithSky = mix(skyHue, gradientMap, 0.9);\n\n\tvec3 nColor = color * gradientWithSky;\n\tnColor = changeContrast(nColor, 0.1);\n\t//gradientMap = mix(skyHue, gr)\n\t//gradientMap + mix(skyHue, baseColor, clamp(_sunSkyPosition * 0.8, 0., 0.8 ));\n\n\t//color *= gradientMap;\n\n\t//color += color * lambertTerm;\n\t//color *= lambertTerm;\n\t//color *= clamp((1. - heightMod),0.1, 1.0);\n\n\t//vec3 nColor = blendScreen_20_19(color, gradientMap);\n\n\t//nColor = mix(nColor, baseColor, clamp(_sunSkyPosition * 0.8, 0., 0.8 ));\n\n\t//nColor *= min(shadowValue + step(sunPosition.y, heightMod * heightMap) + SHADOW_INTENSITY, 1.0);\n\t//********* NO GAMMA\n\t// nColor\t\t\t\t= Uncharted2Tonemap( nColor * EXPOSURE );\n\t// nColor\t\t\t\t= nColor * ( 1.0 / Uncharted2Tonemap( vec3( 40.0 ) ) );\n\t// nColor\t\t\t\t= pow( nColor, vec3( 1.0 / GAMMA ) );\n\n\t//vec3 finalColor =  applyFog(nColor, mixFogColor, linearDepth * 0.5, FOG);\n\tvec3 horizonColor = skyHue * linearDepth;\n\tnColor += horizonColor;\n\t//nColor *= (1. - linearDepth);\n\n\tnColor += (skyHue * (1. - horizonBlend(vTextureCoord)) * .2);\n\t//finalColor += (skyHue *= (linearDepth));\n\n\tvec3 washOut = vec3(skyHue) * washOutFactor;\n\n\tgl_FragColor = vec4((nColor *(1. - washOutFactor)) + washOut, 1.0);//vec4(1.0, 0.0, 0.0, 1.0);\n\t//gl_FragColor = vec4(vec3(heightMod), 1.0);//vec4(1.0, 0.0, 0.0, 1.0);\n\t//gl_FragColor = vec4(vec3(horizonColor), 1.0);//vec4(1.0, 0.0, 0.0, 1.0);\n\t//gl_FragColor = vec4(vec3((1. - linearDepth)),1.0);\n}\n\n");t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(125)),r=(i(n(242)),i(n(241)));function i(e){return e&&e.__esModule?e:{default:e}}var a="\n\n#define SHADER_NAME REFLECTION_VERTEX\n#define SPEED  0.2\n#define BELL  40.\nprecision highp float;\n\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec3 aNormal;\n\nuniform sampler2D \tuHeightMap;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uNormalMatrix;\nuniform mat3 uModelViewMatrixInverse;\n\nuniform vec3 position;\nuniform vec3 scale;\nuniform float rotationX;\nuniform float rotationY;\nuniform float heightMap;\nuniform float time;\n\nuniform vec3 uLightPosition;\nuniform vec4 uLightAmbient;\nuniform vec4 uLightDiffuse;\n\nvarying vec2 vTextureCoord;\n\nvarying vec3 vLightRay;\nvarying vec3 vEyeVec;\nvarying vec3 vVertexPosition;\n\nvarying vec3 vNormal;\nvarying vec3 vPosition;\nvarying vec3 vWsPosition;\nvarying vec3 vEyePosition;\nvarying vec3 vWsNormal;\n\n".concat(r.default,"\n").concat(o.default,"\n\nvec2 rotate(vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, -s, s, c);\n\treturn m * v;\n}\n\nvoid main(void) {\n\tvec3 pos \t\t\t\t= aVertexPosition;\n\tvec2 st = aTextureCoord.xy;\n\tst.y *=2.0;\n\tst.y = fract(st.y);\n\tvec3 dv                 = texture2D( uHeightMap, st ).xyz;\n\tfloat _time = time;\n\t//float _s = sin(_time  * SPEED * (aTextureCoord.y +1.)) * 0.5 + 0.5;\n\t//tCoord.y = _s;\n\t//float _perlin = snoise(tCoord);\n\n\tfloat _heightTex  = dv.x;\n\n\t// float pct = 0.0;\n \t// pct = 1.- distance(aTextureCoord,vec2(0.5, _s));\n \t// pct *= BELL;\n\n\t// pos.z += pct;\n\t// pos.z -= BELL / 2.;\n\n\tpos.z += _heightTex * heightMap;\n\t//pos.z = pct;\n\n\tpos.yz \t\t\t\t\t= rotate(pos.yz, rotationX);\n\t//pos.xz \t\t\t\t\t= rotate(pos.xz, rotation);\n\tpos \t\t\t\t\t=  pos * scale + position;\n\tvec4 worldSpacePosition\t= uModelMatrix * vec4(pos, 1.0);\n    vec4 viewSpacePosition\t= uViewMatrix * worldSpacePosition;\n\n\n\tvVertexPosition = pos;\n\t\n    vNormal\t\t\t\t\t= uNormalMatrix * aNormal;\n    vPosition\t\t\t\t= viewSpacePosition.xyz;\n\tvWsPosition\t\t\t\t= worldSpacePosition.xyz;\n\t\n\tvec4 eyeDirViewSpace\t= viewSpacePosition - vec4( 0, 0, 0, 1 );\n\tvEyePosition\t\t\t= -vec3( uModelViewMatrixInverse * eyeDirViewSpace.xyz );\n\tvWsNormal\t\t\t\t= normalize( uModelViewMatrixInverse * vNormal );\n\t\n    gl_Position\t\t\t\t= uProjectionMatrix * viewSpacePosition;\n\n    vNormal = calculateNormals(uHeightMap, aTextureCoord);\n\n\tvTextureCoord\t\t\t= aTextureCoord;\n}\n");t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyFog=void 0;t.applyFog="\n\nvec3 applyFog( in vec3  rgb, vec3 fogColor, in float distance, in float amp ) \n{\n    float fogAmount = 1.0 - exp( -distance * amp);\n    return mix( rgb, fogColor, fogAmount );\n}\n\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="\n\t\tuniform sampler2D tDepth;\n\n\t\tconst float PI = 3.14159265;\n\n\t\tfloat width = 1.0; //texture width\n\t\tfloat height = 1.0; //texture height\n\n\t\tvec2 texel = vec2(1.0/width,1.0/height);\n\n\t\tuniform float focalDepth;  //focal distance value in meters, but you may use autofocus option below\n\t\tuniform float focalLength; //focal length in mm\n\t\tuniform float fstop; //f-stop value\n\t\tuniform bool showFocus; //show debug focus point and focal range (red = focal point, green = focal range)\n\n\t\t/*\n\t\tmake sure that these two values are the same for your camera, otherwise distances will be wrong.\n\t\t*/\n\n\t\tuniform float znear; // camera clipping start\n\t\tuniform float zfar; // camera clipping end\n\n\t\t//------------------------------------------\n\t\t//user variables\n\n\t\tconst int samples = 4; //samples on the first ring\n\t\tconst int rings = 2; //ring count\n\n\t\tconst int maxringsamples = rings * samples;\n\n\t\tuniform bool manualdof; // manual dof calculation\n\t\tfloat ndofstart = 1.0; // near dof blur start\n\t\tfloat ndofdist = 2.0; // near dof blur falloff distance\n\t\tfloat fdofstart = 1.0; // far dof blur start\n\t\tfloat fdofdist = 3.0; // far dof blur falloff distance\n\n\t\tfloat CoC = 0.03; //circle of confusion size in mm (35mm film = 0.03mm)\n\n\t\tuniform bool vignetting; // use optical lens vignetting\n\n\t\tfloat vignout = 1.3; // vignetting outer border\n\t\tfloat vignin = 0.0; // vignetting inner border\n\t\tfloat vignfade = 22.0; // f-stops till vignete fades\n\n\t\tuniform bool shaderFocus;\n\n\t\tbool autofocus = shaderFocus;\n\t\t//use autofocus in shader - use with focusCoords\n\t\t// disable if you use external focalDepth value\n\n\t\tuniform vec2 focusCoords;\n\t\t// autofocus point on screen (0.0,0.0 - left lower corner, 1.0,1.0 - upper right)\n\t\t// if center of screen use vec2(0.5, 0.5);\n\n\t\tuniform float maxblur;\n\t\t//clamp value of max blur (0.0 = no blur, 1.0 default)\n\n\t\tuniform float threshold; // highlight threshold;\n\t\tuniform float gain; // highlight gain;\n\n\t\tuniform float bias; // bokeh edge bias\n\t\tuniform float fringe; // bokeh chromatic aberration / fringing\n\n\t\tuniform bool noise; //use noise instead of pattern for sample dithering\n\n\t\tuniform float dithering;\n\t\tfloat namount = dithering; //dither amount\n\n\t\tuniform bool depthblur; // blur the depth buffer\n\t\tfloat dbsize = 1.25; // depth blur size\n\n\t\t/*\n\t\tnext part is experimental\n\t\tnot looking good with small sample and ring count\n\t\tlooks okay starting from samples = 4, rings = 4\n\t\t*/\n\n\t\tuniform bool pentagon; //use pentagon as bokeh shape?\n\t\tfloat feather = 0.4; //pentagon shape feather\n\n\t\t//------------------------------------------\n\nfloat penta(vec2 coords) {\n    //pentagonal shape\n    float scale = float(rings) - 1.3;\n    vec4 HS0 = vec4(1.0, 0.0, 0.0, 1.0);\n    vec4 HS1 = vec4(0.309016994, 0.951056516, 0.0, 1.0);\n    vec4 HS2 = vec4(-0.809016994, 0.587785252, 0.0, 1.0);\n    vec4 HS3 = vec4(-0.809016994, -0.587785252, 0.0, 1.0);\n    vec4 HS4 = vec4(0.309016994, -0.951056516, 0.0, 1.0);\n    vec4 HS5 = vec4(0.0, 0.0, 1.0, 1.0);\n\n    vec4 one = vec4(1.0);\n\n    vec4 P = vec4((coords), vec2(scale, scale));\n\n    vec4 dist = vec4(0.0);\n    float inorout = -4.0;\n\n    dist.x = dot(P, HS0);\n    dist.y = dot(P, HS1);\n    dist.z = dot(P, HS2);\n    dist.w = dot(P, HS3);\n\n    dist = smoothstep(-feather, feather, dist);\n\n    inorout += dot(dist, one);\n\n    dist.x = dot(P, HS4);\n    dist.y = HS5.w - abs(P.z);\n\n    dist = smoothstep(-feather, feather, dist);\n    inorout += dist.x;\n\n    return clamp(inorout, 0.0, 1.0);\n}\n\nfloat bdepth(vec2 coords) {\n    // Depth buffer blur\n    float d = 0.0;\n    float kernel[9];\n    vec2 offset[9];\n\n    vec2 wh = vec2(texel.x, texel.y) * dbsize;\n\n    offset[0] = vec2(-wh.x, -wh.y);\n    offset[1] = vec2(0.0, -wh.y);\n    offset[2] = vec2(wh.x - wh.y);\n\n    offset[3] = vec2(-wh.x, 0.0);\n    offset[4] = vec2(0.0, 0.0);\n    offset[5] = vec2(wh.x, 0.0);\n\n    offset[6] = vec2(-wh.x, wh.y);\n    offset[7] = vec2(0.0, wh.y);\n    offset[8] = vec2(wh.x, wh.y);\n\n    kernel[0] = 1.0 / 16.0;\n    kernel[1] = 2.0 / 16.0;\n    kernel[2] = 1.0 / 16.0;\n    kernel[3] = 2.0 / 16.0;\n    kernel[4] = 4.0 / 16.0;\n    kernel[5] = 2.0 / 16.0;\n    kernel[6] = 1.0 / 16.0;\n    kernel[7] = 2.0 / 16.0;\n    kernel[8] = 1.0 / 16.0;\n\n\n    for (int i = 0; i < 9; i++) {\n        float tmp = texture2D(tDepth, coords + offset[i]).r;\n        d += tmp * kernel[i];\n    }\n\n    return d;\n}\n\n\n// vec3 color(vec2 coords, float blur) {\n//     //processing the sample\n\n//     vec3 col = vec3(0.0);\n\n//     col.r = texture2D(tColor, coords + vec2(0.0, 1.0) * texel * fringe * blur).r;\n//     col.g = texture2D(tColor, coords + vec2(-0.866, -0.5) * texel * fringe * blur).g;\n//     col.b = texture2D(tColor, coords + vec2(0.866, -0.5) * texel * fringe * blur).b;\n\n//     vec3 lumcoeff = vec3(0.299, 0.587, 0.114);\n//     float lum = dot(col.rgb, lumcoeff);\n//     float thresh = max((lum - threshold) * gain, 0.0);\n//     return col + mix(vec3(0.0), col, thresh * blur);\n// }\n\nvec2 rand(vec2 coord) {\n    // generating noise / pattern texture for dithering\n\n    float noiseX = ((fract(1.0 - coord.s * (width / 2.0)) * 0.25) + (fract(coord.t * (height / 2.0)) * 0.75)) * 2.0 - 1.0;\n    float noiseY = ((fract(1.0 - coord.s * (width / 2.0)) * 0.75) + (fract(coord.t * (height / 2.0)) * 0.25)) * 2.0 - 1.0;\n\n    if (noise) {\n        noiseX = clamp(fract(sin(dot(coord, vec2(12.9898, 78.233))) * 43758.5453), 0.0, 1.0) * 2.0 - 1.0;\n        noiseY = clamp(fract(sin(dot(coord, vec2(12.9898, 78.233) * 2.0)) * 43758.5453), 0.0, 1.0) * 2.0 - 1.0;\n    }\n\n    return vec2(noiseX, noiseY);\n}\n\nvec3 debugFocus(vec3 col, float blur, float depth) {\n    float edge = 0.002 * depth; //distance based edge smoothing\n    float m = clamp(smoothstep(0.0, edge, blur), 0.0, 1.0);\n    float e = clamp(smoothstep(1.0 - edge, 1.0, blur), 0.0, 1.0);\n\n    col = mix(col, vec3(1.0, 0.5, 0.0), (1.0 - m) * 0.6);\n    col = mix(col, vec3(0.0, 0.5, 1.0), ((1.0 - e) - (1.0 - m)) * 0.2);\n\n    return col;\n}\n\nfloat linearize(float depth) {\n    return -zfar * znear / (depth * (zfar - znear) - zfar);\n}\n\n\nfloat vignette() {\n\tfloat dist = distance(vTextureCoord.xy, vec2(0.5, 0.5));\n    dist = smoothstep(vignout + (fstop / vignfade), vignin + (fstop / vignfade), dist);\n    return clamp(dist, 0.0, 1.0);\n}\n\nfloat gather(float i, float j, int ringsamples, inout vec3 col, float w, float h, float blur) {\n    float rings2 = float(rings);\n    float step = PI * 2.0 / float(ringsamples);\n    float pw = cos(j * step) * i;\n    float ph = sin(j * step) * i;\n    float p = 1.0;\n    if (pentagon) {\n        p = penta(vec2(pw, ph));\n    }\n    //col += color(vTextureCoord.xy + vec2(pw * w, ph * h), blur) * mix(1.0, i / rings2, bias) * p;\n    return 1.0 * mix(1.0, i / rings2, bias) * p;\n}\n\n\n//****************\n//****************\n\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="\nfloat wiggleWaveLeft(vec2 st, float size, float intensity) {\n\tsize *= 2.0 - 1.0;\n\tintensity -= 0.5;\n\treturn smoothstep(size, 0.636, 1.080 - abs(intensity*(st.x+st.y*0.0*-intensity - 0.5)));\n}\n\nfloat wiggleWaveRight(vec2 st, float size, float intensity) {\n\tsize *= 2.0 - 1.0;\n\tintensity -= 0.5;\n\treturn smoothstep(size, 0.636, 1.048 - abs(intensity*(st.x+st.y*0.*-intensity - -0.508)));\n}\n\nfloat wiggleWaveTop(vec2 st, float size, float intensity) {\n\tsize *= 2.0 - 1.0;\n\tintensity -= 0.5;\n\treturn smoothstep(size, 0.780, 1.144 - abs(intensity*(st.y*-5.616 - 6.428)));\n}\n\nfloat wiggleWaveBottom(vec2 st, float size, float intensity) {\n\tsize *= 2.0 - 1.0;\n\tintensity -= 0.5;\n\treturn smoothstep(size, 0.780, 1.224 - abs(intensity*(st.y*-4.720 - 0.204)));\n}\n\nfloat horizonBlend(vec2 st){\n\tvec2 leftBlurPos = vec2(0.500,0.00)-st;\n    float leftBlur = wiggleWaveLeft(leftBlurPos, 1.248, 1.744);\n    vec2 rightBlurPos = vec2(0.500,0.00)-st;\n    float rightBlur = wiggleWaveRight(rightBlurPos, 1.248, 1.744);\n    vec2 topBlurPos = vec2(0.980,-0.120)-st;\n    float topBlur = wiggleWaveTop(topBlurPos, 1.248, 0.224);\n    vec2 bottomBlurPos = vec2(0.980,-0.120)-st;\n    float bottomBlur = wiggleWaveBottom(bottomBlurPos, 1.248, 0.224);\n\n\tfloat finalC = topBlur * leftBlur * bottomBlur * rightBlur;\n\treturn finalC;\n}\n\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="\nfloat blendColorDodge_11_0(float base, float blend) {\n\treturn (blend==1.0)?blend:min(base/(1.0-blend),1.0);\n}\n\nvec3 blendColorDodge_11_0(vec3 base, vec3 blend) {\n\treturn vec3(blendColorDodge_11_0(base.r,blend.r),blendColorDodge_11_0(base.g,blend.g),blendColorDodge_11_0(base.b,blend.b));\n}\n\nvec3 blendColorDodge_11_0(vec3 base, vec3 blend, float opacity) {\n\treturn (blendColorDodge_11_0(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nfloat blendColorBurn_12_1(float base, float blend) {\n\treturn (blend==0.0)?blend:max((1.0-((1.0-base)/blend)),0.0);\n}\n\nvec3 blendColorBurn_12_1(vec3 base, vec3 blend) {\n\treturn vec3(blendColorBurn_12_1(base.r,blend.r),blendColorBurn_12_1(base.g,blend.g),blendColorBurn_12_1(base.b,blend.b));\n}\n\nvec3 blendColorBurn_12_1(vec3 base, vec3 blend, float opacity) {\n\treturn (blendColorBurn_12_1(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\n\nfloat blendVividLight_2_2(float base, float blend) {\n\treturn (blend<0.5)?blendColorBurn_12_1(base,(2.0*blend)):blendColorDodge_11_0(base,(2.0*(blend-0.5)));\n}\n\nvec3 blendVividLight_2_2(vec3 base, vec3 blend) {\n\treturn vec3(blendVividLight_2_2(base.r,blend.r),blendVividLight_2_2(base.g,blend.g),blendVividLight_2_2(base.b,blend.b));\n}\n\nvec3 blendVividLight_2_2(vec3 base, vec3 blend, float opacity) {\n\treturn (blendVividLight_2_2(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\n\nfloat blendHardMix_1_3(float base, float blend) {\n\treturn (blendVividLight_2_2(base,blend)<0.5)?0.0:1.0;\n}\n\nvec3 blendHardMix_1_3(vec3 base, vec3 blend) {\n\treturn vec3(blendHardMix_1_3(base.r,blend.r),blendHardMix_1_3(base.g,blend.g),blendHardMix_1_3(base.b,blend.b));\n}\n\nvec3 blendHardMix_1_3(vec3 base, vec3 blend, float opacity) {\n\treturn (blendHardMix_1_3(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\n\nfloat blendLinearDodge_13_4(float base, float blend) {\n\t// Note : Same implementation as BlendAddf\n\treturn min(base+blend,1.0);\n}\n\nvec3 blendLinearDodge_13_4(vec3 base, vec3 blend) {\n\t// Note : Same implementation as BlendAdd\n\treturn min(base+blend,vec3(1.0));\n}\n\nvec3 blendLinearDodge_13_4(vec3 base, vec3 blend, float opacity) {\n\treturn (blendLinearDodge_13_4(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nfloat blendLinearBurn_14_5(float base, float blend) {\n\t// Note : Same implementation as BlendSubstractf\n\treturn max(base+blend-1.0,0.0);\n}\n\nvec3 blendLinearBurn_14_5(vec3 base, vec3 blend) {\n\t// Note : Same implementation as BlendSubstract\n\treturn max(base+blend-vec3(1.0),vec3(0.0));\n}\n\nvec3 blendLinearBurn_14_5(vec3 base, vec3 blend, float opacity) {\n\treturn (blendLinearBurn_14_5(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\n\nfloat blendLinearLight_3_6(float base, float blend) {\n\treturn blend<0.5?blendLinearBurn_14_5(base,(2.0*blend)):blendLinearDodge_13_4(base,(2.0*(blend-0.5)));\n}\n\nvec3 blendLinearLight_3_6(vec3 base, vec3 blend) {\n\treturn vec3(blendLinearLight_3_6(base.r,blend.r),blendLinearLight_3_6(base.g,blend.g),blendLinearLight_3_6(base.b,blend.b));\n}\n\nvec3 blendLinearLight_3_6(vec3 base, vec3 blend, float opacity) {\n\treturn (blendLinearLight_3_6(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nfloat blendLighten_15_7(float base, float blend) {\n\treturn max(blend,base);\n}\n\nvec3 blendLighten_15_7(vec3 base, vec3 blend) {\n\treturn vec3(blendLighten_15_7(base.r,blend.r),blendLighten_15_7(base.g,blend.g),blendLighten_15_7(base.b,blend.b));\n}\n\nvec3 blendLighten_15_7(vec3 base, vec3 blend, float opacity) {\n\treturn (blendLighten_15_7(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nfloat blendDarken_16_8(float base, float blend) {\n\treturn min(blend,base);\n}\n\nvec3 blendDarken_16_8(vec3 base, vec3 blend) {\n\treturn vec3(blendDarken_16_8(base.r,blend.r),blendDarken_16_8(base.g,blend.g),blendDarken_16_8(base.b,blend.b));\n}\n\nvec3 blendDarken_16_8(vec3 base, vec3 blend, float opacity) {\n\treturn (blendDarken_16_8(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\n\nfloat blendPinLight_4_9(float base, float blend) {\n\treturn (blend<0.5)?blendDarken_16_8(base,(2.0*blend)):blendLighten_15_7(base,(2.0*(blend-0.5)));\n}\n\nvec3 blendPinLight_4_9(vec3 base, vec3 blend) {\n\treturn vec3(blendPinLight_4_9(base.r,blend.r),blendPinLight_4_9(base.g,blend.g),blendPinLight_4_9(base.b,blend.b));\n}\n\nvec3 blendPinLight_4_9(vec3 base, vec3 blend, float opacity) {\n\treturn (blendPinLight_4_9(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nfloat blendReflect_17_10(float base, float blend) {\n\treturn (blend==1.0)?blend:min(base*base/(1.0-blend),1.0);\n}\n\nvec3 blendReflect_17_10(vec3 base, vec3 blend) {\n\treturn vec3(blendReflect_17_10(base.r,blend.r),blendReflect_17_10(base.g,blend.g),blendReflect_17_10(base.b,blend.b));\n}\n\nvec3 blendReflect_17_10(vec3 base, vec3 blend, float opacity) {\n\treturn (blendReflect_17_10(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\n\nvec3 blendGlow_5_11(vec3 base, vec3 blend) {\n\treturn blendReflect_17_10(blend,base);\n}\n\nvec3 blendGlow_5_11(vec3 base, vec3 blend, float opacity) {\n\treturn (blendGlow_5_11(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nfloat blendOverlay_8_12(float base, float blend) {\n\treturn base<0.5?(2.0*base*blend):(1.0-2.0*(1.0-base)*(1.0-blend));\n}\n\nvec3 blendOverlay_8_12(vec3 base, vec3 blend) {\n\treturn vec3(blendOverlay_8_12(base.r,blend.r),blendOverlay_8_12(base.g,blend.g),blendOverlay_8_12(base.b,blend.b));\n}\n\nvec3 blendOverlay_8_12(vec3 base, vec3 blend, float opacity) {\n\treturn (blendOverlay_8_12(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\n\nvec3 blendHardLight_6_13(vec3 base, vec3 blend) {\n\treturn blendOverlay_8_12(blend,base);\n}\n\nvec3 blendHardLight_6_13(vec3 base, vec3 blend, float opacity) {\n\treturn (blendHardLight_6_13(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nvec3 blendPhoenix_7_14(vec3 base, vec3 blend) {\n\treturn min(base,blend)-max(base,blend)+vec3(1.0);\n}\n\nvec3 blendPhoenix_7_14(vec3 base, vec3 blend, float opacity) {\n\treturn (blendPhoenix_7_14(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\n\nvec3 blendNormal_9_15(vec3 base, vec3 blend) {\n\treturn blend;\n}\n\nvec3 blendNormal_9_15(vec3 base, vec3 blend, float opacity) {\n\treturn (blendNormal_9_15(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nvec3 blendNegation_10_16(vec3 base, vec3 blend) {\n\treturn vec3(1.0)-abs(vec3(1.0)-base-blend);\n}\n\nvec3 blendNegation_10_16(vec3 base, vec3 blend, float opacity) {\n\treturn (blendNegation_10_16(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nvec3 blendMultiply_18_17(vec3 base, vec3 blend) {\n\treturn base*blend;\n}\n\nvec3 blendMultiply_18_17(vec3 base, vec3 blend, float opacity) {\n\treturn (blendMultiply_18_17(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\n\nvec3 blendAverage_19_18(vec3 base, vec3 blend) {\n\treturn (base+blend)/2.0;\n}\n\nvec3 blendAverage_19_18(vec3 base, vec3 blend, float opacity) {\n\treturn (blendAverage_19_18(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\n\n\nfloat blendScreen_20_19(float base, float blend) {\n\treturn 1.0-((1.0-base)*(1.0-blend));\n}\n\nvec3 blendScreen_20_19(vec3 base, vec3 blend) {\n\treturn vec3(blendScreen_20_19(base.r,blend.r),blendScreen_20_19(base.g,blend.g),blendScreen_20_19(base.b,blend.b));\n}\n\nvec3 blendScreen_20_19(vec3 base, vec3 blend, float opacity) {\n\treturn (blendScreen_20_19(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nfloat blendSoftLight_21_20(float base, float blend) {\n\treturn (blend<0.5)?(2.0*base*blend+base*base*(1.0-2.0*blend)):(sqrt(base)*(2.0*blend-1.0)+2.0*base*(1.0-blend));\n}\n\nvec3 blendSoftLight_21_20(vec3 base, vec3 blend) {\n\treturn vec3(blendSoftLight_21_20(base.r,blend.r),blendSoftLight_21_20(base.g,blend.g),blendSoftLight_21_20(base.b,blend.b));\n}\n\nvec3 blendSoftLight_21_20(vec3 base, vec3 blend, float opacity) {\n\treturn (blendSoftLight_21_20(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nfloat blendSubstract_22_21(float base, float blend) {\n\treturn max(base+blend-1.0,0.0);\n}\n\nvec3 blendSubstract_22_21(vec3 base, vec3 blend) {\n\treturn max(base+blend-vec3(1.0),vec3(0.0));\n}\n\nvec3 blendSubstract_22_21(vec3 base, vec3 blend, float opacity) {\n\treturn (blendSubstract_22_21(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nvec3 blendExclusion_23_22(vec3 base, vec3 blend) {\n\treturn base+blend-2.0*base*blend;\n}\n\nvec3 blendExclusion_23_22(vec3 base, vec3 blend, float opacity) {\n\treturn (blendExclusion_23_22(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nvec3 blendDifference_24_23(vec3 base, vec3 blend) {\n\treturn abs(base-blend);\n}\n\nvec3 blendDifference_24_23(vec3 base, vec3 blend, float opacity) {\n\treturn (blendDifference_24_23(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nfloat blendAdd_25_24(float base, float blend) {\n\treturn min(base+blend,1.0);\n}\n\nvec3 blendAdd_25_24(vec3 base, vec3 blend) {\n\treturn min(base+blend,vec3(1.0));\n}\n\nvec3 blendAdd_25_24(vec3 base, vec3 blend, float opacity) {\n\treturn (blendAdd_25_24(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.changeContrast=void 0;t.changeContrast="\n\nvec3 changeContrast( vec3 color, float amount )\n{\n\treturn (color - 0.5) * (amount + 1.0) + 0.5;\n}\n\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.COLOR1=t.COLOR0=t.correctGamma=t.FixCubeLookup=t.EnvBRDFApprox=t.Uncharted2Tonemap=void 0;t.EnvBRDFApprox="\n\n// https://www.unrealengine.com/blog/physically-based-shading-on-mobile\nvec3 EnvBRDFApprox( vec3 SpecularColor, float Roughness, float NoV )\n{\n\tconst vec4 c0 = vec4( -1, -0.0275, -0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, -0.04 );\n\tvec4 r = Roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( -9.28 * NoV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn SpecularColor * AB.x + AB.y;\n}\n\n";t.FixCubeLookup="\n\n// http://the-witness.net/news/2012/02/seamless-cube-map-filtering/\nvec3 fix_cube_lookup( vec3 v, float cube_size, float lod ) {\n\tfloat M = max(max(abs(v.x), abs(v.y)), abs(v.z));\n\tfloat scale = 1.0 - exp2(lod) / cube_size;\n\tif (abs(v.x) != M) v.x *= scale;\n\tif (abs(v.y) != M) v.y *= scale;\n\tif (abs(v.z) != M) v.z *= scale;\n\treturn v;\n}\n\n";t.Uncharted2Tonemap="\nvec3 Uncharted2Tonemap( vec3 x )\n{\n\treturn ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;\n}\n\n";t.correctGamma="\nvec3 correctGamma(vec3 color, float g) {\n\treturn pow(color, vec3(1.0/g));\n}\n\n";t.COLOR0="const vec3 COLOR0 = 1.0 - vec3(198.0, 151.0, 75.0)/255.0;";t.COLOR1="const vec3 COLOR1 = vec3(1.0);"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(245))&&o.__esModule?o:{default:o};var i="\n\t".concat(r.default,"\n\t\n\tconst float SHIFT = .001;\n\n\tvec3 calculateNormals(in sampler2D texture, in vec2 texCoord)\n\t{\n\t\tconst float XZScale = 2.0;\n\t\tconst float YSCale = 1.0;\n\t\tfloat gap = map(SHIFT, 0.0, 1.0, 0.0, 2.0);\n\t\t// float gap = SHIFT;\n\n\t\tvec3 pixelCurr  = vec3(texCoord.x, texture2D(texture, texCoord).r, texCoord.y);\n\t\tvec3 pixelRight = vec3(texCoord.x+gap, texture2D(texture, texCoord+vec2(SHIFT, 0.0)).r, texCoord.y);\n\t\tvec3 pixelUp    = vec3(texCoord.x, texture2D(texture, texCoord+vec2(0.0, SHIFT)).r, texCoord.y+gap);\n\n\t\tpixelCurr  *= vec3(XZScale, YSCale, XZScale);\n\t\tpixelRight *= vec3(XZScale, YSCale, XZScale);\n\t\tpixelUp    *= vec3(XZScale, YSCale, XZScale);\n\n\t\tvec3 vRight = pixelRight - pixelCurr;\n\t\tvec3 vUp = pixelUp - pixelCurr;\n\n\t\t// vec3 normal = (normalize(cross(vRight, vUp)) + 1.0) * .5;\n\t\tvec3 normal = (normalize(cross(vUp, vRight)) + 1.0) * .5;\n\t\treturn normal;\n\t}\n");t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(10);function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._imageWidth=t.width||256,this._imageHeight=t.height||768,this._offset=t.offset||256,this._verbose=t.verbose,this._canvas=document.createElement("canvas"),this._ctx=this._canvas.getContext("2d"),this._canvas.width=this._imageWidth,this._canvas.height=this._imageHeight+this._offset,this._verbose&&(this._canvas.style.position="absolute",this._canvas.style.left=t.verboseLeft+"px",this._canvas.style.transformOrigin="50% 5%",this._canvas.style.transform="scale(0.5)",document.body.appendChild(this._canvas)),this._y=0,this._idIndex=0,this._sampleY=0,this._placeY=this._imageHeight+this._offset,this._goingDown=!0,this._assetId&&this.init(this._assetId),this._needsUpdate=!0}var t,n,i;return t=e,(n=[{key:"setTerrains",value:function(e){this._ids=e,this._draw(this._ids[this._idIndex])}},{key:"getNextTerrainId",value:function(){var e=this._idIndex+1;return e>this._ids.length-1&&(e=0),this._ids[e]}},{key:"getPixelValueAt",value:function(e,t){var n=Math.floor(t/this._imageHeight)%this._ids.length;this._draw(this._ids[n]),e=Math.round(e)+this._imageWidth/2,t=Math.round(t%this._imageHeight)+this._imageHeight/2;var o=this._ctx.getImageData(e,t,1,1).data;return this._draw(this._ids[this._idIndex]),o[0]/255}},{key:"next",value:function(){this._idIndex++,this._idIndex>this._ids.length-1&&(this._idIndex=0),this._draw(this._ids[this._idIndex])}},{key:"_completed",value:function(){this._idIndex++,this._idIndex>this._ids.length-1&&(this._idIndex=0),this._draw(this._ids[this._idIndex])}},{key:"_draw",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e=e||this._ids[this._idIndex],this._drawSource(e,t)}},{key:"_drawSource",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?-this._imageWidth:0;this._ctx.save(),t?this._ctx.scale(-1,1):this._ctx.scale(1,1),this._ctx.drawImage((0,o.getAsset)(e),n,this._offset);var r=this.getNextTerrainId();this._ctx.drawImage((0,o.getAsset)(r),n,this._imageHeight-this._offset,this._imageWidth,this._offset,0,0,this._imageWidth,this._offset),this._ctx.restore(),this._blendWithNext(this._ctx)}},{key:"_blendWithNext",value:function(e){for(var t=e.getImageData(0,0,this._imageWidth,this._imageHeight+this._offset),n=4*this._imageWidth*(this._offset-40),o=4*this._imageWidth*(this._offset+40),r=4*this._imageWidth*40,i=r;i--;){var a=i/r,s=Math.floor(t.data[n-i]*a),u=Math.floor(t.data[o-i]*(1-a));t.data[o-i]=s+u}e.putImageData(t,0,0)}},{key:"blendSide",value:function(e,t){var n=e.data.length,o=t?0:this._imageWidth-40,r=this._imageHeight+this._offset,i=this._ctx.getImageData(o,0,40,r),a=4*r*40,s=t?0:a;s=0;var u;u=a;for(4;s<u;s+=4){var l=1,c=s%n;l=s%160/160,t||(l=1-l);var f=Math.floor(e.data[c]*(1-l)),h=Math.floor(e.data[c+1]*(1-l)),d=Math.floor(e.data[c+2]*(1-l)),v=(Math.floor(e.data[c+3]),Math.floor(i.data[s]*l)),p=Math.floor(i.data[s+1]*l),_=Math.floor(i.data[s+2]*l);Math.floor(i.data[s+3]);i.data[s]=f+v,i.data[s+1]=h+p,i.data[s+2]=d+_,i.data[s+3]=255}this._ctx.putImageData(i,o,0)}},{key:"getSide",value:function(e){var t=e?0:this._imageWidth-40,n=this._imageHeight+this._offset;this._draw(null,!0);var o=this._ctx.getImageData(t,0,40,n);return this._draw(null,!1),o}},{key:"init",value:function(e){this._drawSource(e)}},{key:"_getMap",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:256,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:256;return this._ctx.getImageData(e,t,n,o)}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:INCRE,t=e;this._countingUp&&(t*=-1),this._sampleY+=t,this._placeY-=e;this._needsUpdate=!1,(this._sampleY<=0||this._sampleY>=this._imageHeight)&&(this._countingUp=!this._countingUp),this._placeY<this._offset&&(this._placeY=this._imageHeight+this._offset,this._completed(),this._needsUpdate=!0);this._placeY,this._imageHeight}},{key:"offset",get:function(){return this._offset},set:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0];this._offset=e}},{key:"canvas",get:function(){return this._canvas}},{key:"needsUpdate",get:function(){return this._needsUpdate}}])&&r(t.prototype,n),i&&r(t,i),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="highp float random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt= dot(co.xy ,vec2(a,b));\n    highp float sn= mod(dt,3.14);\n    return fract(sin(sn) * c);\n}"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="//----------------------------------------------------------------------------------------\n\n#define FBM_NOISE_RES 2\n\nfloat Hash(in vec2 p, in float scale)\n{\n\t// This is tiling part, adjusts with the scale...\n\tp = mod(p, scale);\n\treturn fract(sin(dot(p, vec2(27.16898, 38.90563))) * 5151.5473453);\n}\n\n//----------------------------------------------------------------------------------------\nfloat Noise(in vec2 p, in float scale )\n{\n\tvec2 f;\n\t\n\tp *= scale;\n\n\t\n\tf = fract(p);\t\t// Separate integer from fractional\n    p = floor(p);\n\t\n    f = f*f*(3.0-2.0*f);\t// Cosine interpolation approximation\n\t\n    float res = mix(mix(Hash(p, \t\t\t\t scale),\n\t\t\t\t\t\tHash(p + vec2(1.0, 0.0), scale), f.x),\n\t\t\t\t\tmix(Hash(p + vec2(0.0, 1.0), scale),\n\t\t\t\t\t\tHash(p + vec2(1.0, 1.0), scale), f.x), f.y);\n    return res;\n}\n\n//----------------------------------------------------------------------------------------\nfloat fBm(in vec2 p, in float time, in float amp)\n{\n\tfloat _s = sin(time * .7);\n\tfloat _c = cos(time * .45);\n    p += vec2(_s, _c)*(.01);\n    p += vec2(_s, _c)*(.01);\n    p += vec2(_s, _c)*(.01);\n\tfloat f = 0.0;\n\t// Change starting scale to any integer value...\n\tfloat scale = 7.;\n    p = mod(p, scale);\n\t\n\tfor (int i = 0; i < FBM_NOISE_RES; i++)\n\t{\n\t\tf += Noise(p, scale) * amp;\n\t\tamp *= .5;\n\t\t// Scale must be multiplied by an integer value...\n\t\tscale *= 2.;\n\t}\n\t// Clamp it just in case....\n\treturn min(f, 1.0);\n}"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(128)),r=i(n(127));function i(e){return e&&e.__esModule?e:{default:e}}var a="\n\nconst vec3 ATMOSPHERE_COLOR = vec3(.607843137, .525490196, .564705882);\nconst vec3 ATMOSPHERE_COLOR_RED = vec3(.62745098, .250980392, .223529412);\n\n".concat(o.default,"\n\n").concat(r.default,"\n\nvec3 atmosphere(in vec2 p, in float time, in float amp){\n\tfloat fbm = fBm(p, time, amp);\n\tvec3 baseColor = ATMOSPHERE_COLOR_RED * fbm;\n\tvec3 highlightsColor = ATMOSPHERE_COLOR * (1. - fbm);\n\tvec3 color = baseColor + highlightsColor;\n\tfloat _r = random(p);\n\tvec3 noise = vec3 (_r,_r,_r);\n\tvec3 final = mix(noise, color, 0.92);\n\treturn final;\n}\n\n");t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="\nfloat blendScreen_20_19(float base, float blend) {\n\treturn 1.0-((1.0-base)*(1.0-blend));\n}\n\nvec3 blendScreen_20_19(vec3 base, vec3 blend) {\n\treturn vec3(blendScreen_20_19(base.r,blend.r),blendScreen_20_19(base.g,blend.g),blendScreen_20_19(base.b,blend.b));\n}\n\nvec3 blendScreen_20_19(vec3 base, vec3 blend, float opacity) {\n\treturn (blendScreen_20_19(base, blend) * opacity + blend * (1.0 - opacity));\n}"},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;l(n(131));var o=u(n(6)),r=(l(n(12)),l(n(33))),i=u(n(4)),a=n(10),s=l(n(20));function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}function l(e){return e&&e.__esModule?e:{default:e}}function c(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var h=i.default.GL,d=(Math.PI,Math.PI/2),v=Math.PI,p=function(){function e(t){var n=this;arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controls=t,this.rx=this.controls.rx,this.ry=this.controls.ry,this.radius=this.controls.radius,this._mouse={},this.controls.rx.limit(0,Math.PI/2),this._baseRadius=this.controls.radius.value,this._coordTransfer=[],this._rotateValue=0,this._ascendValue=0,s.default.on("set:meshdata",function(e){n._setMeshData(e)}),s.default.on("camera:hotspot",function(e){n._goToHotspot(e)}),this.COORDS={x:this.controls.positionOffset[0],y:this.controls.positionOffset[1],z:this.controls.positionOffset[2]},this.ROTATE={ry:this.controls.ry.value},this.RX={rx:this.controls.rx.value},this._tweenCoordObj=Object.assign({},this.COORDS),this._tweenRotateObj=Object.assign({},this.ROTATE),this._tweenRxObj=Object.assign({},this.RX),this._tweenRadiusObj={radius:this.controls.radius.value},this._preventLooseControls=!0,this._scheduleId=r.default.addEF(function(){return n._loop()})}var t,n,i;return t=e,(n=[{key:"init",value:function(e,t){var n=t.start;this._sculptures=e,this.controls.rx.value=n.rx,this.controls.radius.value=n.radius||this.controls.radius.value,this.controls.setCenter(n.p),this.controls.setPositionOffset(n.p)}},{key:"enterProductMode",value:function(){this.ry.limit(-v,v),this._removeCruiseControls()}},{key:"leaveProductMode",value:function(){this.ry.limit(-d,d),this._addCruiseControls()}},{key:"animate",value:function(e){this.controls.lock(!0),this._timeline=new TimelineMax({paused:!0,onComplete:this._introAnimationComplete.bind(this)});var t=this._sculptures.activeMesh.data.hotspots[0];this._goToHotspot(t),this._addExploreControls()}},{key:"goToNext",value:function(){}},{key:"moveToActive",value:function(){var e=this._sculptures.activeMesh;this._moveTo(e.position,{y:this._tweenCoordObj.y})}},{key:"_introAnimationComplete",value:function(){var e=this._sculptures.activeMesh.data.hotspots[0];this._goToHotspot(e)}},{key:"_addCruiseControls",value:function(){var e=this;window.addEventListener("mousemove",function(t){return e._onCruiseMove(t)}),window.addEventListener("touchmove",function(t){return e._onCruiseMove(t)})}},{key:"_removeCruiseControls",value:function(){var e=this;window.removeEventListener("mousemove",function(t){return e._onCruiseMove(t)}),window.removeEventListener("touchmove",function(t){return e._onCruiseMove(t)})}},{key:"_addExploreControls",value:function(){var e=this;this.controls.lock(!1),window.addEventListener("mousemove",function(t){return e._onMouseMove(t)}),window.addEventListener("touchmove",function(t){return e._onMouseMove(t)}),window.addEventListener("mousedown",function(t){return e._onDown(t)}),window.addEventListener("touchstart",function(t){return e._onDown(t)}),window.addEventListener("touchend",function(){return e._onUp()}),window.addEventListener("mouseup",function(){return e._onUp()}),this._preventLooseControls=!1}},{key:"_removeExploreControls",value:function(){var e=this;this.controls.lock(!0),window.removeEventListener("mousemove",function(t){return e._onMouseMove(t)}),window.removeEventListener("touchmove",function(t){return e._onMouseMove(t)}),window.removeEventListener("mousedown",function(t){return e._onDown(t)}),window.removeEventListener("touchstart",function(t){return e._onDown(t)}),window.removeEventListener("touchend",function(){return e._onUp()}),window.removeEventListener("mouseup",function(){return e._onUp()}),this._preventLooseControls=!0}},{key:"_goToHotspot",value:function(e){var t,n;this._preventLooseControls=!0,console.log(e),this._removeExploreControls(),this._addExploreControls();var r,i=e.rotate,a=e.rx;e.radius;a.limit&&(this.rx.setTo(this.rx.value<a.limit[0]?a.limit[0]:this.rx.value),this.rx.setTo(this.rx.value>a.limit[1]?a.limit[1]:this.rx.value),(r=this.rx).limit.apply(r,c(a.limit)));i&&this.rotate(i.value),this.rxTo(a.value),this.radiusTo(e.radius.value),(t=this.radius).limit.apply(t,c(e.radius.limit));var s=e.local||[0,0,0],u=o.vec3.create();o.vec3.copy(u,this._sculptures.activeMesh.position),u[1]=0,o.vec3.add(u,u,(n=o.vec3).fromValues.apply(n,c(s))),this._moveTo(u),console.log(u)}},{key:"_setMeshData",value:function(e){this._meshData=e}},{key:"_loop",value:function(){}},{key:"_onDown",value:function(e){this._preventLooseControls=!0}},{key:"_onUp",value:function(){this._preventLooseControls=!1}},{key:"_onCruiseMove",value:function(e){(0,a.getMouse)(e,this._mouse);var t=h.width,n=h.height;this._mouse.y,this._mouse.x}},{key:"_onMouseMove",value:function(e){if(!this._preventLooseControls){(0,a.getMouse)(e,this._mouse);var t=h.width,n=h.height,o=.05*(1-this._mouse.y/n-.5),r=.4*(1-this._mouse.x/t-.5);this._ascendValue=o,this._rotateValue=r}}},{key:"setCamera",value:function(e){this.controls.setPositionOffset(e),this.controls.setCenter(e)}},{key:"_getDotRotation",value:function(e,t){return o.vec3.dot(t,e)}},{key:"moveTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._moveTo(e,t)}},{key:"rotate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._rotate(e,t)}},{key:"radiusTo",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(t=TweenMax).to.apply(t,c(this._getRadius(e,n)))}},{key:"rxTo",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(t=TweenMax).to.apply(t,c(this._getRx(e,n)))}},{key:"_lookAtMesh",value:function(e){var t=this._getDotRotation(this.controls.getNormalizedPosition(),e.normalizedPosition)-e.rotation;this._rotate(this.ry.value+t)}},{key:"_moveTo",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=this._assignPropsToModel(e,this.COORDS),r=this._createCoordTween(o,n);(t=TweenMax).to.apply(t,c(r))}},{key:"_rotate",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(t=TweenMax).to.apply(t,c(this._getRotate(e,n)))}},{key:"getMoveTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this._assignPropsToModel(e,this.COORDS);return this._createCoordTween(n,t)}},{key:"_getRadius",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=Object.assign({},{radius:e,overwrite:1,ease:Power1.easeInOut,onUpdate:function(){t.controls.radius.value=t._tweenRadiusObj.radius}},n);return[this._tweenRadiusObj,n.duration||1,o]}},{key:"_getRotate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createRotationTween(e,t)}},{key:"_getRx",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=Object.assign({},{rx:e,overwrite:1,ease:Power1.easeInOut,onUpdate:function(){t.rx.value=t._tweenRxObj.rx}},n);return[this._tweenRxObj,n.duration||1,o]}},{key:"_createCoordTween",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=Object.assign({},e,{onUpdate:function(){t._coordTransfer[0]=t._tweenCoordObj.x,//!!!!!!!HACK
t._coordTransfer[1]=t._tweenCoordObj.y,t._coordTransfer[2]=t._tweenCoordObj.z,t.setCamera(t._coordTransfer)}},n);return[this._tweenCoordObj,n.duration||1,o]}},{key:"_createRotationTween",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=Object.assign({},{ry:e,overwrite:1,ease:Power1.easeInOut,onUpdate:function(){t.controls.ry.value=t._tweenRotateObj.ry}},n);return[this._tweenRotateObj,n.duration||1,o]}},{key:"_activeMesh",value:function(){return this._sculptures.activeMesh}},{key:"_assignPropsToModel",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o={};return Object.keys(t).forEach(function(r,i){n?t[r]=e[i]:o[r]=e[i]}),n&&(o=t),o}},{key:"_getNewAscendValue",value:function(){var e=this.controls.positionOffset[1]+this._ascendValue;return e=Math.min(e,this._activeMesh().data.maxY),e=Math.max(e,this._activeMesh().data.minY)}},{key:"_allowAscend",value:function(){}},{key:"_fly",value:function(e){var t={};return Object.keys(this.coords).forEach(function(n,o){t[n]=.5*e[o]}),t.y=20,t}},{key:"start",value:function(){this.anim.start()}},{key:"destroy",value:function(){r.default.removeEF(this._scheduleId),this._removeExploreControls()}},{key:"positionTransfer",get:function(){return this._coordTransfer},set:function(e){this._assignPropsToModel(e,this._tweenCoordObj,!0),this._coordTransfer=e}}])&&f(t.prototype,n),i&&f(t,i),e}();t.default=p},function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}(n(4)).default.GL,i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=name,this._position=t.position||[0,10,0],this._ambient=[1,1,1,1],this._diffuse=[165/255,93/255,53/255,1]||t.diffuse,this._specular=[0,0,0,0],this._uniforms=["uLightAmbient","uLightDiffuse","uLightPosition"]}var t,n,i;return t=e,(n=[{key:"setPosition",value:function(e){this._position=e.slice(0)}},{key:"setDiffuse",value:function(e){this._diffuse=e.slice(0)}},{key:"setAmbient",value:function(e){this._ambient=e.slice(0)}},{key:"setSpecular",value:function(e){this._specular=e.slice(0)}},{key:"bind",value:function(){r.useLight(this)}},{key:"unbind",value:function(){r.useLight(null)}},{key:"position",get:function(){return this._position}},{key:"ambient",get:function(){return this._ambient}},{key:"diffuse",get:function(){return this._diffuse}},{key:"specular",get:function(){return this._specular}},{key:"uniforms",get:function(){return this._uniforms}}])&&o(t.prototype,n),i&&o(t,i),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(54)),r=a(n(33)),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}(n(6));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var l=function(e,t){var n=t||{};return e.touches?(n.x=e.touches[0].pageX,n.y=e.touches[0].pageY):(n.x=e.clientX,n.y=e.clientY),n},c=(Math.PI,function(){function e(t){var n=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._target=t,this._listenerTarget=a,this._mouse={},this._preMouse={},this.center=i.vec3.fromValues(0,0,0),this._up=i.vec3.fromValues(0,1,0),this.radius=new o.default(s),this.position=i.vec3.fromValues(0,0,0),this.positionOffset=i.vec3.fromValues(1,1,1),this.positionOffsetNorm=i.vec3.create(),this._rx=new o.default(0),this._rx.limit(-Math.PI/2,Math.PI/2),this._ry=new o.default(0),this._preRX=0,this._preRY=0,this._isLockZoom=!1,this._isLockRotation=!1,this._isInvert=!1,this._listenerTarget.addEventListener("mousewheel",function(e){return n._onWheel(e)}),this._listenerTarget.addEventListener("DOMMouseScroll",function(e){return n._onWheel(e)}),this._listenerTarget.addEventListener("mousedown",function(e){return n._onDown(e)}),this._listenerTarget.addEventListener("touchstart",function(e){return n._onDown(e)}),this._listenerTarget.addEventListener("mousemove",function(e){return n._onMove(e)}),this._listenerTarget.addEventListener("touchmove",function(e){return n._onMove(e)}),window.addEventListener("touchend",function(){return n._onUp()}),window.addEventListener("mouseup",function(){return n._onUp()}),r.default.addEF(function(){return n._loop()})}var t,n,a;return t=e,(n=[{key:"limit",value:function(e,t){this._rx.limit(e,t)}},{key:"lock",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isLockZoom=e,this._isLockRotation=e}},{key:"lockZoom",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isLockZoom=e}},{key:"lockRotation",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isLockRotation=e}},{key:"inverseControl",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isInvert=e}},{key:"removePress",value:function(e){this._removePress=e}},{key:"_onDown",value:function(e){this._isLockRotation||(this._isMouseDown=!0,l(e,this._mouse),l(e,this._preMouse),this._preRX=this._rx.targetValue,this._preRY=this._ry.targetValue)}},{key:"_onMove",value:function(e){if(!this._isLockRotation&&(l(e,this._mouse),e.touches&&e.preventDefault(),this._isMouseDown)){var t=-(this._mouse.x-this._preMouse.x);this._isInvert&&(t*=-1),this._ry.value=this._preRY-.01*t;var n=-(this._mouse.y-this._preMouse.y);this._isInvert&&(n*=-1),this._rx.value=this._preRX-.01*n}}},{key:"_onUp",value:function(){this._isLockRotation||(this._isMouseDown=!1)}},{key:"_onWheel",value:function(e){if(!this._isLockZoom){var t=e.wheelDelta,n=e.detail,o=0;o=n?t?t/n/40*n>0?1:-1:-n/3:t/120,this.radius.add(2*-o)}}},{key:"_loop",value:function(){this._updatePosition(),this._target&&this._updateCamera()}},{key:"setPositionOffset",value:function(e){var t;(t=i.vec3).set.apply(t,[this.positionOffset].concat(s(e))),this._updatePosition(),this._updateCamera()}},{key:"setCenter",value:function(e){var t;(t=i.vec3).set.apply(t,[this.center].concat(s(e))),this._updateCamera()}},{key:"_updatePosition",value:function(){this.position[1]=Math.sin(this._rx.value)*this.radius.value;var e=Math.cos(this._rx.value)*this.radius.value;this.position[0]=Math.cos(this._ry.value+.5*Math.PI)*e,this.position[2]=Math.sin(this._ry.value+.5*Math.PI)*e,i.vec3.add(this.position,this.position,this.positionOffset)}},{key:"getNormalizedPosition",value:function(){return i.vec3.normalize(this.positionOffsetNorm,this.positionOffset),this.positionOffsetNorm}},{key:"_updateCamera",value:function(){this._target.lookAt(this.position,this.center,this._up)}},{key:"rx",get:function(){return this._rx}},{key:"ry",get:function(){return this._ry}}])&&u(t.prototype,n),a&&u(t,a),e}());t.default=c},function(e,t){e.exports="// general.vert\n\n#define SHADER_NAME GENERAL_VERTEX\n\nprecision highp float;\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nuniform vec3 position;\nuniform vec3 scale;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n\tvec3 pos      = aVertexPosition * scale;\n\tpos           += position;\n\tgl_Position   = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(pos, 1.0);\n\tvTextureCoord = aTextureCoord;\n}"},function(e,t){e.exports="// bigTriangle.vert\n\n#define SHADER_NAME BIG_TRIANGLE_VERTEX\n\nprecision highp float;\nattribute vec2 aPosition;\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n    gl_Position = vec4(aPosition, 0.0, 1.0);\n    vTextureCoord = aPosition * .5 + .5;\n}"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(76))&&o.__esModule?o:{default:o},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}(n(6));function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var l=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));var n=i.vec3.clone([0,0,0]),o=i.vec3.create(),r=i.vec3.clone([0,-1,0]);return e.lookAt(n,o,r),e.ortho(1,-1,1,-1),e}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),n=t,(o=[{key:"setBoundary",value:function(e,t,n,o){this.ortho(e,t,n,o)}},{key:"ortho",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;this.left=e,this.right=t,this.top=n,this.bottom=o,i.mat4.ortho(this._projection,e,t,n,o,0,1e4)}}])&&s(n.prototype,o),a&&s(n,a),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(54)),r=a(n(33)),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}(n(6));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var u=function(e,t){var n=t||{};return e.touches?(n.x=e.touches[0].pageX,n.y=e.touches[0].pageY):(n.x=e.clientX,n.y=e.clientY),n},l=function(){function e(t){var n=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._target=t,this._listenerTarget=a,this._mouse={},this._preMouse={},this.center=i.vec3.fromValues(0,0,0),this._up=i.vec3.fromValues(0,1,0),this.radius=new o.default(s),this.position=i.vec3.fromValues(0,0,this.radius.value),this.positionOffset=i.vec3.create(0,0,0),this._rx=new o.default(0),this._rx.limit(-Math.PI/2,Math.PI/2),this._ry=new o.default(0),this._preRX=0,this._preRY=0,this._isLockZoom=!1,this._isLockRotation=!1,this._isInvert=!1,this._listenerTarget.addEventListener("mousewheel",function(e){return n._onWheel(e)}),this._listenerTarget.addEventListener("DOMMouseScroll",function(e){return n._onWheel(e)}),this._listenerTarget.addEventListener("mousedown",function(e){return n._onDown(e)}),this._listenerTarget.addEventListener("touchstart",function(e){return n._onDown(e)}),this._listenerTarget.addEventListener("mousemove",function(e){return n._onMove(e)}),this._listenerTarget.addEventListener("touchmove",function(e){return n._onMove(e)}),window.addEventListener("touchend",function(){return n._onUp()}),window.addEventListener("mouseup",function(){return n._onUp()}),r.default.addEF(function(){return n._loop()})}var t,n,a;return t=e,(n=[{key:"lock",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isLockZoom=e,this._isLockRotation=e}},{key:"lockZoom",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isLockZoom=e}},{key:"lockRotation",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isLockRotation=e}},{key:"inverseControl",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isInvert=e}},{key:"_onDown",value:function(e){this._isLockRotation||(this._isMouseDown=!0,u(e,this._mouse),u(e,this._preMouse),this._preRX=this._rx.targetValue,this._preRY=this._ry.targetValue)}},{key:"_onMove",value:function(e){if(!this._isLockRotation&&(u(e,this._mouse),e.touches&&e.preventDefault(),this._isMouseDown)){var t=-(this._mouse.x-this._preMouse.x);this._isInvert&&(t*=-1),this._ry.value=this._preRY-.01*t;var n=-(this._mouse.y-this._preMouse.y);this._isInvert&&(n*=-1),this._rx.value=this._preRX-.01*n}}},{key:"_onUp",value:function(){this._isLockRotation||(this._isMouseDown=!1)}},{key:"_onWheel",value:function(e){if(!this._isLockZoom){var t=e.wheelDelta,n=e.detail,o=0;o=n?t?t/n/40*n>0?1:-1:-n/3:t/120,this.radius.add(2*-o)}}},{key:"_loop",value:function(){this._updatePosition(),this._target&&this._updateCamera()}},{key:"_updatePosition",value:function(){this.position[1]=Math.sin(this._rx.value)*this.radius.value;var e=Math.cos(this._rx.value)*this.radius.value;this.position[0]=Math.cos(this._ry.value+.5*Math.PI)*e,this.position[2]=Math.sin(this._ry.value+.5*Math.PI)*e,i.vec3.add(this.position,this.position,this.positionOffset)}},{key:"_updateCamera",value:function(){this._target.lookAt(this.position,this.center,this._up)}},{key:"rx",get:function(){return this._rx}},{key:"ry",get:function(){return this._ry}}])&&s(t.prototype,n),a&&s(t,a),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(11)),r=i(n(141));function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var s,u,l=function(e){return 0!==e&&!(e&e-1)},c=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s=o.default.gl,u=o.default.checkExtension("WEBGL_depth_texture"),this.width=t,this.height=n,this.magFilter=r.magFilter||s.LINEAR,this.minFilter=r.minFilter||s.LINEAR,this.wrapS=r.wrapS||s.CLAMP_TO_EDGE,this.wrapT=r.wrapT||s.CLAMP_TO_EDGE,this.useDepth=r.useDepth||!0,this.useStencil=r.useStencil||!1,l(this.width)&&l(this.height)||(this.wrapS=this.wrapT=s.CLAMP_TO_EDGE,this.minFilter===s.LINEAR_MIPMAP_NEAREST&&(this.minFilter=s.LINEAR)),this._init()}var t,n,i;return t=e,(n=[{key:"_init",value:function(){this.texture=s.createTexture(),this.glTexture=new r.default(this.texture,!0),this.depthTexture=s.createTexture(),this.glDepthTexture=new r.default(this.depthTexture,!0),this.frameBuffer=s.createFramebuffer(),s.bindFramebuffer(s.FRAMEBUFFER,this.frameBuffer),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,this.magFilter),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,this.minFilter),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,this.wrapS),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,this.wrapT),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,this.width,this.height,0,s.RGBA,o.default.isMobile?s.UNSIGNED_BYTE:s.FLOAT,null),u&&(s.bindTexture(s.TEXTURE_2D,this.depthTexture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,this.magFilter),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,this.minFilter),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,this.wrapS),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,this.wrapT),s.texImage2D(s.TEXTURE_2D,0,s.DEPTH_COMPONENT,this.width,this.height,0,s.DEPTH_COMPONENT,s.UNSIGNED_SHORT,null)),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,this.texture,0),s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,this.depthTexture,0),this.minFilter===s.LINEAR_MIPMAP_NEAREST&&(s.bindTexture(s.TEXTURE_2D,this.texture),s.generateMipmap(s.TEXTURE_2D)),s.bindTexture(s.TEXTURE_2D,null),s.bindRenderbuffer(s.RENDERBUFFER,null),s.bindFramebuffer(s.FRAMEBUFFER,null),this.clear()}},{key:"bind",value:function(){o.default.viewport(0,0,this.width,this.height),s.bindFramebuffer(s.FRAMEBUFFER,this.frameBuffer)}},{key:"unbind",value:function(){s.bindFramebuffer(s.FRAMEBUFFER,null),o.default.viewport(0,0,o.default.width,o.default.height)}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.bind(),o.default.clear(e,t,n,r),this.unbind()}},{key:"getTexture",value:function(){return this.glTexture}},{key:"getDepthTexture",value:function(){return this.glDepthTexture}},{key:"minFilter",value:function(e){return e!==s.LINEAR&&e!==s.NEAREST&&e!==s.LINEAR_MIPMAP_NEAREST?this:(this.minFilter=e,this)}},{key:"magFilter",value:function(e){return e!==s.LINEAR&&e!==s.NEAREST&&e!==s.LINEAR_MIPMAP_NEAREST?this:(this.magFilter=e,this)}},{key:"wrapS",value:function(e){return e!==s.CLAMP_TO_EDGE&&e!==s.REPEAT&&e!==s.MIRRORED_REPEAT?this:(this.wrapS=e,this)}},{key:"wrapT",value:function(e){return e!==s.CLAMP_TO_EDGE&&e!==s.REPEAT&&e!==s.MIRRORED_REPEAT?this:(this.wrapT=e,this)}}])&&a(t.prototype,n),i&&a(t,i),e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r,i=(o=n(11))&&o.__esModule?o:{default:o};function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var s=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r=i.default.gl,o)this.texture=t;else{this.texture=r.createTexture(),this.magFilter=n.magFilter||r.LINEAR,this.minFilter=n.minFilter||r.LINEAR_MIPMAP_NEAREST,this.wrapS=n.wrapS||r.CLAMP_TO_EDGE,this.wrapT=n.wrapT||r.CLAMP_TO_EDGE,r.bindTexture(r.TEXTURE_CUBE_MAP,this.texture);for(var a=[r.TEXTURE_CUBE_MAP_POSITIVE_X,r.TEXTURE_CUBE_MAP_NEGATIVE_X,r.TEXTURE_CUBE_MAP_POSITIVE_Y,r.TEXTURE_CUBE_MAP_NEGATIVE_Y,r.TEXTURE_CUBE_MAP_POSITIVE_Z,r.TEXTURE_CUBE_MAP_NEGATIVE_Z],s=0;s<6;s++)r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1),t[s].exposure?r.texImage2D(a[s],0,r.RGBA,t[s].shape[0],t[s].shape[1],0,r.RGBA,r.FLOAT,t[s].data):r.texImage2D(a[s],0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t[s]),r.texParameteri(r.TEXTURE_CUBE_MAP,r.TEXTURE_WRAP_S,this.wrapS),r.texParameteri(r.TEXTURE_CUBE_MAP,r.TEXTURE_WRAP_T,this.wrapT),r.texParameteri(r.TEXTURE_CUBE_MAP,r.TEXTURE_MAG_FILTER,this.magFilter),r.texParameteri(r.TEXTURE_CUBE_MAP,r.TEXTURE_MIN_FILTER,this.minFilter);r.generateMipmap(r.TEXTURE_CUBE_MAP),r.bindTexture(r.TEXTURE_CUBE_MAP,null)}}var t,n,o;return t=e,(n=[{key:"bind",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;i.default.shader&&(r.activeTexture(r.TEXTURE0+e),r.bindTexture(r.TEXTURE_CUBE_MAP,this.texture),r.uniform1i(i.default.shader.uniformTextures[e],e),this._bindIndex=e)}},{key:"unbind",value:function(){r.bindTexture(r.TEXTURE_CUBE_MAP,null)}}])&&a(t.prototype,n),o&&a(t,o),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(11))&&o.__esModule?o:{default:o};function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var a,s=function(e){return 0!==e&&!(e&e-1)},u=function(e){var t=e.width||e.videoWidth,n=e.height||e.videoHeight;return!(!t||!n)&&(s(t)&&s(n))},l=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};((function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),a=r.default.gl,n)?this.texture=t:(this._mSource=t,this.texture=a.createTexture(),this._isVideo="VIDEO"===t.tagName,this.magFilter=o.magFilter||a.LINEAR,this.minFilter=o.minFilter||a.LINEAR_MIPMAP_NEAREST,this.wrapS=o.wrapS||a.MIRRORED_REPEAT,this.wrapT=o.wrapT||a.MIRRORED_REPEAT,(t.width||t.videoWidth)&&u(t)||(this.wrapS=this.wrapT=a.CLAMP_TO_EDGE,this.minFilter===a.LINEAR_MIPMAP_NEAREST&&(this.minFilter=a.LINEAR)),a.bindTexture(a.TEXTURE_2D,this.texture),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!0),t.exposure?(console.log(this._mSource),console.log(this._mSource.data),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,t.shape[0],t.shape[1],0,a.RGBA,a.UNSIGNED_BYTE,t.data)):a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,t),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,this.magFilter),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,this.minFilter),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,this.wrapS),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,this.wrapT),this.minFilter===a.LINEAR_MIPMAP_NEAREST&&a.generateMipmap(a.TEXTURE_2D),a.bindTexture(a.TEXTURE_2D,null))}var t,n,o;return t=e,(n=[{key:"minFilter",value:function(e){return e!==a.LINEAR&&e!==a.NEAREST&&e!==a.LINEAR_MIPMAP_NEAREST?this:(this.minFilter=e,this)}},{key:"magFilter",value:function(e){return e!==a.LINEAR&&e!==a.NEAREST&&e!==a.LINEAR_MIPMAP_NEAREST?this:(this.magFilter=e,this)}},{key:"wrapS",value:function(e){return e!==a.CLAMP_TO_EDGE&&e!==a.REPEAT&&e!==a.MIRRORED_REPEAT?this:(this.wrapS=e,this)}},{key:"wrapT",value:function(e){return e!==a.CLAMP_TO_EDGE&&e!==a.REPEAT&&e!==a.MIRRORED_REPEAT?this:(this.wrapT=e,this)}},{key:"updateTexture",value:function(e){e&&(this._mSource=e),a.bindTexture(a.TEXTURE_2D,this.texture),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!0),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this._mSource),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,this.magFilter),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,this.minFilter),this.minFilter===a.LINEAR_MIPMAP_NEAREST&&a.generateMipmap(a.TEXTURE_2D),a.bindTexture(a.TEXTURE_2D,null)}},{key:"bind",value:function(e){void 0===e&&(e=0),r.default.shader&&(a.activeTexture(a.TEXTURE0+e),a.bindTexture(a.TEXTURE_2D,this.texture),a.uniform1i(r.default.shader.uniformTextures[e],e),this._bindIndex=e)}},{key:"destroy",value:function(){a.deleteTexture(this.texture)}}])&&i(t.prototype,n),o&&i(t,o),e}();t.default=l},,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ORIENTATION_CHANGE=t.RESIZE=t.TOUR_BEARING_CHANGED=t.TOUR_AMBIENT_PLAYBACK=t.TOUR_DOMINANT_PLAYBACK=t.TOUR_SPEAKING_PLAYBACK=t.TOUR_SPEAKING_PLAYING=t.TOUR_SPEAKING_CHANGED=t.TOUR_PAUSE_EXPERIENCE=t.TOUR_USER_COORDS_CHANGED=t.TOUR_SHOW_MAP=t.TOUR_NEXT_LOCATION=t.TOUR_LOCATION_CHANGED=t.LOAD_SEQUENCE_ERROR=t.LOAD_SEQUENCE_SUCCESS=t.LOAD_SEQUENCE_START=t.LOAD_SEQUENCE=t.LOAD_BODYMOVIN_ERROR=t.LOAD_BODYMOVIN_SUCCESS=t.LOAD_BODYMOVIN_START=t.LOAD_BODYMOVIN=t.LOAD_ALHAMBRA_ERROR=t.LOAD_ALHAMBRA_SUCCESS=t.LOAD_ALHAMBRA_START=t.LOAD_ALHAMBRA=void 0;t.LOAD_ALHAMBRA="LOAD_ALHAMBRA";t.LOAD_ALHAMBRA_START="LOAD_ALHAMBRA_START";t.LOAD_ALHAMBRA_SUCCESS="LOAD_ALHAMBRA_SUCCESS";t.LOAD_ALHAMBRA_ERROR="LOAD_ALHAMBRA_ERROR";t.LOAD_BODYMOVIN="LOAD_BODYMOVIN";t.LOAD_BODYMOVIN_START="LOAD_BODYMOVIN_START";t.LOAD_BODYMOVIN_SUCCESS="LOAD_BODYMOVIN_SUCCESS";t.LOAD_BODYMOVIN_ERROR="LOAD_BODYMOVIN_ERROR";t.LOAD_SEQUENCE="LOAD_SEQUENCE";t.LOAD_SEQUENCE_START="LOAD_SEQUENCE_START";t.LOAD_SEQUENCE_SUCCESS="LOAD_SEQUENCE_SUCCESS";t.LOAD_SEQUENCE_ERROR="LOAD_SEQUENCE_ERROR";t.TOUR_LOCATION_CHANGED="TOUR_LOCATION_CHANGED";t.TOUR_NEXT_LOCATION="TOUR_NEXT_LOCATION";t.TOUR_SHOW_MAP="TOUR_SHOW_MAP";t.TOUR_USER_COORDS_CHANGED="TOUR_USER_COORDS_CHANGED";t.TOUR_PAUSE_EXPERIENCE="TOUR_PAUSE_EXPERIENCE";t.TOUR_SPEAKING_CHANGED="TOUR_SPEAKING_CHANGED";t.TOUR_SPEAKING_PLAYING="TOUR_SPEAKING_PLAYING";t.TOUR_SPEAKING_PLAYBACK="TOUR_SPEAKING_PLAYBACK";t.TOUR_DOMINANT_PLAYBACK="TOUR_DOMINANT_PLAYBACK";t.TOUR_AMBIENT_PLAYBACK="TOUR_AMBIENT_PLAYBACK";t.TOUR_BEARING_CHANGED="TOUR_BEARING_CHANGED";t.RESIZE="RESIZE";t.ORIENTATION_CHANGE="ORIENTATION_CHANGE"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="\n\n// basic.frag\n\n#define SHADER_NAME BASIC_FRAGMENT\n\nprecision highp float;\nvarying vec2 vTextureCoord;\nuniform float time;\n// uniform sampler2D texture;\n\nvoid main(void) {\n    gl_FragColor = vec4(vec3(1.0, 0.0, 0.0), 1.0);\n}\n\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="\n\n#define SHADER_NAME REFLECTION_VERTEX\n\nprecision highp float;\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uNormalMatrix;\nuniform mat3 uModelViewMatrixInverse;\n\nuniform vec3 uLightPosition;\nuniform vec4 uLightAmbient;\nuniform vec4 uLightDiffuse;\n\nuniform vec3 position;\nuniform vec3 scale;\nuniform float radius;\nuniform float heightMap;\n\nvarying vec2 vTextureCoord;\n\nvarying vec3 vPosition;\nvarying vec3 vWsPosition;\nvarying vec3 vEyePosition;\n\n\nvec2 rotate(vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, -s, s, c);\n\treturn m * v;\n}\n\nvoid main(void) {\n\tvec3 pos \t\t\t\t= aVertexPosition;\n\tvec3 offsetPos = position;\n\toffsetPos.x *= radius;\n\toffsetPos.y *= radius;\n\t//pos *= radius;\n\t// pos.yz \t\t\t\t\t= rotate(pos.yz, 0.05);\n\t//pos.xz \t\t\t\t\t= rotate(pos.xz, rotation);\n\t//pos.y \t\t\t\t\t+= heightMap;\n\tpos \t\t\t\t\t=  pos * scale + offsetPos;\n\tvec4 worldSpacePosition\t= uModelMatrix * vec4(pos, 1.0);\n    vec4 viewSpacePosition\t= uViewMatrix * worldSpacePosition;\n\n    vPosition\t\t\t\t= viewSpacePosition.xyz;\n\tvWsPosition\t\t\t\t= worldSpacePosition.xyz;\n\t\n\tvec4 eyeDirViewSpace\t= viewSpacePosition - vec4( 0, 0, 0, 1 );\n\tvEyePosition\t\t\t= -vec3( uModelViewMatrixInverse * eyeDirViewSpace.xyz );\n\t\n    gl_Position\t\t\t\t= uProjectionMatrix * viewSpacePosition;\n\n\tvTextureCoord\t\t\t= aTextureCoord;\n}\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(4)),r=a(n(217)),i=a(n(216));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var c=o.default.GL,f=20,h=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r.default,i.default)))._cameraControls=e,n._x=0,n._y=0,n._z=-256,n.scale=1,n.radius=f,n._c=Math.PI,n._position=[],n}var n,a,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.View),n=t,(a=[{key:"_init",value:function(){this.mesh=o.default.Geom.sphere(3,6,!1,!1)}},{key:"updateAngle",value:function(){this._c+=.005,this._x=Math.cos(this._c)*f,this._y=Math.sin(this._c)*f,this._position[0]=this._x,this._position[1]=this._y,this._position[2]=this._z}},{key:"render",value:function(){this._cameraControls&&(this.shader.bind(),this.shader.uniform("position","vec3",[this._x,this._y,this._z]),this.shader.uniform("scale","vec3",[this.scale,this.scale,this.scale]),this.shader.uniform("radius","float",f),c.draw(this.mesh))}},{key:"z",set:function(e){this._z=e}},{key:"position",get:function(){return this._position}},{key:"angle",get:function(){return this._c}}])&&u(n.prototype,a),s&&u(n,s),t}();t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="\n\n// basic.frag\n\n#define SHADER_NAME BASIC_FRAGMENT\n\nprecision highp float;\nvarying vec2 vTextureCoord;\nuniform float time;\nuniform sampler2D texture;\n\nvoid main(void) {\n\tfloat n = 1.0;\n\tfloat f = 2000.0;\n\tfloat z = texture2D(texture, vTextureCoord.st).x;\n\tvec3 rrr = texture2D(texture, vTextureCoord.st).rgb;\n\tfloat grey = (2.0 * n) / (f + n - z*(f-n));\n\tvec4 color = vec4(grey, grey, grey, 1.0);\n\tgl_FragColor = color;\n\t//gl_FragColor = vec4(rrr, 1.0);\n    //gl_FragColor = vec4(vec3(1.0, 0.0, 0.0), 1.0);\n}\n\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="\n\n#define SHADER_NAME REFLECTION_VERTEX\n\nprecision highp float;\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uNormalMatrix;\nuniform mat3 uModelViewMatrixInverse;\n\nuniform vec3 uLightPosition;\nuniform vec4 uLightAmbient;\nuniform vec4 uLightDiffuse;\n\nuniform vec3 position;\nuniform vec3 scale;\nuniform float rotation;\nuniform float heightMap;\n\nvarying vec2 vTextureCoord;\n\nvarying vec3 vPosition;\nvarying vec3 vWsPosition;\nvarying vec3 vEyePosition;\n\n\nvec2 rotate(vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, -s, s, c);\n\treturn m * v;\n}\n\nvoid main(void) {\n\tvec3 pos \t\t\t\t= aVertexPosition;\n\t// pos.yz \t\t\t\t\t= rotate(pos.yz, 0.05);\n\t//pos.xz \t\t\t\t\t= rotate(pos.xz, rotation);\n\t//pos.y \t\t\t\t\t+= heightMap;\n\tpos \t\t\t\t\t=  pos * scale + position;\n\tvec4 worldSpacePosition\t= uModelMatrix * vec4(pos, 1.0);\n    vec4 viewSpacePosition\t= uViewMatrix * worldSpacePosition;\n\n    vPosition\t\t\t\t= viewSpacePosition.xyz;\n\tvWsPosition\t\t\t\t= worldSpacePosition.xyz;\n\t\n\tvec4 eyeDirViewSpace\t= viewSpacePosition - vec4( 0, 0, 0, 1 );\n\tvEyePosition\t\t\t= -vec3( uModelViewMatrixInverse * eyeDirViewSpace.xyz );\n\t\n    gl_Position\t\t\t\t= uProjectionMatrix * viewSpacePosition;\n\n\tvTextureCoord\t\t\t= aTextureCoord;\n}\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(4)),r=a(n(220)),i=a(n(219));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var c=o.default.GL,f=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r.default,i.default))).x=0,e.y=3,e.z=10,e}var n,a,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.View),n=t,(a=[{key:"_init",value:function(){this.mesh=o.default.Geom.plane(4,4,2,!1,!1)}},{key:"render",value:function(e){this.shader.bind(),this.shader.uniform("position","vec3",[this.x,this.y,this.z]),this.shader.uniform("scale","vec3",[1,1,1]),this.shader.uniform("texture","uniform1i",0),e.bind(0),c.draw(this.mesh)}}])&&u(n.prototype,a),s&&u(n,s),t}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(20))&&o.__esModule?o:{default:o};var i=(r.default.on("sculpture:near",function(e){}),r.default.on("sculpture:out",function(e){}),document.addEventListener("keydown",function(e){switch(e.which){case 40:case 83:r.default.emit("keyboard:down:down");break;case 38:case 87:r.default.emit("keyboard:down:up");break;case 68:case 39:r.default.emit("keyboard:down:right");break;case 37:case 65:r.default.emit("keyboard:down:left")}}),document.addEventListener("keyup",function(e){switch(e.which){case 40:case 83:r.default.emit("keyboard:up:down");break;case 38:case 87:r.default.emit("keyboard:up:up");break;case 68:case 39:r.default.emit("keyboard:up:right");break;case 37:case 65:r.default.emit("keyboard:up:left");break;case 32:r.default.emit("keyboard:up:space")}}),{});t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}(n(4)),r=n(6);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e,t,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,t);if(void 0===o){var r=Object.getPrototypeOf(e);return null===r?void 0:u(r,t,n)}if("value"in o)return o.value;var i=o.get;return void 0!==i?i.call(n):void 0}o.default.GL;var l=function(e){function t(e,n){var o;arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)))._camera=e,o._position=r.vec3.fromValues(100,20,12.5),o._target=r.vec3.fromValues(0,0,0),o._direction=r.vec3.create(),o._viewMat=r.mat4.create(),o._upVec=r.vec3.fromValues(0,0,1),o._projectionMat=r.mat4.create(),o._dirty=!0,o.outerAngle=.15*Math.PI,o._projAngle=o.outerAngle*(180/Math.PI)*2,o._cameraViewMat=r.mat4.create(),o._cameraProjMat=r.mat4.create(),o}var n,i,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.FrameBuffer),n=t,(i=[{key:"bind",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"bind",this).call(this),this._camera}},{key:"unbind",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unbind",this).call(this),this._camera}},{key:"_getViewMat",value:function(){return r.mat4.lookAt(this._viewMat,this._camera.position,this._target,this._upVec),this._viewMat}},{key:"_getProjectionMat",value:function(){return r.mat4.perspective(this._projectionMat,this._camera._fov,this._camera._aspectRatio,.1,1e3),this._projectionMat}}])&&a(n.prototype,i),l&&a(n,l),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=["","WEBKIT_","MOZ_"],r=["attribute vec2 position;","attribute vec2 texture;","varying vec2 texCoord;","void main(void) {","   texCoord = texture;","   gl_Position = vec4(position, 0.0, 1.0);","}"].join("\n"),i=["precision mediump float;","uniform sampler2D diffuse;","varying vec2 texCoord;","void main(void) {","   vec4 color = texture2D(diffuse, texCoord);","   gl_FragColor = vec4(color.rgb, color.a);","}"].join("\n"),a=null,s=null,u=new Uint8Array([255,255,255,255]),l=function(){var e=new Array(16),t=0,n=16,o=[],r=function(e){var t=this;this.gl=null,this.texture=null,this.callback=null,this.image=new Image,this.image.addEventListener("load",function(){var n=t.gl;n.bindTexture(n.TEXTURE_2D,t.texture),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t.image),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR_MIPMAP_NEAREST),n.generateMipmap(n.TEXTURE_2D),e(t),t.callback&&t.callback(t.texture)})};r.prototype.loadTexture=function(e,t,n,o){this.gl=e,this.texture=n,this.callback=o,this.image.src=t};function i(n){var r;o.length?(r=o.shift(),n.loadTexture(r.gl,r.src,r.texture,r.callback)):e[t++]=n}return function(a,s,u,l){t?e[--t].loadTexture(a,s,u,l):n?(new r(i).loadTexture(a,s,u,l),--n):o.push(new function(e,t,n,o){this.gl=e,this.src=t,this.texture=n,this.callback=o}(a,s,u,l))}}(),c=function(e,t){var n,o,r,i;for(this.program=t,this.attribute={},this.uniform={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),n=0;n<r;n++)o=e.getActiveAttrib(t,n),this.attribute[o.name]=e.getAttribLocation(t,o.name);for(r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<r;n++)i=e.getActiveUniform(t,n).name.replace("[0]",""),this.uniform[i]=e.getUniformLocation(t,i)},f={ShaderWrapper:c,getContext:function(e,t,n){var o;if(e.getContext)if(2==n)try{if(o=e.getContext("webgl2",t))return o}catch(e){}else{try{if(o=e.getContext("webgl",t))return o}catch(e){}try{if(o=e.getContext("experimental-webgl",t))return o}catch(e){}}return null},showGLFailed:function(e){var t="Either your browser does not support WebGL, or it may be disabled.<br/>";t+='Please visit <a href="http://get.webgl.org">http://get.webgl.org</a> for ',t+="details on how to get a WebGL enabled browser.",this.showFatalError(e,"Sorry, but a WebGL context could not be created",t)},showFatalError:function(e,t,n){var o=document.createElement("div"),r="<h3>"+t+"</h3>"+n;o.innerHTML=r,o.id="gl-error",e.parentNode.replaceChild(o,e)},createProgram:function(e,t,n){var o=e.createProgram(),r=this.compileShader(e,t,e.VERTEX_SHADER),i=this.compileShader(e,n,e.FRAGMENT_SHADER);return e.attachShader(o,r),e.attachShader(o,i),e.linkProgram(o),e.getProgramParameter(o,e.LINK_STATUS)?new c(e,o):(console.error("Program Link error:",e.getProgramInfoLog(o)),e.deleteProgram(o),e.deleteShader(r),e.deleteShader(i),null)},compileShader:function(e,t,n){var o=e.createShader(n);if(e.shaderSource(o,"\n"+t),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS)){var r="";switch(n){case e.VERTEX_SHADER:r="VERTEX_SHADER";break;case e.FRAGMENT_SHADER:r="FRAGMENT_SHADER"}return console.error(r,e.getShaderInfoLog(o)),e.deleteShader(o),null}return o},getExtension:function(e,t){var n,r;for(n in o)if(r=e.getExtension(o[n]+t))return r;return null},createSolidTexture:function(e,t){var n=new Uint8Array(t),o=e.createTexture();return e.bindTexture(e.TEXTURE_2D,o),e.texImage2D(e.TEXTURE_2D,0,e.RGB,1,1,0,e.RGB,e.UNSIGNED_BYTE,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),o},loadTexture:function(e,t,n){var o=e.createTexture();return n||(e.bindTexture(e.TEXTURE_2D,o),e.texImage2D(e.TEXTURE_2D,0,e.RGB,1,1,0,e.RGB,e.UNSIGNED_BYTE,u)),l(e,t,o,n),o},drawTexturedQuad:function(e,t,n,o,u,l){if(!a){s=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,s),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,1,0,1,-1,-1,0,0,1,1,1,1,-1,-1,0,0,1,-1,1,0,1,1,1,1]),e.STATIC_DRAW),a=this.createProgram(e,r,i)}e.getParameter(e.VIEWPORT);e.viewport(n,o,u,l),e.disable(e.DEPTH_TEST),e.useProgram(a.program),e.bindBuffer(e.ARRAY_BUFFER,s),e.enableVertexAttribArray(a.attribute.position),e.enableVertexAttribArray(a.attribute.texture),e.vertexAttribPointer(a.attribute.position,2,e.FLOAT,!1,16,0),e.vertexAttribPointer(a.attribute.texture,2,e.FLOAT,!1,16,8),e.activeTexture(e.TEXTURE0),e.uniform1i(a.uniform.diffuse,0),e.bindTexture(e.TEXTURE_2D,t),e.drawArrays(e.TRIANGLES,0,6),e.enable(e.DEPTH_TEST)},getQueryVariable:function(e){for(var t=window.location.search.substring(1).split("&"),n=0;n<t.length;n++){var o=t[n].split("=");if(o[0]==e)return unescape(o[1])}return null}};t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(10),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}(n(4));function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}r.default.GL;var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=[];t.forEach(function(e){n.push(r.default.HDRLoader.parse((0,o.getAsset)(e)))}),this._texture=new r.default.GLCubeTexture(n)}var t,n,a;return t=e,(n=[{key:"texture",get:function(){return this._texture},set:function(e){return this._texture=e}}])&&i(t.prototype,n),a&&i(t,a),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="\nfloat lambertDiffuse(\n  vec3 lightDirection,\n  vec3 surfaceNormal) {\n  return max(0.0, dot(lightDirection, surfaceNormal));\n}\n\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(226))&&o.__esModule?o:{default:o},i=(n(41),n(52));var a="\n\n#extension GL_EXT_shader_texture_lod : enable\n\nprecision highp float;\n\nuniform sampler2D \tuDiffuse;\nuniform sampler2D \tuAoMap;\nuniform sampler2D \tshadowMap;\n//uniform samplerCube uRadianceMap;\n//uniform samplerCube uIrradianceMap;\n\nuniform vec3\t\tuBaseColor;\nuniform float\t\tuRoughness;\nuniform float\t\tuRoughness4;\nuniform float\t\tuMetallic;\nuniform float\t\tuSpecular;\nuniform float \t\tuAoStrength;\nuniform float\t\tuExposure;\nuniform float\t\tuGamma;\nuniform float\t\tuGreenOffset;\n\nuniform float baseColorAmount;\nuniform float diffuseColorAmount;\nuniform float uLightIntensity;\n\nuniform int useDepth;\nuniform float uAngle;\n\nvarying vec3        vNormal;\nvarying vec3        vPosition;\nvarying vec3\t\tvEyePosition;\nvarying vec3\t\tvWsNormal;\nvarying vec3\t\tvWsPosition;\nvarying vec2 \t\tvTextureCoord;\n\nvarying vec3 vLightRay;\nvarying vec3 vEyeVec;\n\n#define saturate(x) clamp(x, 0.0, 1.0)\n#define PI 3.1415926535897932384626433832795\n\n\n// Filmic tonemapping from\n// http://filmicgames.com/archives/75\n\nconst float A = 0.15;\nconst float B = 0.50;\nconst float C = 0.10;\nconst float D = 0.20;\nconst float E = 0.02;\nconst float F = 0.30;\n\n".concat(i.SUN_MORNING,"\n").concat(i.SUN_EVENING,"\n").concat(i.sunSkyPosition,"\n").concat(i.mixMorningEvening,"\n\n\nvec3 Uncharted2Tonemap( vec3 x )\n{\n\treturn ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;\n}\n\n// https://www.unrealengine.com/blog/physically-based-shading-on-mobile\nvec3 EnvBRDFApprox( vec3 SpecularColor, float Roughness, float NoV )\n{\n\tconst vec4 c0 = vec4( -1, -0.0275, -0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, -0.04 );\n\tvec4 r = Roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( -9.28 * NoV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn SpecularColor * AB.x + AB.y;\n}\n\n\n// http://the-witness.net/news/2012/02/seamless-cube-map-filtering/\nvec3 fix_cube_lookup( vec3 v, float cube_size, float lod ) {\n\tfloat M = max(max(abs(v.x), abs(v.y)), abs(v.z));\n\tfloat scale = 1.0 - exp2(lod) / cube_size;\n\tif (abs(v.x) != M) v.x *= scale;\n\tif (abs(v.y) != M) v.y *= scale;\n\tif (abs(v.z) != M) v.z *= scale;\n\treturn v;\n}\n\nvec3 correctGamma(vec3 color, float g) {\n\treturn pow(color, vec3(1.0/g));\n}\n\n").concat(r.default,"\n\nconst mat4 depthScaleMatrix = mat4(0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.5, 0.5, 0.5, 1.0);\n\nfloat computeShadow(vec4 pos) {\n      vec3 depth = pos.xyz / pos.w;\n       float shadowValue = texture2D(shadowMap, depth.xy).r;\n       depth.z *= 0.999;\n       float step = step(depth.z, shadowValue);\n       float mm = max(step, (1.-pos.x));\n       return mm;\n    }\n\n\nconst vec3 COLOR0 = 1.0 - vec3(198.0, 151.0, 75.0)/255.0;\nconst vec3 COLOR1 = vec3(1.0);\n\nvoid main() {\n\tfloat mRoughness    = uRoughness;\n\tfloat mMetallic     = uMetallic;\n\tfloat mSpecular     = uSpecular;\n\n\n\tvec3 N \t\t\t\t= normalize( vWsNormal );\n\tvec3 V \t\t\t\t= normalize( vEyePosition );\n\n\tvec3 L = normalize(vLightRay);\n\tfloat lambertTerm = max(dot(N,-L),0.33);\n\n\t//****** THIS IS THE HORIZON linearDepth\n\tfloat _sinSun = sin(-uAngle);\n\tfloat _sunSkyPosition = sunSkyPosition(_sinSun);\n\tvec3 skyHue = mixMorningEvening(_sunSkyPosition);\n\n\t// deduce the diffuse and specular color from the baseColor and how metallic the material is\n\tvec3 diffuseColor\t= uBaseColor - uBaseColor * mMetallic;\n\tdiffuseColor *= baseColorAmount;\n\tvec3 specularColor\t= mix( vec3( 0.08 * mSpecular ), uBaseColor, mMetallic );\n\n\tfloat colorOffset = smoothstep(12.0, 0.0, vWsPosition.y);\n\n\tfloat lambertDiffuseValue = min(lambertTerm + uLightIntensity, 1.0);//1.0;//lambertDiffuse(V, N);\n\n\tvec3 color;\n\n\t// sample the pre-filtered cubemap at the corresponding mipmap level\n\t// float numMips\t\t= 6.0;\n\t// float mip\t\t\t= numMips - 1.0 + log2(mRoughness);\n\t// vec3 lookup\t\t\t= -reflect( V, N );\n\t// lookup\t\t\t\t= fix_cube_lookup( lookup, 512.0, mip );\n\t// vec3 radiance\t\t= pow( textureCubeLodEXT( uRadianceMap, lookup, mip ).rgb, vec3( 2.2 ) );\n\t// vec3 irradiance\t\t= pow( textureCube( uIrradianceMap, N ).rgb, vec3( 1 ) );\n\n\t// get the approximate reflectance\n\tfloat NoV\t\t\t= saturate( dot( N, V ) );\n\tvec3 reflectance\t= EnvBRDFApprox( specularColor, uRoughness4, NoV );\n\n\t// combine the specular IBL and the BRDF\n\t// vec3 diffTexture \t= texture2D(uDiffuse, vTextureCoord).rgb;\n //    vec3 diffuse  \t\t= irradiance * diffuseColor + (irradiance * diffTexture + diffTexture);\n //    vec3 specular \t\t= radiance * reflectance;\n\t// color\t\t\t\t= diffuse + specular;\n\n\tvec3 diffTexture \t= texture2D(uDiffuse, vTextureCoord).rgb;\n\n\tdiffTexture += diffTexture * skyHue * 0.1;\n\t//vec3 ao \t\t\t= texture2D(uAoMap, vTextureCoord).rgb;\n\t//float ssao \t\t\t= smoothstep(uAoStrength, 1.0, ao.r);\n\t// ao  \t\t\t\t= smoothstep(vec3(.5), vec3(1.0), ap);\n\t//color \t\t\t\t*= ssao;\n\n\t// apply the tone-mapping\n\t//color\t\t\t\t= Uncharted2Tonemap( color * uExposure );\n\t// white balance\n\t//color\t\t\t\t= color * ( 1.0 / Uncharted2Tonemap( vec3( 40.0 ) ) );\n\n\t// gamma correction\n\t//color\t\t\t\t= pow( color, vec3( 1.0 / uGamma ) );\n\n\t// float opacity \t\t= smoothstep(0.0, 0.25, 1.0-uGreenOffset);\n\t// output the fragment color\n\n\tfloat ss = 0.;\n\tvec4 shdowPos = depthScaleMatrix * vec4(vWsPosition, 1.0);\n\tif(useDepth != 0){\n\t\tss = min(computeShadow(shdowPos), 1.);\n\t}\n\n    gl_FragColor\t\t= vec4( diffTexture, 1.0 );\n    //gl_FragColor\t\t= vec4( vec3(ss), 1.0 );\n\n}\n\n");t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="\n\n#define SHADER_NAME REFLECTION_VERTEX\n\nprecision highp float;\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec3 aNormal;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uNormalMatrix;\nuniform mat3 uModelViewMatrixInverse;\n\nuniform vec3 uLightPosition;\nuniform vec4 uLightAmbient;\nuniform vec4 uLightDiffuse;\n\nuniform vec3 position;\nuniform vec3 scale;\nuniform float rotation;\nuniform float heightMap;\n\nvarying vec2 vTextureCoord;\n\nvarying vec3 vLightRay;\nvarying vec3 vEyeVec;\n\nvarying vec3 vNormal;\nvarying vec3 vPosition;\nvarying vec3 vWsPosition;\nvarying vec3 vEyePosition;\nvarying vec3 vWsNormal;\n\n\nvec2 rotate(vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, -s, s, c);\n\treturn m * v;\n}\n\nvoid main(void) {\n\tvec3 pos \t\t\t\t= aVertexPosition;\n\t// pos.yz \t\t\t\t\t= rotate(pos.yz, 0.05);\n\tpos.xz \t\t\t\t\t= rotate(pos.xz, rotation);\n\tpos \t\t\t\t\t=  pos * scale + position;\n\tpos.y \t\t\t\t\t+= heightMap;\n\tvec4 worldSpacePosition\t= uModelMatrix * vec4(pos, 1.0);\n    vec4 viewSpacePosition\t= uViewMatrix * worldSpacePosition;\n\n    vec4 vertex = viewSpacePosition * vec4(pos, 1.0);\n \tvec4 light = vec4(uLightPosition,1.0);\n \tvNormal = vec3(viewSpacePosition * vec4(aNormal, 1.0));\n \tvLightRay = vertex.xyz-light.xyz;\n \tvEyeVec = -vec3(vertex.xyz);\n\n\t\n    vNormal\t\t\t\t\t= uNormalMatrix * aNormal;\n    vPosition\t\t\t\t= viewSpacePosition.xyz;\n\tvWsPosition\t\t\t\t= worldSpacePosition.xyz;\n\t\n\tvec4 eyeDirViewSpace\t= viewSpacePosition - vec4( 0, 0, 0, 1 );\n\tvEyePosition\t\t\t= -vec3( uModelViewMatrixInverse * eyeDirViewSpace.xyz );\n\tvWsNormal\t\t\t\t= normalize( uModelViewMatrixInverse * vNormal );\n\t\n    gl_Position\t\t\t\t= uProjectionMatrix * viewSpacePosition;\n\n\tvTextureCoord\t\t\t= aTextureCoord;\n}\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.COLOR1=t.COLOR0=t.correctGamma=t.FixCubeLookup=t.EnvBRDFApprox=t.Uncharted2Tonemap=void 0;t.EnvBRDFApprox="\n\n// https://www.unrealengine.com/blog/physically-based-shading-on-mobile\nvec3 EnvBRDFApprox( vec3 SpecularColor, float Roughness, float NoV )\n{\n\tconst vec4 c0 = vec4( -1, -0.0275, -0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, -0.04 );\n\tvec4 r = Roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( -9.28 * NoV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn SpecularColor * AB.x + AB.y;\n}\n\n";t.FixCubeLookup="\n\n// http://the-witness.net/news/2012/02/seamless-cube-map-filtering/\nvec3 fix_cube_lookup( vec3 v, float cube_size, float lod ) {\n\tfloat M = max(max(abs(v.x), abs(v.y)), abs(v.z));\n\tfloat scale = 1.0 - exp2(lod) / cube_size;\n\tif (abs(v.x) != M) v.x *= scale;\n\tif (abs(v.y) != M) v.y *= scale;\n\tif (abs(v.z) != M) v.z *= scale;\n\treturn v;\n}\n\n";t.Uncharted2Tonemap="\nvec3 Uncharted2Tonemap( vec3 x )\n{\n\treturn ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;\n}\n\n";t.correctGamma="\nvec3 correctGamma(vec3 color, float g) {\n\treturn pow(color, vec3(1.0/g));\n}\n\n";t.COLOR0="const vec3 COLOR0 = 1.0 - vec3(198.0, 151.0, 75.0)/255.0;";t.COLOR1="const vec3 COLOR1 = vec3(1.0);"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="\n vec3 changeSaturation(vec3 color, float saturation) {\n \tfloat luma = dot(vec3(0.2125, 0.7154, 0.0721) * color, vec3(1.));\n \treturn mix(vec3(luma), color, saturation);\n }\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(230))&&o.__esModule?o:{default:o},i=n(229);var a="\n\n#extension GL_EXT_shader_texture_lod : enable\n\nprecision highp float;\n\nuniform sampler2D \tuDiffuse;\nuniform sampler2D textureHeight;\nuniform sampler2D \tuAoMap;\nuniform sampler2D \tuAlbedo;\nuniform samplerCube uIrradianceMap;\n\nuniform vec3\t\tuBaseColor;\nuniform float\t\tuRoughness;\nuniform float\t\tuRoughness4;\nuniform float\t\tuMetallic;\nuniform float\t\tuSpecular;\nuniform float \t\tuAoStrength;\nuniform float\t\tuExposure;\nuniform float\t\tuGamma;\nuniform float\t\tuGreenOffset;\n\nuniform float baseColorAmount;\nuniform float diffuseColorAmount;\n//uniform float uLightIntensity;\n\nvarying vec3        vNormal;\nvarying vec3        vPosition;\nvarying vec3\t\tvEyePosition;\nvarying vec3\t\tvWsNormal;\nvarying vec3\t\tvWsPosition;\nvarying vec2 \t\tvTextureCoord;\n\nvarying vec3 vLightRay;\nvarying vec3 vEyeVec;\n\n#define saturate(x) clamp(x, 0.0, 1.0)\n#define PI 3.1415926535897932384626433832795\n\n".concat(r.default,"\n\n// Filmic tonemapping from\n// http://filmicgames.com/archives/75\n\nconst float A = 0.15;\nconst float B = 0.50;\nconst float C = 0.10;\nconst float D = 0.20;\nconst float E = 0.02;\nconst float F = 0.30;\n\n\n").concat(i.Uncharted2Tonemap,"\n").concat(i.EnvBRDFApprox,"\n").concat(i.FixCubeLookup,"\n\n\nvec3 correctGamma(vec3 color, float g) {\n\treturn pow(color, vec3(1.0/g));\n}\n\nconst vec3 COLOR0 = 1.0 - vec3(198.0, 151.0, 75.0)/255.0;\nconst vec3 COLOR1 = vec3(1.0);\n\nvoid main() {\n\tfloat mRoughness    = uRoughness;\n\tfloat mMetallic     = uMetallic;\n\tfloat mSpecular     = uSpecular;\n\n\n\tvec3 N \t\t\t\t= normalize( vWsNormal );\n\tvec3 V \t\t\t\t= normalize( vEyePosition );\n\n\tvec3 L = normalize(vLightRay);\n\tfloat lambertTerm = max(dot(N,-L),0.33);\n\t\n\t// deduce the diffuse and specular color from the baseColor and how metallic the material is\n\tvec3 diffuseColor\t= uBaseColor - uBaseColor * mMetallic;\n\tdiffuseColor *= baseColorAmount;\n\tvec3 specularColor\t= mix( vec3( 0.08 * mSpecular ), uBaseColor, mMetallic );\n\n\tfloat colorOffset = smoothstep(12.0, 0.0, vWsPosition.y);\n\t\n\tfloat lambertDiffuseValue = min(lambertTerm , 1.0);\n\n\tvec3 color;\n\n\t// sample the pre-filtered cubemap at the corresponding mipmap level\n\tfloat numMips\t\t= 6.0;\n\tfloat mip\t\t\t= numMips - 1.0 + log2(mRoughness);\n\tvec3 lookup\t\t\t= -reflect( V, N );\n\tlookup\t\t\t\t= fix_cube_lookup( lookup, 512.0, mip );\n\tvec3 radiance\t\t= pow( textureCubeLodEXT( uIrradianceMap, lookup, mip ).rgb, vec3( 2.2 ) );\n\tvec3 irradiance\t\t= pow( textureCube( uIrradianceMap, N ).rgb, vec3( 1 ) );\n\t\n\t// get the approximate reflectance\n\tfloat NoV\t\t\t= saturate( dot( N, V ) );\n\tvec3 reflectance\t= EnvBRDFApprox( specularColor, uRoughness4, NoV );\n\t\n\t// combine the specular IBL and the BRDF\n\tvec3 diffTexture \t= texture2D(uDiffuse, vTextureCoord).rgb ;\n    vec3 diffuse  \t\t= irradiance * diffuseColor + (irradiance * diffTexture + diffTexture);\n    vec3 specular \t\t= radiance * reflectance;\n\tcolor\t\t\t\t= diffuse + specular;\n\t\n\tvec3 ao \t\t\t= texture2D(uAoMap, vTextureCoord).rgb;\n\tfloat ssao \t\t\t= smoothstep(uAoStrength, 1.0, ao.r);\n\t// ao  \t\t\t\t= smoothstep(vec3(.5), vec3(1.0), ap);\n\tcolor \t\t\t\t*= ssao;\n\n\t// apply the tone-mapping\n\tcolor\t\t\t\t= Uncharted2Tonemap( color * uExposure );\n\t// white balance\n\tcolor\t\t\t\t= color * ( 1.0 / Uncharted2Tonemap( vec3( 40.0 ) ) );\n\t\n\t// gamma correction\n\tcolor\t\t\t\t= pow( color, vec3( 1.0 / uGamma ) );\n\n\t// float opacity \t\t= smoothstep(0.0, 0.25, 1.0-uGreenOffset);\n\t// output the fragment color\n    gl_FragColor\t\t= vec4( diffTexture, 1.0 );\n\n}\n\n");t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="\n\n#define SHADER_NAME REFLECTION_VERTEX\n\nprecision highp float;\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec3 aNormal;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uNormalMatrix;\nuniform mat3 uModelViewMatrixInverse;\n\nuniform vec3 uLightPosition;\nuniform vec4 uLightAmbient;\nuniform vec4 uLightDiffuse;\n\nuniform vec3 position;\nuniform vec3 scale;\nuniform float rotation;\nuniform float heightMap;\n\nvarying vec2 vTextureCoord;\n\nvarying vec3 vLightRay;\nvarying vec3 vEyeVec;\n\nvarying vec3 vNormal;\nvarying vec3 vPosition;\nvarying vec3 vWsPosition;\nvarying vec3 vEyePosition;\nvarying vec3 vWsNormal;\n\n\nvec2 rotate(vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, -s, s, c);\n\treturn m * v;\n}\n\n\nvoid main(void) {\n\tvec3 pos \t\t\t\t= aVertexPosition;\n\t// pos.yz \t\t\t\t\t= rotate(pos.yz, 0.05);\n\tpos.xz \t\t\t\t\t= rotate(pos.xz, rotation);\n\tpos.y \t\t\t\t\t+= heightMap;\n\tpos \t\t\t\t\t=  pos * scale + position;\n\tvec4 worldSpacePosition\t= uModelMatrix * vec4(pos, 1.0);\n    vec4 viewSpacePosition\t= uViewMatrix * worldSpacePosition;\n\n    vec4 vertex = viewSpacePosition * vec4(pos, 1.0);\n \tvec4 light = vec4(uLightPosition,1.0);\n \tvNormal = vec3(viewSpacePosition * vec4(aNormal, 1.0));\n \tvLightRay = vertex.xyz-light.xyz;\n \tvEyeVec = -vec3(vertex.xyz);\n\t\n    vNormal\t\t\t\t\t= uNormalMatrix * aNormal;\n    vPosition\t\t\t\t= viewSpacePosition.xyz;\n\tvWsPosition\t\t\t\t= worldSpacePosition.xyz;\n\t\n\tvec4 eyeDirViewSpace\t= viewSpacePosition - vec4( 0, 0, 0, 1 );\n\tvEyePosition\t\t\t= -vec3( uModelViewMatrixInverse * eyeDirViewSpace.xyz );\n\tvWsNormal\t\t\t\t= normalize( uModelViewMatrixInverse * vNormal );\n\t\n    gl_Position\t\t\t\t= uProjectionMatrix * viewSpacePosition;\n\n\tvTextureCoord\t\t\t= aTextureCoord;\n}\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=u(n(4)),r=(s(n(232)),s(n(231)),u(n(6))),i=s(n(12)),a=n(10);function s(e){return e&&e.__esModule?e:{default:e}}function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}o.default.GL;var h=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}var n,s,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.View),n=t,(s=[{key:"createTextures",value:function(e){var t=this;i.default.forIn(e,function(e){var n=e.id;t._texures.push(new o.default.GLTexture((0,a.getAsset)(n))),t._texuresLength++})}},{key:"_bindModelTextures",value:function(){for(var e=0;e<this._texuresLength;e++)this._texures[e].bind(e)}},{key:"destroy",value:function(){for(var e=0;e<this._texures.length;e++)this._texures[e].destroy();this._texures.length=0,this._texures=null}},{key:"position",get:function(){return r.vec3.add(this._worldPosition,this._position,this._positionOffset)}},{key:"animationPosition",get:function(){}},{key:"normalizedPosition",get:function(){return this._positionNormalized}}])&&c(n.prototype,s),u&&c(n,u),t}();t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=u(n(4)),r=s(n(233)),i=s(n(228)),a=s(n(227));u(n(6)),s(n(12)),n(10);function s(e){return e&&e.__esModule?e:{default:e}}function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var h=o.default.GL,d=1,v=2.8,p=[1,.765557,.336057],_=1,m=0,b=.2,y=0,g=1,x=0,w=0,E=function(e){function t(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i.default,a.default))).data=e,n.x=o,n.y=r,n.z=s,n.scale=u,n.rotation=l.rotation||0,n._heightValue=0,n._positionBase=[n.x,n.y,n.z],n._position=[n.x,n.y,n.z],n._positionOffset=[0,0,0],n._texures=[],n._texuresLength=0,n.isLow=!0,n.meshes={low:e.url,high:e.high},Object.keys(l,function(e){n[e]=l[e]}),n._hotspotIndex=0,n._loadMeshes(),n}var n,s,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),n=t,(s=[{key:"_loadMeshes",value:function(){var e=this;this.mesh,this.isReady=!1,this.isLow=!0;var t=this.meshes[this._getMode()];this._objLoader=new o.default.ObjLoader,this._objLoader.load("https://storage.googleapis.com/samrad-mars/www-assets/assets/"+t,function(t){return e._onObjLoaded(t)},!1)}},{key:"_getMode",value:function(){return this.isLow?"low":"high"}},{key:"_getPath",value:function(){return OBJS[this._getMode()]}},{key:"_onObjLoaded",value:function(e){this.mesh=e,this.isReady=!0;this.isLow?this.meshes.low=e:this.meshes.high=e}},{key:"toggleMesh",value:function(){var e=this;this.isLow=!this.isLow;var t=this._getPath();this.isLow?this.meshes.low?this.mesh=this.meshes.low:this._objLoader.load("".concat("https://storage.googleapis.com/samrad-mars/www-assets/assets/").concat(t),function(t){e.meshes.low=t,e.mesh=e.meshes.low},!1):this.meshes.high?this.mesh=this.meshes.high:this._objLoader.load("".concat("https://storage.googleapis.com/samrad-mars/www-assets/assets/").concat(t),function(t){e.meshes.high=t,e.mesh=e.meshes.high},!1)}},{key:"setHeightValue",value:function(e){this._heightValue=e}},{key:"useShadowMap",value:function(e){this._shadow=e}},{key:"_log",value:function(){console.log("Position:",this.x,this.y,this.z),console.log("Scale:",this.scale),console.log("Rotation:",this.rotation)}},{key:"render",value:function(e,t){if(this.isReady){this.shader.bind(),this.shader.uniform("uDiffuse","uniform1i",0),e&&this.shader.uniform("shadowMap","uniform1i",1),this._bindModelTextures(),e?(e.bind(1),this.shader.uniform("useDepth","int",1)):this.shader.uniform("useDepth","int",0);var n=.925*g,o=Math.pow(n,4),r=[p[0],p[1],p[2]];this.shader.uniform("uBaseColor","uniform3fv",r),this.shader.uniform("uRoughness","uniform1f",n),this.shader.uniform("uRoughness4","uniform1f",o),this.shader.uniform("uMetallic","uniform1f",y),this.shader.uniform("uSpecular","uniform1f",x);var i=1-w;this.shader.uniform("position","vec3",this._position),this.shader.uniform("scale","vec3",[this.scale,this.scale,this.scale]),this.shader.uniform("rotation","float",this.rotation),this.shader.uniform("heightMap","float",this._heightValue),this.shader.uniform("uAngle","float",this._sun.angle),this.shader.uniform("uLightIntensity","float",0),this.shader.uniform("baseColorAmount","float",_),this.shader.uniform("diffuseColorAmount","float",m),this.shader.uniform("uExposure","uniform1f",v),this.shader.uniform("uGamma","uniform1f",d),this.shader.uniform("uAoStrength","uniform1f",b),this.shader.uniform("uGreenOffset","float",i),h.draw(this.mesh)}}},{key:"sun",set:function(e){this._sun=e}},{key:"hotspotIndex",set:function(e){this._hotspotIndex=e},get:function(){return this._hotspotIndex}},{key:"position",get:function(){return this._position}},{key:"positionBase",get:function(){return this._positionBase}}])&&c(n.prototype,s),u&&c(n,u),t}();t.default=E},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(234)),r=a(n(42)),i=a(n(20));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var l=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._meshes=[],this._meshDict={},t.forEach(function(e){n._createMesh(e)}),this._active=0,this._navHistory=[this._active],i.default.on("nav:sculptures:next",function(){n.next()}),i.default.on("nav:sculptures:nexthotspot",function(){n.nextHotspot()})}var t,n,a;return t=e,(n=[{key:"_createMesh",value:function(e){var t=e.position||[100*Math.random()-50,0,0-(10*Math.random()+10)],n=new(Function.prototype.bind.apply(o.default,[null].concat([e],s(t),[e.scale,e])));n.createTextures(e.textures),this._meshDict[e.id]=n,this._meshes.push(n),this._numMeshes=this._meshes.length}},{key:"useShadowMap",value:function(e){this._meshes.forEach(function(t){t.useShadowMap(e)})}},{key:"setHeightData",value:function(e){this._meshes.forEach(function(t){var n=t.position;t.setHeightValue(e.pixelValueAt(n[0],n[2]))})}},{key:"nextHotspot",value:function(){var e=this.activeMesh,t=this.activeMesh.data.hotspots.length-1,n=e.hotspotIndex+1,o=n>t?0:n;e.hotspotIndex=o,i.default.emit("camera:hotspot",this.activeHotspot)}},{key:"next",value:function(){this._active++,this._active>=this.meshes.length&&(this._active=0),this._navHistory.push(this._active),i.default.emit("nav:mesh:next"),i.default.emit("set:meshdata",this.activeMesh.data),i.default.emit("camera:hotspot",this.activeHotspot)}},{key:"previous",value:function(){this._active--,this._active<0&&(this._active=this.meshes.length-1),this._navHistory.push(this._active),i.default.emit("nav:mesh:next"),i.default.emit("set:meshdata",this.activeMesh.data)}},{key:"meshBy",value:function(e){return this._meshDict[e]}},{key:"meshAt",value:function(e){return this._meshes[e]}},{key:"render",value:function(){for(var e=this.numMeshes,t=0,n=r.default.incre;t<e;t++){var o=this.meshAt(t),a=o.positionBase[2];r.default.incre>a-300&&r.default.incre<a+100?o.canInteract||(o.canInteract=!0,i.default.emit("sculpture:near",t)):o.canInteract&&(o.canInteract=!1,i.default.emit("sculpture:out",t)),a>n&&a<n+1400&&(o.position[2]=-o.positionBase[2]+n,o.render())}}},{key:"meshes",get:function(){return this._meshes}},{key:"numMeshes",get:function(){return this._numMeshes}},{key:"activeMesh",get:function(){return this._meshes[this._active]}},{key:"previousActiveMesh",get:function(){var e=this._navHistory[this._navHistory.length-2]||0;return this._meshes[e]}},{key:"sun",set:function(e){this._meshes.forEach(function(t){t.sun=e})}},{key:"activeHotspot",get:function(){var e=this.activeMesh;return this.activeMesh.data.hotspots[e.hotspotIndex]}}])&&u(t.prototype,n),a&&u(t,a),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=u(n(4)),r=(u(n(12)),n(10)),i=n(53),a=u(n(117)),s=u(n(116));function u(e){return e&&e.__esModule?e:{default:e}}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var h=o.default.GL,d=140,v=512,p=256,_=32,m=3,b=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,a.default,s.default)))._params=n,e._texures=[],e._texuresLength=0,e.baseColor=i.MARS_COLORS.baseColor,e.rotationX=Math.PI/2,e.rotationY=Math.PI/2,e.scale=n.scale||m,e._wsegments=n.widthSegments||_,e._hsegments=n.heightSegments||_,e._w=n.width||v,e._h=n.height||p,e._amp=n.amp||d,e.x=0,e.y=0,e.z=0,e._initMesh(),e._initPosition(n.position||[0,0,0]),e._pDark=[i.MARS_COLORS.darkColor[0]/255,i.MARS_COLORS.darkColor[1]/255,i.MARS_COLORS.darkColor[2]/255],e._pBase=[i.MARS_COLORS.baseColor[0]/255,i.MARS_COLORS.baseColor[1]/255,i.MARS_COLORS.baseColor[2]/255],e._pLight=[i.MARS_COLORS.lightColor[0]/255,i.MARS_COLORS.lightColor[1]/255,i.MARS_COLORS.lightColor[2]/255],e._pFog=[i.MARS_COLORS.fogColor[0]/255,i.MARS_COLORS.fogColor[1]/255,i.MARS_COLORS.fogColor[2]/255],e._c=0,e}var n,u,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.View),n=t,(u=[{key:"_initPosition",value:function(e){this.x=e[0],this.y=e[1],this.z=e[2]}},{key:"_init",value:function(){}},{key:"_initMesh",value:function(){this.mesh=o.default.Geom.plane(this._w,this._h,this._wsegments,this._hsegments),this._tW=new o.default.GLTexture((0,r.getAsset)(this._params.heightmaps[0])),this._tWao=new o.default.GLTexture((0,r.getAsset)(this._params.textures[0]))}},{key:"render",value:function(){this._c+=.001,this.shader.bind(),this.shader.uniform("uHeightMap","uniform1i",0),this.shader.uniform("uAoMap","uniform1i",1),this._tW.bind(0),this._tWao.bind(1),this.shader.uniform("heightMap","float",this._amp),this.shader.uniform("rotationY","float",this.rotationY),this.shader.uniform("rotationX","float",this.rotationX),this.shader.uniform("baseColor","vec3",this._pBase),this.shader.uniform("lightColor","vec3",this._pLight),this.shader.uniform("darkColor","vec3",this._pDark),this.shader.uniform("position","vec3",[this.x,this.y,this.z]),this.shader.uniform("scale","vec3",[this.scale,this.scale,this.scale]),this.shader.uniform("time","float",this._c),h.draw(this.mesh)}}])&&c(n.prototype,u),l&&c(n,l),t}();t.default=b},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(4)),r=a(n(115)),i=a(n(114));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var c=o.default.GL,f=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r.default,i.default)))._r=n.radius||500,e._seg=n.segments||24,e.x=0,e.y=-200,e.z=0,e._washOutFactor=0,e._wasOutTween={},e._sunPosition=[],e._initMesh(),e}var n,a,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.View),n=t,(a=[{key:"enterProductMode",value:function(e){var t=this;this._wasOutTween.val=this._washOutFactor,TweenLite.to(this._wasOutTween,e,{val:1,overwrite:1,onUpdate:function(){t._washOutFactor=t._wasOutTween.val}})}},{key:"exitProductMode",value:function(){}},{key:"_initMesh",value:function(){this.mesh=o.default.Geom.sphere(this._r,this._seg,!1,!1)}},{key:"render",value:function(e){this.shader.bind(),this.shader.uniform("uHorizon","uniform1i",0),this.shader.uniform("position","vec3",[this.x,this.y,this.z]),this.shader.uniform("uAngle","float",this._sun.angle),this.shader.uniform("washOutFactor","float",this._washOutFactor),e.bind(0),c.draw(this.mesh)}},{key:"sun",set:function(e){this._sun=e}}])&&u(n.prototype,a),s&&u(n,s),t}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="\n\n#define FBM_NOISE_RES 2\n\n//----------------------------------------------------------------------------------------\nfloat Hash(in vec2 p, in float scale)\n{\n\t// This is tiling part, adjusts with the scale...\n\tp = mod(p, scale);\n\treturn fract(sin(dot(p, vec2(27.16898, 38.90563))) * 5151.5473453);\n}\n\n//----------------------------------------------------------------------------------------\nfloat Noise(in vec2 p, in float scale )\n{\n\tvec2 f;\n\t\n\tp *= scale;\n\n\t\n\tf = fract(p);\t\t// Separate integer from fractional\n    p = floor(p);\n\t\n    f = f*f*(3.0-2.0*f);\t// Cosine interpolation approximation\n\t\n    float res = mix(mix(Hash(p, \t\t\t\t scale),\n\t\t\t\t\t\tHash(p + vec2(1.0, 0.0), scale), f.x),\n\t\t\t\t\tmix(Hash(p + vec2(0.0, 1.0), scale),\n\t\t\t\t\t\tHash(p + vec2(1.0, 1.0), scale), f.x), f.y);\n    return res;\n}\n\n//----------------------------------------------------------------------------------------\nfloat fBm(in vec2 p, in float time, in float amp)\n{\n\tfloat _s = sin(time * .7);\n\tfloat _c = cos(time * .45);\n    p += vec2(_s, _c)*(.01);\n    p += vec2(_s, _c)*(.01);\n    p += vec2(_s, _c)*(.01);\n\tfloat f = 0.0;\n\t// Change starting scale to any integer value...\n\tfloat scale = 7.;\n    p = mod(p, scale);\n\t\n\tfor (int i = 0; i < FBM_NOISE_RES; i++)\n\t{\n\t\tf += Noise(p, scale) * amp;\n\t\tamp *= .5;\n\t\t// Scale must be multiplied by an integer value...\n\t\tscale *= 2.;\n\t}\n\t// Clamp it just in case....\n\treturn min(f, 1.0);\n}"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.circle=void 0;t.circle="float circle(in vec2 _st, in float _radiusX, in float _radiusY, in float feather, in float amp){\n    vec2 dist = _st - vec2(0.5);\n\treturn 1.-smoothstep(_radiusX-(_radiusX*feather),\n                         _radiusY+(_radiusY*feather),\n                         dot(dist,dist)*amp);\n}"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(4)),r=a(n(115)),i=a(n(114));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var c=o.default.GL,f=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r.default,i.default)))._r=n.radius||500,e._seg=n.segments||24,e.x=0,e.y=-200,e.z=0,e._washOutFactor=1,e._wasOutTween={},e._sunPosition=[],e._initMesh(),e}var n,a,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.View),n=t,(a=[{key:"enterProductMode",value:function(e){var t=this;this._wasOutTween.val=this._washOutFactor,TweenLite.to(this._wasOutTween,e,{val:0,overwrite:1,onUpdate:function(){t._washOutFactor=t._wasOutTween.val}})}},{key:"exitProductMode",value:function(){}},{key:"_initMesh",value:function(){this.mesh=o.default.Geom.sphere(this._r,this._seg,!1,!1)}},{key:"render",value:function(e){this.shader.bind(),this.shader.uniform("uHorizon","uniform1i",0),this.shader.uniform("position","vec3",[this.x,this.y,this.z]),this.shader.uniform("uAngle","float",this._sun.angle),this.shader.uniform("washOutFactor","float",this._washOutFactor),e.bind(0),c.draw(this.mesh)}},{key:"sun",set:function(e){this._sun=e}}])&&u(n.prototype,a),s&&u(n,s),t}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="\n//\n// Description : Array and textureless GLSL 2D simplex noise function.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : stegu\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//               https://github.com/stegu/webgl-noise\n// \n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 mod289(vec2 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 permute(vec3 x) {\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat snoise(vec2 v)\n  {\n  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n                     -0.577350269189626,  // -1.0 + 2.0 * C.x\n                      0.024390243902439); // 1.0 / 41.0\n// First corner\n  vec2 i  = floor(v + dot(v, C.yy) );\n  vec2 x0 = v -   i + dot(i, C.xx);\n\n// Other corners\n  vec2 i1;\n  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n  //i1.y = 1.0 - i1.x;\n  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n  // x0 = x0 - 0.0 + 0.0 * C.xx ;\n  // x1 = x0 - i1 + 1.0 * C.xx ;\n  // x2 = x0 - 1.0 + 2.0 * C.xx ;\n  vec4 x12 = x0.xyxy + C.xxzz;\n  x12.xy -= i1;\n\n// Permutations\n  i = mod289(i); // Avoid truncation effects in permutation\n  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\n        + i.x + vec3(0.0, i1.x, 1.0 ));\n\n  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n  m = m*m ;\n  m = m*m ;\n\n// Gradients: 41 points uniformly over a line, mapped onto a diamond.\n// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\n\n  vec3 x = 2.0 * fract(p * C.www) - 1.0;\n  vec3 h = abs(x) - 0.5;\n  vec3 ox = floor(x + 0.5);\n  vec3 a0 = x - ox;\n\n// Normalise gradients implicitly by scaling m\n// Approximation of: m *= inversesqrt( a0*a0 + h*h );\n  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n// Compute final noise value at P\n  vec3 g;\n  g.x  = a0.x  * x0.x  + h.x  * x0.y;\n  g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n  return 130.0 * dot(m, g);\n}\n\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="#define M_PI 3.14159265358979323846\n\nfloat rand(vec2 co){return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);}\nfloat rand (vec2 co, float l) {return rand(vec2(rand(co), l));}\nfloat rand (vec2 co, float l, float t) {return rand(vec2(rand(co, l), t));}\n\nfloat perlin(vec2 p, float dim, in float _t) {\n    vec2 pos = floor(p * dim);\n    vec2 posx = pos + vec2(1.0, 0.0);\n    vec2 posy = pos + vec2(0.0, 1.0);\n    vec2 posxy = pos + vec2(1.0);\n\n    float c = rand(pos, dim, _t);\n    float cx = rand(posx, dim, _t);\n    float cy = rand(posy, dim, _t);\n    float cxy = rand(posxy, dim, _t);\n\n    vec2 d = fract(p * dim);\n    d = -0.5 * cos(d * M_PI) + 0.5;\n\n    float ccx = mix(c, cx, d.x);\n    float cycxy = mix(cy, cxy, d.x);\n    float center = mix(ccx, cycxy, d.y);\n\n    return center * 2.0 - 1.0;\n}\n\nfloat noise(vec2 p, float freq ){\n    float unit = freq;\n    vec2 ij = floor(p/unit);\n    vec2 xy = mod(p,unit)/unit;\n    //xy = 3.*xy*xy-2.*xy*xy*xy;\n    xy = .5*(1.-cos(M_PI*xy));\n    float a = rand((ij+vec2(0.,0.)));\n    float b = rand((ij+vec2(1.,0.)));\n    float c = rand((ij+vec2(0.,1.)));\n    float d = rand((ij+vec2(1.,1.)));\n    float x1 = mix(a, b, xy.x);\n    float x2 = mix(c, d, xy.x);\n    return mix(x1, x2, xy.y);\n}\n\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(n(4)),r=(l(n(12)),l(n(42))),i=l(n(126)),a=(n(10),l(n(20)),n(53)),s=l(n(117)),u=l(n(116));function l(e){return e&&e.__esModule?e:{default:e}}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function h(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var d=o.default.GL,v=30,p=256,_=256,m=128,b=5,y=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,s.default,u.default)))._params=n,e._texures=[],e._texuresLength=0,e.baseColor=a.MARS_COLORS.baseColor,e.rotationX=Math.PI/2,e.rotationY=Math.PI/2,e.scale=n.scale||b,e._wsegments=n.widthSegments||m,e._hsegments=n.heightSegments||m,e._w=n.width||p,e._h=n.height||_,e._amp=n.amp||v,e.x=0,e.y=0,e.z=0,e._washOutFactor=0,e._wasOutTween={},e._initMesh(),e._initPosition(n.position||[0,0,0]),e._pDark=[a.MARS_COLORS.darkColor[0]/255,a.MARS_COLORS.darkColor[1]/255,a.MARS_COLORS.darkColor[2]/255],e._pBase=[a.MARS_COLORS.baseColor[0]/255,a.MARS_COLORS.baseColor[1]/255,a.MARS_COLORS.baseColor[2]/255],e._pLight=[a.MARS_COLORS.lightColor[0]/255,a.MARS_COLORS.lightColor[1]/255,a.MARS_COLORS.lightColor[2]/255],e._pFog=[a.MARS_COLORS.fogColor[0]/255,a.MARS_COLORS.fogColor[1]/255,a.MARS_COLORS.fogColor[2]/255],e._c=0,e._scales=[e.scale,e.scale,e.scale],e._position=[e.x,e.y,e.z],console.log(e._position),e._terrainHeight=new i.default(Object.assign({},n.movement,{verbose:n.movement.verboseHeight})),e._terrainAo=new i.default(Object.assign({},n.movement,{verbose:n.movement.verboseAo})),e._terrainHeight.setTerrains(n.heightmaps),e._terrainAo.setTerrains(n.textures),e._heightTexture=new o.default.GLTexture(e._terrainHeight.canvas),e._aoTexture=new o.default.GLTexture(e._terrainAo.canvas),e}var n,l,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.View),n=t,(l=[{key:"_initPosition",value:function(e){this.x=e[0],this.y=e[1],this.z=e[2]}},{key:"enterProductMode",value:function(e){var t=this;this._wasOutTween.val=this._washOutFactor,TweenLite.to(this._wasOutTween,e,{val:1,overwrite:1,onUpdate:function(){t._washOutFactor=t._wasOutTween.val}})}},{key:"exitProductMode",value:function(){}},{key:"_init",value:function(){}},{key:"_initMesh",value:function(){this.mesh=o.default.Geom.plane(this._w,this._h,this._wsegments,this._hsegments)}},{key:"getSides",value:function(e){return[this._terrainHeight.getSide(e),this._terrainAo.getSide(e)]}},{key:"next",value:function(){this._terrainHeight.next(),this._terrainAo.next(),this._heightTexture.updateTexture(this._terrainHeight.canvas),this._aoTexture.updateTexture(this._terrainAo.canvas)}},{key:"render",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._c+=.001,this._position[2]=r.default.z,this.shader.bind(),this.shader.uniform("uHeightMap","uniform1i",0),this.shader.uniform("uAoMap","uniform1i",1),this._heightTexture.bind(0),this._aoTexture.bind(1),this.shader.uniform("position","vec3",this._position),this.shader.uniform("scale","vec3",this._scales),this.shader.uniform("baseColor","vec3",this._pBase),this.shader.uniform("lightColor","vec3",this._pLight),this.shader.uniform("darkColor","vec3",this._pDark),this.shader.uniform("fogColor","vec3",this._pFog),this.shader.uniform("washOutFactor","float",this._washOutFactor),this.shader.uniform("rotationX","float",this.rotationX),this.shader.uniform("heightMap","float",this._amp),this.shader.uniform("uAngle","float",this._sun.angle),d.draw(this.mesh)}},{key:"sun",set:function(e){this._sun=e}}])&&f(n.prototype,l),c&&f(n,c),t}();t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(124),r=n(52),i=n(123),a=c(n(122)),s=c(n(121)),u=(c(n(120)),c(n(119)),n(118)),l=n(41);function c(e){return e&&e.__esModule?e:{default:e}}var f="\n\n#extension GL_EXT_shader_texture_lod : enable\n#define EXPOSURE 4.6\n#define GAMMA 1.\n#define FOG 0.8\n//*** USED FOR THE HORIZON\n#define NEAR -1024.\n#define FAR 1024.\n#define SHADOW_INTENSITY .7\n\n\nprecision highp float;\n\nuniform float rotation;\nuniform sampler2D \tuHeightMap;\nuniform sampler2D \tuAoMap;\n\nuniform mat4 uViewMatrix;\n\nuniform vec3 uLightPosition;\nuniform vec4 uLightAmbient;\nuniform vec4 uLightDiffuse;\n\nuniform vec3 baseColor;\nuniform vec3 uLightColor;\nuniform vec3 darkColor;\nuniform vec3 fogColor;\n\nuniform vec3 sunPosition;\nuniform vec3 position;\n\nuniform int sceneDepth;\nuniform float heightMap;\nuniform float washOutFactor;\nuniform float uAngle;\n\nvarying vec3        vNormal;\nvarying vec3        vPosition;\nvarying vec3\t\tvEyePosition;\nvarying vec3\t\tvWsNormal;\nvarying vec3\t\tvWsPosition;\nvarying vec3\t\tvVertexPosition;\n\nvarying vec2 \t\tvTextureCoord;\n\nvarying vec3 vLightRay;\nvarying vec3 vEyeVec;\n\n\n// Filmic tonemapping from\n// http://filmicgames.com/archives/75\n\nconst float A = 0.15;\nconst float B = 0.50;\nconst float C = 0.10;\nconst float D = 0.20;\nconst float E = 0.02;\nconst float F = 0.30;\n\n\n\n".concat(o.Uncharted2Tonemap,"\n").concat(o.EnvBRDFApprox,"\n").concat(o.FixCubeLookup,"\n").concat(o.correctGamma,"\n").concat(o.COLOR0,"\n").concat(o.COLOR1,"\n\n").concat(i.changeContrast,"\n\n").concat(a.default,"\n\n//").concat(l.spotFrag,"\n\n").concat(r.SUN_MORNING,"\n").concat(r.SUN_EVENING,"\n").concat(r.sunSkyPosition,"\n").concat(r.mixMorningEvening,"\n\n//").concat(u.applyFog,"\n\n").concat(s.default,"\n\n\nvoid main() {\n\tvec2 st = vTextureCoord;\n\n\t//vec4 dv = texture2D( uHeightMap, vTextureCoord );\n\tvec3 L = normalize(sunPosition);\n\tvec3 N = normalize(vNormal * 2.0 - 1.0);\n\n\tL.y *= -1.;\n\tL.x *= -1.;\n\tL.x *= 4.;\n\tfloat _lDot = dot(N, -L);\n\tfloat lambertTerm = max(_lDot,.1);\n\n\n\tfloat shadowValue = min(computeShadow(), 1.);\n\n\t// vec3 E = normalize(vEyePosition);\n\t// vec3 P = normalize(vPosition);\n\t// vec3 _pp = P - E;\n\n\n\t//****** THIS IS THE HORIZON linearDepth\n\tfloat _sinSun = sin(-uAngle);\n\tfloat _sunSkyPosition = sunSkyPosition(_sinSun);\n\tvec3 skyHue = mixMorningEvening(_sunSkyPosition);\n\n\t//****** THIS IS FOCAL LENGTH\n\tfloat _near = NEAR + position.z;\n\tfloat _far = FAR + position.z;\n\tfloat linearDepth = clamp(length(vPosition) / (_far - _near), 0., .9);\n\n\t//vec3 mixFogColor = mix(mix(fogColor, baseColor, clamp(_sunSkyPosition, 0., 1.)), skyHue, 0.2);\n\n\t//vec3 color = mix(skyHue, vec3(1.), 0.2);\n\n\tfloat heightMod  = texture2D( uHeightMap, st ).x;\n\t//****reduce the height 0.5-1.0\n\tfloat heightMapReduced = heightMod * .5 + 0.5;\n\n\t//**** color contrast from the textures\n\tvec3 color \t\t = texture2D(uAoMap, vTextureCoord).rgb;\n\tvec3 colorLambert = color * (lambertTerm * 0.2);\n\tcolor +=  colorLambert;\n\tcolor = clamp(color, 0., 1.);\n\n\tcolor *= changeContrast(color, heightMod * 2.5);\n\tfloat ssao \t\t\t= smoothstep(0.02, 1.0, heightMapReduced);\n\tcolor \t\t\t\t*= ssao;\n\n\tcolor += 0.2;\n\n\tvec3 gradientMap = mix(darkColor, lightColor, 1.-heightMod);\n\tgradientMap *= max((lambertTerm - 0.3),.4);\n\n\tvec3 gradientWithSky = mix(skyHue, gradientMap, 0.9);\n\n\tvec3 nColor = color * gradientWithSky;\n\tnColor = changeContrast(nColor, 0.1);\n\t//gradientMap = mix(skyHue, gr)\n\t//gradientMap + mix(skyHue, baseColor, clamp(_sunSkyPosition * 0.8, 0., 0.8 ));\n\n\t//color *= gradientMap;\n\n\t//color += color * lambertTerm;\n\t//color *= lambertTerm;\n\t//color *= clamp((1. - heightMod),0.1, 1.0);\n\n\t//vec3 nColor = blendScreen_20_19(color, gradientMap);\n\n\t//nColor = mix(nColor, baseColor, clamp(_sunSkyPosition * 0.8, 0., 0.8 ));\n\n\tnColor *= min(shadowValue + step(sunPosition.y, heightMod * heightMap) + SHADOW_INTENSITY, 1.0);\n\t//********* NO GAMMA\n\t// nColor\t\t\t\t= Uncharted2Tonemap( nColor * EXPOSURE );\n\t// nColor\t\t\t\t= nColor * ( 1.0 / Uncharted2Tonemap( vec3( 40.0 ) ) );\n\t// nColor\t\t\t\t= pow( nColor, vec3( 1.0 / GAMMA ) );\n\n\t//vec3 finalColor =  applyFog(nColor, mixFogColor, linearDepth * 0.5, FOG);\n\tvec3 horizonColor = skyHue * linearDepth;\n\tnColor += horizonColor;\n\t//nColor *= (1. - linearDepth);\n\n\tnColor += (skyHue * (1. - horizonBlend(vTextureCoord)) * .2);\n\t//finalColor += (skyHue *= (linearDepth));\n\n\tvec3 washOut = vec3(skyHue) * washOutFactor;\n\n\tgl_FragColor = vec4((nColor *(1. - washOutFactor)) + washOut, 1.0);//vec4(1.0, 0.0, 0.0, 1.0);\n\t//gl_FragColor = vec4(vec3(heightMod), 1.0);//vec4(1.0, 0.0, 0.0, 1.0);\n\t//gl_FragColor = vec4(vec3(horizonColor), 1.0);//vec4(1.0, 0.0, 0.0, 1.0);\n\t//gl_FragColor = vec4(vec3((1. - linearDepth)),1.0);\n}\n\n");t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="float map(float value, float sx, float sy, float tx, float ty) {\n\t\tfloat p = (value - sx) / ( sy - sx);\n\t\treturn tx + p * ( ty - tx);\n\t}"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(125))&&o.__esModule?o:{default:o},i=n(41);var a="\n\n#define SHADER_NAME REFLECTION_VERTEX\n#define BELL  20.\n\nprecision highp float;\n\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec3 aNormal;\n\nuniform sampler2D \tuHeightMap;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uNormalMatrix;\nuniform mat3 uModelViewMatrixInverse;\n\nuniform vec3 position;\nuniform vec3 scale;\nuniform float rotation;\nuniform float heightMap;\n\nuniform vec3 uLightPosition;\nuniform vec4 uLightAmbient;\nuniform vec4 uLightDiffuse;\n\nvarying vec2 vTextureCoord;\n\nvarying vec3 vLightRay;\nvarying vec3 vEyeVec;\nvarying vec3 vVertexPosition;\n\nvarying vec3 vNormal;\nvarying vec3 vPosition;\nvarying vec3 vWsPosition;\nvarying vec3 vEyePosition;\nvarying vec3 vWsNormal;\n\nfloat rand(float n){return fract(sin(n) * 43758.5453123);}\n\n".concat(i.spotVert,"\n\n").concat(r.default,"\n\nvec2 rotate(vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, -s, s, c);\n\treturn m * v;\n}\n\nvoid main(void) {\n\tvec3 pos \t\t\t\t= aVertexPosition;\n\tvec3 dv                 = texture2D( uHeightMap, aTextureCoord ).xyz;\n\n\t//********CAUSES BAD JUMP\n\t// float pct = 0.0;\n //    pct = 1.- distance(aTextureCoord,vec2(0.5, 0.));\n //    pct *= BELL;\n\n\t// pos.z = pct;\n\t// pos.z -= BELL;\n\n\tpos.z \t\t\t\t\t+= dv.x * heightMap;\n\tpos.yz \t\t\t\t\t= rotate(pos.yz, rotation);\n\t//pos.xz \t\t\t\t\t= rotate(pos.xz, rotation);\n\tpos \t\t\t\t\t=  pos * scale + position;\n\tvec4 worldSpacePosition\t= uModelMatrix * vec4(pos, 1.0);\n    vec4 viewSpacePosition\t= uViewMatrix * worldSpacePosition;\n\n    //vec4 vertex = viewSpacePosition * vec4(pos, 1.0);\n \t//vec4 light = vec4(uLightPosition,1.0);\n \t//vNormal = vec3(viewSpacePosition * vec4(aNormal, 1.0));\n \t//vLightRay = vertex.xyz-light.xyz;\n \t//vEyeVec = -vec3(vertex.xyz);\n\n \tsetupLight(worldSpacePosition.xyz);\n\tsetupShadow(worldSpacePosition);\n\n\tvVertexPosition = pos;\n\n    vNormal\t\t\t\t\t= uNormalMatrix * aNormal;\n    vPosition\t\t\t\t= viewSpacePosition.xyz;\n\tvWsPosition\t\t\t\t= worldSpacePosition.xyz;\n\n\tvec4 eyeDirViewSpace\t= viewSpacePosition - vec4( 0, 0, 0, 1 );\n\tvEyePosition\t\t\t= -vec3( uModelViewMatrixInverse * eyeDirViewSpace.xyz );\n\tvWsNormal\t\t\t\t= normalize( uModelViewMatrixInverse * vNormal );\n\n    gl_Position\t\t\t\t= uProjectionMatrix * viewSpacePosition;\n\n    vNormal = calculateNormals(uHeightMap, aTextureCoord);\n\n\tvTextureCoord\t\t\t= aTextureCoord;\n}\n");t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=f(n(4)),r=(f(n(12)),f(n(131))),i=f(n(42)),a=f(n(126)),s=(n(10),f(n(20))),u=n(53),l=f(n(246)),c=f(n(244));function f(e){return e&&e.__esModule?e:{default:e}}function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function v(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var p=o.default.GL,_=30,m=256,b=256,y=128,g=5,x=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=v(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,l.default,c.default)))._texures=[],e._texuresLength=0,e.baseColor=u.MARS_COLORS.baseColor,e.rotation=n.mesh.rotation||Math.PI/2,e.scale=n.mesh.scale||g,e._wsegments=n.mesh.widthSegments||y,e._hsegments=n.mesh.heightSegments||y,e._w=n.mesh.width||m,e._h=n.mesh.height||b,e._amp=n.mesh.amp||_,e.x=0,e.y=0,e.z=0,e._washOutFactor=0,e._wasOutTween={},e._initMesh(),e._initPosition(n.mesh.position||[0,-4,0]),e._pDark=[u.MARS_COLORS.darkColor[0]/255,u.MARS_COLORS.darkColor[1]/255,u.MARS_COLORS.darkColor[2]/255],e._pBase=[u.MARS_COLORS.baseColor[0]/255,u.MARS_COLORS.baseColor[1]/255,u.MARS_COLORS.baseColor[2]/255],e._pLight=[u.MARS_COLORS.lightColor[0]/255,u.MARS_COLORS.lightColor[1]/255,u.MARS_COLORS.lightColor[2]/255],e._pFog=[u.MARS_COLORS.fogColor[0]/255,u.MARS_COLORS.fogColor[1]/255,u.MARS_COLORS.fogColor[2]/255],e._scales=[e.scale,e.scale,e.scale],e._position=[e.x,e.y,e.z],e._terrainHeight=new a.default(Object.assign({},n.movement,{verbose:!1})),e._terrainHeight.setTerrains(n.mesh.heightmaps),e._terrainAo=new a.default(Object.assign({},n.movement,{verbose:!1})),e._terrainAo.setTerrains(n.mesh.textures),e._heightTexture=new o.default.GLTexture(e._terrainHeight.canvas),e._aoTexture=new o.default.GLTexture(e._terrainAo.canvas),s.default.on("movement:complete",function(){e._terrainHeight.next(),e._terrainAo.next(),e._sideViews[0].next(),e._sideViews[1].next(),e.blendSides(e._sideViews),e._heightTexture.updateTexture(e._terrainHeight.canvas),e._aoTexture.updateTexture(e._terrainAo.canvas)}),e}var n,f,h;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.View),n=t,(f=[{key:"_initPosition",value:function(e){this.x=e[0],this.y=e[1],this.z=e[2]}},{key:"enterProductMode",value:function(e){var t=this;this._wasOutTween.val=this._washOutFactor,r.default.to(this._wasOutTween,e,{val:1,overwrite:1,onUpdate:function(){t._washOutFactor=t._wasOutTween.val}})}},{key:"exitProductMode",value:function(){}},{key:"createFromAssetId",value:function(e){}},{key:"pixelValueAt",value:function(e,t){return this._terrainHeight.getPixelValueAt(e,t)*this._amp}},{key:"blendSides",value:function(e){var t=e[0].getSides(!0),n=e[1].getSides(!1);this._terrainHeight.blendSide(t[0],!0),this._terrainHeight.blendSide(n[0],!1),this._terrainAo.blendSide(t[1],!0),this._terrainAo.blendSide(n[1],!1),this._heightTexture.updateTexture(this._terrainHeight.canvas),this._aoTexture.updateTexture(this._terrainAo.canvas)}},{key:"_init",value:function(){}},{key:"_initMesh",value:function(){this.mesh=o.default.Geom.plane(this._w,this._h,this._wsegments,this._hsegments)}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._position[2]=i.default.z,this.shader.bind(),i.default.needsUpdate,this.shader.uniform("uAoMap","uniform1i",0),this.shader.uniform("uHeightMap","uniform1i",1),this._aoTexture.bind(0),this._heightTexture.bind(1),e&&(this._spotlight.bindUniforms(this.shader,2),this.shader.uniform("sunPosition","vec3",this._spotlight.position)),this.shader.uniform("baseColor","vec3",this._pBase),this.shader.uniform("lightColor","vec3",this._pLight),this.shader.uniform("darkColor","vec3",this._pDark),this.shader.uniform("fogColor","vec3",this._pFog),this.shader.uniform("position","vec3",this._position),this.shader.uniform("scale","vec3",this._scales),this.shader.uniform("rotation","float",this.rotation),this.shader.uniform("heightMap","float",this._amp),this.shader.uniform("washOutFactor","float",this._washOutFactor),this.shader.uniform("uAngle","float",this._sun.angle),p.draw(this.mesh)}},{key:"spotlight",set:function(e){this._spotlight=e}},{key:"sun",set:function(e){this._sun=e}},{key:"sideViews",set:function(e){this._sideViews=e,this.blendSides(this._sideViews)}}])&&d(n.prototype,f),h&&d(n,h),t}();t.default=x},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(n(4)),r=l(n(247)),i=l(n(243)),a=l(n(240)),s=l(n(237)),u=(l(n(236)),n(10));function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var f=o.default.GL,h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.param=t,this._initTextures(),this._initMesh()}var t,n,l;return t=e,(n=[{key:"_initTextures",value:function(){this._tHorizon=new o.default.GLTexture((0,u.getAsset)("horizon"))}},{key:"_initMesh",value:function(){this._alysEnv=new a.default(this.param.sky),this._sky=new s.default(this.param.sky),this._terrain=new r.default(this.param.ground),this._sideLeft=new i.default(this.param.ground.mesh.sides.left),this._sideRight=new i.default(this.param.ground.mesh.sides.right),this._terrain.sideViews=[this._sideLeft,this._sideRight]}},{key:"enterProductMode",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.7;this._sideLeft.enterProductMode(t),this._sideRight.enterProductMode(t),this._terrain.enterProductMode(t),this._sky.enterProductMode(t),this._isProductMode=!0,setTimeout(function(){e._pauseMars=!0},1e3*t)}},{key:"exitProductMode",value:function(){}},{key:"render",value:function(e){f.disable(f.CULL_FACE),this._isProductMode&&this._alysEnv.render(this._tHorizon),this._pauseMars||(this._sky.render(this._tHorizon),f.enable(f.CULL_FACE),this._sideLeft.render(),this._sideRight.render(),this._terrain.render(e))}},{key:"sun",set:function(e){this._sideRight.sun=e,this._sideLeft.sun=e,this._terrain.sun=e,this._sky.sun=e,this._alysEnv.sun=e}},{key:"terrain",get:function(){return this._terrain}}])&&c(t.prototype,n),l&&c(t,l),e}();t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(10);var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}(n(4)),r=v(n(134)),i=v(n(132)),a=v(n(42)),s=v(n(248)),u=v(n(235)),l=(v(n(225)),v(n(133)),v(n(41))),c=v(n(20)),f=(v(n(224)),v(n(223))),h=(v(n(222)),v(n(221))),d=v(n(218));function v(e){return e&&e.__esModule?e:{default:e}}function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function m(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var b=o.default.GL,y=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{sceneData:e})),b.enableAlphaBlending(),n._sceneData=e,n.params={},n.params.sceneData=n._sceneData,n._initViewss(),n.orbitalControl=new r.default(n.camera,window,15),n.offset=new o.default.EaseNumber(0,.03),n.anim=new i.default(n.orbitalControl,{radius:100}),n.anim.init(n._sculptures,e.camera),n._initLights(),c.default.on("nav:mesh:next",function(){n.anim.moveToActive()}),c.default.on("sculpture:near",function(e){n._allowProductMode=!0}),c.default.on("sculpture:out",function(e){n._allowProductMode=!1}),c.default.on("gui:toggleRender",function(e){n._stopRender=!n._stopRender}),c.default.on("keyboard:sculpture:view",function(e){n._allowProductMode&&(a.default.pause=!0,n.anim.enterProductMode(),n._env.enterProductMode(),c.default.emit("nav:sculptures:nexthotspot"))}),n._elapsed=0,n}var n,v,p;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.Scene),n=t,(v=[{key:"_initViewss",value:function(){var e=this.params.sceneData.views,t=e.terrain,n=e.sky;a.default.setParams(t.movement),this._env=new s.default({sky:n,ground:t});var o=e.sculptures;this._sculptures=new u.default(o),this._sculptures.setHeightData(this._env.terrain),this._fbo=new f.default(this.camera,512),this._depth=new h.default}},{key:"_initTextures",value:function(){}},{key:"_initLights",value:function(){this._spotLight=new l.default(512,512),this._spotLight.camera=this.camera,this._spotLight.target=[0,0,0],this._env._terrain.spotlight=this._spotLight,this._sun=new d.default(this.orbitalControl),this._env.sun=this._sun,this._sculptures.sun=this._sun}},{key:"_drawShadowMap",value:function(){this._elapsed;this._spotLight.bind(),this._spotLight.position=this._sun.position,this._drawScultpures(),this._spotLight.unbind(),b.clear(0,0,0,0)}},{key:"_drawEnv",value:function(e,t){this._env.render(e,t)}},{key:"_drawScultpures",value:function(e){this._sculptures.render()}},{key:"_drawScene",value:function(){this._drawEnv(),this._drawScultpures()}},{key:"_drawToFbo",value:function(){this._fbo.clear(),this._fbo.bind(this._sculptures.activeMesh.position),this._drawEnv(null,!1),this._fbo.unbind()}},{key:"render",value:function(){this._stopRender||(b.clear(0,0,0,0),b.setMatrices(this.camera),a.default.update(),this._elapsed++,this._drawScultpures(),this._drawEnv(!0),this._sun.updateAngle())}},{key:"resize",value:function(){b.setSize(window.innerWidth,window.innerHeight),this.camera.setAspectRatio(b.aspectRatio)}},{key:"pause",set:function(e){this._stopRender=e}}])&&_(n.prototype,v),p&&_(n,p),t}();t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}(n(4));function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var s=o.default.GL,u=function(e){function t(e,n,o){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,o))}var n,r,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.FrameBuffer),n=t,(r=[{key:"destroy",value:function(){this.clear(),this.unbind(),s.gl.deleteTexture(this.texture),s.gl.deleteTexture(this.depthTexture),s.gl.deleteFramebuffer(this.frameBuffer)}}])&&i(n.prototype,r),u&&i(n,u),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="#define M_PI 3.14159265358979323846\n\nfloat rand(vec2 co){return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);}\nfloat rand (vec2 co, float l) {return rand(vec2(rand(co), l));}\nfloat rand (vec2 co, float l, float t) {return rand(vec2(rand(co, l), t));}\n\nfloat perlin(vec2 p, float dim, in float _t) {\n    vec2 pos = floor(p * dim);\n    vec2 posx = pos + vec2(1.0, 0.0);\n    vec2 posy = pos + vec2(0.0, 1.0);\n    vec2 posxy = pos + vec2(1.0);\n\n    float c = rand(pos, dim, _t);\n    float cx = rand(posx, dim, _t);\n    float cy = rand(posy, dim, _t);\n    float cxy = rand(posxy, dim, _t);\n\n    vec2 d = fract(p * dim);\n    d = -0.5 * cos(d * M_PI) + 0.5;\n\n    float ccx = mix(c, cx, d.x);\n    float cycxy = mix(cy, cxy, d.x);\n    float center = mix(ccx, cycxy, d.y);\n\n    return center * 2.0 - 1.0;\n}\n\nfloat noise(vec2 p, float freq ){\n    float unit = freq;\n    vec2 ij = floor(p/unit);\n    vec2 xy = mod(p,unit)/unit;\n    //xy = 3.*xy*xy-2.*xy*xy*xy;\n    xy = .5*(1.-cos(M_PI*xy));\n    float a = rand((ij+vec2(0.,0.)));\n    float b = rand((ij+vec2(1.,0.)));\n    float c = rand((ij+vec2(0.,1.)));\n    float d = rand((ij+vec2(1.,1.)));\n    float x1 = mix(a, b, xy.x);\n    float x2 = mix(c, d, xy.x);\n    return mix(x1, x2, xy.y);\n}\n\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(129)),r=a(n(130)),i=a(n(251));function a(e){return e&&e.__esModule?e:{default:e}}var s="\n\n// basic.frag\n\n#define SHADER_NAME SIMPLE_TEXTURE\nprecision highp float;\n\nprecision highp float;\nvarying vec2 vTextureCoord;\nuniform sampler2D texture;\nuniform sampler2D nextScene;\nuniform float time;\nuniform int noiseAtmosphere;\nuniform float fade;\n\nuniform float atmosphereIntensity;\n\n".concat(o.default,"\n\n").concat(r.default,"\n\n").concat(i.default,"\n\nvoid main(void) {\n    vec2 newUv = vTextureCoord;\n\n    vec3 color = texture2D(texture, vTextureCoord).rgb;\n    vec3 nColor = texture2D(nextScene, vTextureCoord).rgb;\n\tfloat _m = sin(time * 0.01)*.5 + 0.5;\n    vec3 _out = mix(color, nColor, fade);\n\n    vec3 atmosphere = mix(ATMOSPHERE_COLOR_RED, ATMOSPHERE_COLOR, newUv.x) * atmosphereIntensity;\n\t\n\tfloat _perlin = 1.;\n\n\tif(noiseAtmosphere > 0){\n\t \t_perlin = noise(newUv + time * 0.02, 1.) + .5;\n\t}\n\n\tatmosphere *= _perlin;\n\n    vec3 finalColor = blendScreen_20_19(_out, atmosphere, 1.);\n\n    gl_FragColor = vec4(_out,1.0);\n    gl_FragColor = vec4(finalColor,1.0);\n}\n\n");t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="\n\n// basic.vert\n\nprecision highp float;\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n    gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\n    vTextureCoord = aTextureCoord;\n}\n\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=u(n(4)),r=n(10),i=u(n(253)),a=u(n(252)),s=(function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}t.default=e}(n(6)),u(n(12)));function u(e){return e&&e.__esModule?e:{default:e}}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var h=o.default.GL,d=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i.default,a.default)))._time=0,e._transition=0,e._atmosphereIntensity=0,e._noiseAtmosphere=0,e}var n,u,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.View),n=t,(u=[{key:"_init",value:function(){this._textureAlbedo=new o.default.GLTexture((0,r.getAsset)("albedo")),this.mesh=o.default.Geom.plane(2,2,4,!1,!1)}},{key:"updateUniforms",value:function(e){var t=this;s.default.forIn(e,function(e,n){t[n]=e})}},{key:"render",value:function(e,t){this._time++,this.shader.bind(),this.shader.uniform("texture","uniform1i",0),this.shader.uniform("nextScene","uniform1i",1),this.shader.uniform("time","float",this._time),this.shader.uniform("atmosphereIntensity","float",this._atmosphereIntensity),this.shader.uniform("noiseAtmosphere","int",this._noiseAtmosphere),this.shader.uniform("fade","float",this._transition),e.bind(0),t.bind(1),h.draw(this.mesh)}},{key:"transition",set:function(e){this._transition=e}},{key:"atmosphereIntensity",set:function(e){this._atmosphereIntensity=e}},{key:"noiseAtmosphere",set:function(e){this._noiseAtmosphere=e}}])&&c(n.prototype,u),l&&c(n,l),t}();t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="\nfloat blendColorDodge_11_0(float base, float blend) {\n\treturn (blend==1.0)?blend:min(base/(1.0-blend),1.0);\n}\n\nvec3 blendColorDodge_11_0(vec3 base, vec3 blend) {\n\treturn vec3(blendColorDodge_11_0(base.r,blend.r),blendColorDodge_11_0(base.g,blend.g),blendColorDodge_11_0(base.b,blend.b));\n}\n\nvec3 blendColorDodge_11_0(vec3 base, vec3 blend, float opacity) {\n\treturn (blendColorDodge_11_0(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nfloat blendColorBurn_12_1(float base, float blend) {\n\treturn (blend==0.0)?blend:max((1.0-((1.0-base)/blend)),0.0);\n}\n\nvec3 blendColorBurn_12_1(vec3 base, vec3 blend) {\n\treturn vec3(blendColorBurn_12_1(base.r,blend.r),blendColorBurn_12_1(base.g,blend.g),blendColorBurn_12_1(base.b,blend.b));\n}\n\nvec3 blendColorBurn_12_1(vec3 base, vec3 blend, float opacity) {\n\treturn (blendColorBurn_12_1(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\n\nfloat blendVividLight_2_2(float base, float blend) {\n\treturn (blend<0.5)?blendColorBurn_12_1(base,(2.0*blend)):blendColorDodge_11_0(base,(2.0*(blend-0.5)));\n}\n\nvec3 blendVividLight_2_2(vec3 base, vec3 blend) {\n\treturn vec3(blendVividLight_2_2(base.r,blend.r),blendVividLight_2_2(base.g,blend.g),blendVividLight_2_2(base.b,blend.b));\n}\n\nvec3 blendVividLight_2_2(vec3 base, vec3 blend, float opacity) {\n\treturn (blendVividLight_2_2(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\n\nfloat blendHardMix_1_3(float base, float blend) {\n\treturn (blendVividLight_2_2(base,blend)<0.5)?0.0:1.0;\n}\n\nvec3 blendHardMix_1_3(vec3 base, vec3 blend) {\n\treturn vec3(blendHardMix_1_3(base.r,blend.r),blendHardMix_1_3(base.g,blend.g),blendHardMix_1_3(base.b,blend.b));\n}\n\nvec3 blendHardMix_1_3(vec3 base, vec3 blend, float opacity) {\n\treturn (blendHardMix_1_3(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\n\nfloat blendLinearDodge_13_4(float base, float blend) {\n\t// Note : Same implementation as BlendAddf\n\treturn min(base+blend,1.0);\n}\n\nvec3 blendLinearDodge_13_4(vec3 base, vec3 blend) {\n\t// Note : Same implementation as BlendAdd\n\treturn min(base+blend,vec3(1.0));\n}\n\nvec3 blendLinearDodge_13_4(vec3 base, vec3 blend, float opacity) {\n\treturn (blendLinearDodge_13_4(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nfloat blendLinearBurn_14_5(float base, float blend) {\n\t// Note : Same implementation as BlendSubstractf\n\treturn max(base+blend-1.0,0.0);\n}\n\nvec3 blendLinearBurn_14_5(vec3 base, vec3 blend) {\n\t// Note : Same implementation as BlendSubstract\n\treturn max(base+blend-vec3(1.0),vec3(0.0));\n}\n\nvec3 blendLinearBurn_14_5(vec3 base, vec3 blend, float opacity) {\n\treturn (blendLinearBurn_14_5(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\n\nfloat blendLinearLight_3_6(float base, float blend) {\n\treturn blend<0.5?blendLinearBurn_14_5(base,(2.0*blend)):blendLinearDodge_13_4(base,(2.0*(blend-0.5)));\n}\n\nvec3 blendLinearLight_3_6(vec3 base, vec3 blend) {\n\treturn vec3(blendLinearLight_3_6(base.r,blend.r),blendLinearLight_3_6(base.g,blend.g),blendLinearLight_3_6(base.b,blend.b));\n}\n\nvec3 blendLinearLight_3_6(vec3 base, vec3 blend, float opacity) {\n\treturn (blendLinearLight_3_6(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nfloat blendLighten_15_7(float base, float blend) {\n\treturn max(blend,base);\n}\n\nvec3 blendLighten_15_7(vec3 base, vec3 blend) {\n\treturn vec3(blendLighten_15_7(base.r,blend.r),blendLighten_15_7(base.g,blend.g),blendLighten_15_7(base.b,blend.b));\n}\n\nvec3 blendLighten_15_7(vec3 base, vec3 blend, float opacity) {\n\treturn (blendLighten_15_7(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nfloat blendDarken_16_8(float base, float blend) {\n\treturn min(blend,base);\n}\n\nvec3 blendDarken_16_8(vec3 base, vec3 blend) {\n\treturn vec3(blendDarken_16_8(base.r,blend.r),blendDarken_16_8(base.g,blend.g),blendDarken_16_8(base.b,blend.b));\n}\n\nvec3 blendDarken_16_8(vec3 base, vec3 blend, float opacity) {\n\treturn (blendDarken_16_8(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\n\nfloat blendPinLight_4_9(float base, float blend) {\n\treturn (blend<0.5)?blendDarken_16_8(base,(2.0*blend)):blendLighten_15_7(base,(2.0*(blend-0.5)));\n}\n\nvec3 blendPinLight_4_9(vec3 base, vec3 blend) {\n\treturn vec3(blendPinLight_4_9(base.r,blend.r),blendPinLight_4_9(base.g,blend.g),blendPinLight_4_9(base.b,blend.b));\n}\n\nvec3 blendPinLight_4_9(vec3 base, vec3 blend, float opacity) {\n\treturn (blendPinLight_4_9(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nfloat blendReflect_17_10(float base, float blend) {\n\treturn (blend==1.0)?blend:min(base*base/(1.0-blend),1.0);\n}\n\nvec3 blendReflect_17_10(vec3 base, vec3 blend) {\n\treturn vec3(blendReflect_17_10(base.r,blend.r),blendReflect_17_10(base.g,blend.g),blendReflect_17_10(base.b,blend.b));\n}\n\nvec3 blendReflect_17_10(vec3 base, vec3 blend, float opacity) {\n\treturn (blendReflect_17_10(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\n\nvec3 blendGlow_5_11(vec3 base, vec3 blend) {\n\treturn blendReflect_17_10(blend,base);\n}\n\nvec3 blendGlow_5_11(vec3 base, vec3 blend, float opacity) {\n\treturn (blendGlow_5_11(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nfloat blendOverlay_8_12(float base, float blend) {\n\treturn base<0.5?(2.0*base*blend):(1.0-2.0*(1.0-base)*(1.0-blend));\n}\n\nvec3 blendOverlay_8_12(vec3 base, vec3 blend) {\n\treturn vec3(blendOverlay_8_12(base.r,blend.r),blendOverlay_8_12(base.g,blend.g),blendOverlay_8_12(base.b,blend.b));\n}\n\nvec3 blendOverlay_8_12(vec3 base, vec3 blend, float opacity) {\n\treturn (blendOverlay_8_12(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\n\nvec3 blendHardLight_6_13(vec3 base, vec3 blend) {\n\treturn blendOverlay_8_12(blend,base);\n}\n\nvec3 blendHardLight_6_13(vec3 base, vec3 blend, float opacity) {\n\treturn (blendHardLight_6_13(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nvec3 blendPhoenix_7_14(vec3 base, vec3 blend) {\n\treturn min(base,blend)-max(base,blend)+vec3(1.0);\n}\n\nvec3 blendPhoenix_7_14(vec3 base, vec3 blend, float opacity) {\n\treturn (blendPhoenix_7_14(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\n\nvec3 blendNormal_9_15(vec3 base, vec3 blend) {\n\treturn blend;\n}\n\nvec3 blendNormal_9_15(vec3 base, vec3 blend, float opacity) {\n\treturn (blendNormal_9_15(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nvec3 blendNegation_10_16(vec3 base, vec3 blend) {\n\treturn vec3(1.0)-abs(vec3(1.0)-base-blend);\n}\n\nvec3 blendNegation_10_16(vec3 base, vec3 blend, float opacity) {\n\treturn (blendNegation_10_16(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nvec3 blendMultiply_18_17(vec3 base, vec3 blend) {\n\treturn base*blend;\n}\n\nvec3 blendMultiply_18_17(vec3 base, vec3 blend, float opacity) {\n\treturn (blendMultiply_18_17(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\n\nvec3 blendAverage_19_18(vec3 base, vec3 blend) {\n\treturn (base+blend)/2.0;\n}\n\nvec3 blendAverage_19_18(vec3 base, vec3 blend, float opacity) {\n\treturn (blendAverage_19_18(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\n\n\nfloat blendScreen_20_19(float base, float blend) {\n\treturn 1.0-((1.0-base)*(1.0-blend));\n}\n\nvec3 blendScreen_20_19(vec3 base, vec3 blend) {\n\treturn vec3(blendScreen_20_19(base.r,blend.r),blendScreen_20_19(base.g,blend.g),blendScreen_20_19(base.b,blend.b));\n}\n\nvec3 blendScreen_20_19(vec3 base, vec3 blend, float opacity) {\n\treturn (blendScreen_20_19(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nfloat blendSoftLight_21_20(float base, float blend) {\n\treturn (blend<0.5)?(2.0*base*blend+base*base*(1.0-2.0*blend)):(sqrt(base)*(2.0*blend-1.0)+2.0*base*(1.0-blend));\n}\n\nvec3 blendSoftLight_21_20(vec3 base, vec3 blend) {\n\treturn vec3(blendSoftLight_21_20(base.r,blend.r),blendSoftLight_21_20(base.g,blend.g),blendSoftLight_21_20(base.b,blend.b));\n}\n\nvec3 blendSoftLight_21_20(vec3 base, vec3 blend, float opacity) {\n\treturn (blendSoftLight_21_20(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nfloat blendSubstract_22_21(float base, float blend) {\n\treturn max(base+blend-1.0,0.0);\n}\n\nvec3 blendSubstract_22_21(vec3 base, vec3 blend) {\n\treturn max(base+blend-vec3(1.0),vec3(0.0));\n}\n\nvec3 blendSubstract_22_21(vec3 base, vec3 blend, float opacity) {\n\treturn (blendSubstract_22_21(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nvec3 blendExclusion_23_22(vec3 base, vec3 blend) {\n\treturn base+blend-2.0*base*blend;\n}\n\nvec3 blendExclusion_23_22(vec3 base, vec3 blend, float opacity) {\n\treturn (blendExclusion_23_22(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nvec3 blendDifference_24_23(vec3 base, vec3 blend) {\n\treturn abs(base-blend);\n}\n\nvec3 blendDifference_24_23(vec3 base, vec3 blend, float opacity) {\n\treturn (blendDifference_24_23(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n\nfloat blendAdd_25_24(float base, float blend) {\n\treturn min(base+blend,1.0);\n}\n\nvec3 blendAdd_25_24(vec3 base, vec3 blend) {\n\treturn min(base+blend,vec3(1.0));\n}\n\nvec3 blendAdd_25_24(vec3 base, vec3 blend, float opacity) {\n\treturn (blendAdd_25_24(base, blend) * opacity + blend * (1.0 - opacity));\n}\n\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(255)),r=a(n(128)),i=a(n(127));function a(e){return e&&e.__esModule?e:{default:e}}var s="\n\n// basic.frag\n\n#define SHADER_NAME SIMPLE_TEXTURE\nprecision highp float;\n\n".concat(o.default,"\n\n").concat(r.default,"\n\n").concat(i.default,"\n\nprecision highp float;\nvarying vec2 vTextureCoord;\nuniform sampler2D texture;\nuniform sampler2D textureNebula;\nuniform float time;\n\nvoid main(void) {\n    vec2 newUv = vTextureCoord;\n    vec2 st = vTextureCoord;\n\n\t// float t = time * 0.0007;\n //    vec2 r = vec2(fbm4(newUv + t * 0.7 - newUv.x - newUv.y, 0.4), fbm4(newUv -t * 0.4, 0.4));\n //    newUv.x *= .5+r.x;\n //    newUv.y *= .5+r.y;\n\n //    newUv.x = clamp(newUv.x, 0., 1.);\n //    newUv.y = clamp(newUv.y, 0., 1.);\n\n\t\n\tfloat _fbmTime = time * 0.002;\n\tfloat _fbmIntensity = sin(_fbmTime) * 0.5 + 0.4;\n\tfloat fbm = (fBm(st, _fbmTime, _fbmIntensity) - 0.5) * 0.003;\n\n    vec4 color = texture2D(texture, vec2(st.x + fbm, st.y + fbm));\n \t//vec4 colorBlur = texture2D(textureNebula, newUv);\n\t//vec3 b = blendOverlay_8_12(color.rgb, colorBlur.rgb, 1.);\n    //gl_FragColor = mix(color, colorBlur, offset);\n\t\n\n    //gl_FragColor = vec4(vec3(fbm),1.0);\n    gl_FragColor = vec4(color.rgb,1.0);\n}\n\n");t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="\n\n// basic.vert\n\nprecision highp float;\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n    gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\n    vTextureCoord = aTextureCoord;\n}\n\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(4)),r=a(n(257)),i=a(n(256));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var c=o.default.GL,f=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r.default,i.default)))._time=0,e}var n,a,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.View),n=t,(a=[{key:"_init",value:function(){this.mesh=o.default.Geom.sphere(200,24,!1,!1)}},{key:"render",value:function(e,t){this._time++,this.shader.bind(),this.shader.uniform("texture","uniform1i",0),this.shader.uniform("textureNebula","uniform1i",1),this.shader.uniform("time","float",this._time),e.bind(0),t.bind(1),c.draw(this.mesh)}}])&&u(n.prototype,a),s&&u(n,s),t}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.COLOR1=t.COLOR0=t.correctGamma=t.FixCubeLookup=t.EnvBRDFApprox=t.Uncharted2Tonemap=void 0;t.EnvBRDFApprox="\n\n// https://www.unrealengine.com/blog/physically-based-shading-on-mobile\nvec3 EnvBRDFApprox( vec3 SpecularColor, float Roughness, float NoV )\n{\n\tconst vec4 c0 = vec4( -1, -0.0275, -0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, -0.04 );\n\tvec4 r = Roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( -9.28 * NoV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn SpecularColor * AB.x + AB.y;\n}\n\n";t.FixCubeLookup="\n\n// http://the-witness.net/news/2012/02/seamless-cube-map-filtering/\nvec3 fix_cube_lookup( vec3 v, float cube_size, float lod ) {\n\tfloat M = max(max(abs(v.x), abs(v.y)), abs(v.z));\n\tfloat scale = 1.0 - exp2(lod) / cube_size;\n\tif (abs(v.x) != M) v.x *= scale;\n\tif (abs(v.y) != M) v.y *= scale;\n\tif (abs(v.z) != M) v.z *= scale;\n\treturn v;\n}\n\n";t.Uncharted2Tonemap="\nvec3 Uncharted2Tonemap( vec3 x )\n{\n\treturn ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;\n}\n\n";t.correctGamma="\nvec3 correctGamma(vec3 color, float g) {\n\treturn pow(color, vec3(1.0/g));\n}\n\n";t.COLOR0="const vec3 COLOR0 = 1.0 - vec3(198.0, 151.0, 75.0)/255.0;";t.COLOR1="const vec3 COLOR1 = vec3(1.0);"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFresnel=void 0;t.getFresnel="\n\nfloat getFresnel( vec3 cameraPosition , vec3 wsNormal, float bias, float scale, float power)\n{\n    return bias + scale * pow(1.0 + dot(cameraPosition, wsNormal), power);\n}\n\n\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="\n vec3 changeSaturation(vec3 color, float saturation) {\n \tfloat luma = dot(vec3(0.2125, 0.7154, 0.0721) * color, vec3(1.));\n \treturn mix(vec3(luma), color, saturation);\n }\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=u(n(130)),r=u(n(261)),i=n(260),a=u(n(129)),s=n(259);function u(e){return e&&e.__esModule?e:{default:e}}var l="\n\n#extension GL_EXT_shader_texture_lod : enable\n\nprecision highp float;\n\nuniform sampler2D \tuDiffuse;\nuniform sampler2D textureHeight;\nuniform sampler2D nextScene;\nuniform sampler2D \tuAoMap;\nuniform sampler2D \tuAlbedo;\nuniform samplerCube uIrradianceMap;\n\nuniform vec3\t\tuBaseColor;\nuniform vec3\t\tposition;\n\nuniform float\t\tuRoughness;\nuniform float\t\tuRoughness4;\nuniform float\t\tuMetallic;\nuniform float\t\tuSpecular;\nuniform float \t\tuAoStrength;\nuniform float\t\tuExposure;\nuniform float\t\tuGamma;\nuniform float\t\tuGreenOffset;\n\nuniform float\t\tuTime;\n\nuniform float baseColorAmount;\nuniform float atmosphereIntensity;\nuniform float fresnelBias;\nuniform float fresnelAmp;\nuniform float diffuseColorAmount;\n//uniform float uLightIntensity;\n\nvarying vec3        vNormal;\nvarying vec3        vPosition;\nvarying vec3\t\tvEyePosition;\nvarying vec3\t\tvWsNormal;\nvarying vec3\t\tvWsPosition;\nvarying vec2 \t\tvTextureCoord;\n\nvarying vec3 vLightRay;\nvarying vec3 vEyeVec;\n\n#define saturate(x) clamp(x, 0.0, 1.0)\n#define PI 3.1415926535897932384626433832795\n\n".concat(r.default,"\n\n// Filmic tonemapping from\n// http://filmicgames.com/archives/75\n\nconst float A = 0.15;\nconst float B = 0.50;\nconst float C = 0.10;\nconst float D = 0.20;\nconst float E = 0.02;\nconst float F = 0.30;\n\n\n").concat(s.Uncharted2Tonemap,"\n").concat(s.EnvBRDFApprox,"\n").concat(s.FixCubeLookup,"\n\n").concat(i.getFresnel,"\n\n").concat(a.default,"\n\n").concat(o.default,"\n\nvoid main() {\n\tvec2 st \t\t\t\t= vTextureCoord.xy;\n\n\tfloat mRoughness    = uRoughness;\n\tfloat mMetallic     = uMetallic;\n\tfloat mSpecular     = uSpecular;\n\n\n\tvec3 N \t\t\t\t= normalize( vWsNormal);\n\tvec3 V \t\t\t\t= normalize( vEyePosition );\n\n\tvec3 L = normalize(vLightRay);\n\tfloat lambertTerm = max(dot(N,-L),0.33);\n\t\n\t// deduce the diffuse and specular color from the baseColor and how metallic the material is\n\tvec3 diffuseColor\t= uBaseColor - uBaseColor * mMetallic;\n\tdiffuseColor *= baseColorAmount;\n\tvec3 specularColor\t= mix( vec3( 0.08 * mSpecular ), uBaseColor, mMetallic );\n\n\tfloat colorOffset = smoothstep(12.0, 0.0, vWsPosition.y);\n\t\n\tfloat lambertDiffuseValue = min(lambertTerm , 1.0);\n\tlambertDiffuseValue = 1.0; //***HACK\n\tvec3 color;\n\n\t// sample the pre-filtered cubemap at the corresponding mipmap level\n\t// float numMips\t\t= 6.0;\n\t// float mip\t\t\t= numMips - 1.0 + log2(mRoughness);\n\t// vec3 lookup\t\t\t= -reflect( V, N );\n\t// lookup\t\t\t\t= fix_cube_lookup( lookup, 512.0, mip );\n\t// vec3 radiance\t\t= pow( textureCubeLodEXT( uIrradianceMap, lookup, mip ).rgb, vec3( 2.2 ) );\n\t// vec3 irradiance\t\t= pow( textureCube( uIrradianceMap, N ).rgb, vec3( 1 ) );\n\t\n\t// // get the approximate reflectance\n\t// float NoV\t\t\t= saturate( dot( N, V ) );\n\t// vec3 reflectance\t= EnvBRDFApprox( specularColor, uRoughness4, NoV );\n\t\n\t// // combine the specular IBL and the BRDF\n\tvec3 diffTexture \t= texture2D(uDiffuse, vTextureCoord).rgb * lambertDiffuseValue;\n //    vec3 diffuse  \t\t= irradiance * diffuseColor + (irradiance * diffTexture + diffTexture);\n //    vec3 specular \t\t= radiance * reflectance;\n\t// color\t\t\t\t= diffuse + specular;\n\n\tcolor\t\t\t\t= diffTexture;\n\n\tvec3 ao \t\t\t= texture2D(uAoMap, vTextureCoord).rgb;\n\tfloat ssao \t\t\t= smoothstep(uAoStrength, 1.0, ao.r);\n\t// ao  \t\t\t\t= smoothstep(vec3(.5), vec3(1.0), ap);\n\tcolor \t\t\t\t*= ssao;\n\n\t// apply the tone-mapping\n\tcolor\t\t\t\t= Uncharted2Tonemap( color * uExposure );\n\t// white balance\n\tcolor\t\t\t\t= color * ( 1.0 / Uncharted2Tonemap( vec3( 40.0 ) ) );\n\t\n\t// gamma correction\n\tcolor\t\t\t\t= pow( color, vec3( 1.0 / uGamma ) );\n\t\n\tfloat fresenl = getFresnel(vEyePosition + position, vWsNormal, 0., fresnelBias, fresnelAmp);\n\tfresenl = max(fresenl, 0.0);\n\tfloat _fbmTime = uTime * 0.002;\n\tfloat _fbmIntensity = sin(_fbmTime) * 0.5 + 1.4;\n\tvec2 _pos = vec2(fract(st.x + _fbmTime * 0.04), fract(st.y + _fbmTime* 0.04));\n\tvec3 _atmosphere = atmosphere(_pos, _fbmTime, _fbmIntensity);\n\t_atmosphere *= atmosphereIntensity;\n\tvec3 finalColor = blendScreen_20_19(color, _atmosphere, 1.0);\n\n\tvec3 fresenlColor = finalColor * fresenl;// * atmosphereIntensity;\n\tfinalColor *= fresenl;\n\t// float opacity \t\t= smoothstep(0.0, 0.25, 1.0-uGreenOffset);\n\t// output the fragment color\n    gl_FragColor\t\t= vec4( fresenlColor, 1.0 );\n    gl_FragColor\t\t= vec4( finalColor, 1.0 );\n    //gl_FragColor\t\t= vec4( vEyePosition + position, 1.0 );\n    //gl_FragColor\t\t= vec4( vec3(fresenl), 1.0 );\n    //\tgl_FragColor\t\t= vec4( vec3(lambertTerm), 1.0 );\n\n}\n\n");t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="\n\n// basic.vert\n#define AMP 2.\n\nprecision highp float;\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec3 aNormal;\n\nuniform sampler2D texture;\nuniform sampler2D textureHeight;\n\nuniform float displace;\nuniform vec3 position;\nuniform float rotation;\nuniform vec3 scale;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat3 uNormalMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uModelViewMatrixInverse;\n\nuniform vec3 uLightPosition;\nuniform vec4 uLightAmbient;\nuniform vec4 uLightDiffuse;\n\nvarying vec2 vTextureCoord;\n\nvarying vec3 vLightRay;\nvarying vec3 vEyeVec;\n\nvarying vec3 vNormal;\nvarying vec3 vPosition;\nvarying vec3 vWsPosition;\nvarying vec3 vEyePosition;\nvarying vec3 vWsNormal;\n\nfloat rand(vec2 co){\n    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\n//blue is lowest\n//green is mid\n//red is mid\n\n// but all three together is taller...\n\nvec2 rotate(vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, -s, s, c);\n\treturn m * v;\n}\n\nvoid main(void) {\n\tvec3 pos = aVertexPosition;\n\n\tfloat amp = displace;\n\tvec3 color = texture2D(textureHeight, aTextureCoord).rgb;\n\tamp -= (1. - color.r) * displace;\n\t//pos.yz \t\t\t\t\t= rotate(pos.yz, rotation);\n\tpos.xz \t\t\t\t\t= rotate(pos.xz, rotation);\n\tpos += aNormal * amp;\n\tpos *= scale;\n\tpos += position;\n\n\tvec4 worldSpacePosition\t= uModelMatrix * vec4(pos, 1.0);\n    vec4 viewSpacePosition\t= uViewMatrix * worldSpacePosition;\n\n    vec4 vertex = viewSpacePosition * vec4(pos, 1.0);\n \tvec4 light = vec4(uLightPosition,1.0);\n \tvNormal = vec3(viewSpacePosition * vec4(aNormal, 1.0));\n \tvLightRay = vertex.xyz-light.xyz;\n \tvEyeVec = -vec3(vertex.xyz);\n\t\n    vNormal\t\t\t\t\t= uNormalMatrix * aNormal;\n    vPosition\t\t\t\t= viewSpacePosition.xyz;\n\tvWsPosition\t\t\t\t= worldSpacePosition.xyz;\n\t\n\tvec4 eyeDirViewSpace\t= viewSpacePosition - vec4( 0, 0, 0, 1 );\n\tvEyePosition\t\t\t= -vec3( uModelViewMatrixInverse * eyeDirViewSpace.xyz );\n\tvWsNormal\t\t\t\t= normalize( uModelViewMatrixInverse * vNormal );\n\t\n    gl_Position\t\t\t\t= uProjectionMatrix * viewSpacePosition;\n\n\tvTextureCoord\t\t\t= aTextureCoord;\n    \n}\n\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}(n(4)),r=s(n(12)),i=s(n(263)),a=s(n(262));function s(e){return e&&e.__esModule?e:{default:e}}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var f=o.default.GL,h=.8,d=1.6,v=3,p=[1,.765557,.336057],_=1,m=0,b=.2,y=0,g=1,x=0,w=0,E=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i.default,a.default))).x=0,e.y=0,e.z=0,e.scale=1,e.rotation=0,e._time=0,e.atmosphereIntensity=.4,e.fresnelBias=.05,e.fresnelAmp=1,e}var n,s,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.View),n=t,(s=[{key:"_init",value:function(){this.mesh=o.default.Geom.sphere(30,116,!0,!0)}},{key:"rotate",value:function(e){this.rotation+=e}},{key:"updateUniforms",value:function(e){var t=this;r.default.forIn(e,function(e,n){t[n]=e})}},{key:"render",value:function(e,t,n,o,r){this._time++,this.shader.bind(),this.shader.uniform("uDiffuse","uniform1i",0),this.shader.uniform("textureHeight","uniform1i",1),this.shader.uniform("uAoMap","uniform1i",2),this.shader.uniform("nextScene","uniform1i",3);var i=.925*g,a=Math.pow(i,4),s=[p[0],p[1],p[2]];this.shader.uniform("uBaseColor","uniform3fv",s),this.shader.uniform("uRoughness","uniform1f",i),this.shader.uniform("uRoughness4","uniform1f",a),this.shader.uniform("uMetallic","uniform1f",y),this.shader.uniform("uSpecular","uniform1f",x),e.bind(0),t.bind(1),n.bind(2),o.bind(3);var u=1-w;this.shader.uniform("position","vec3",[this.x*u,this.y*u-7.5*w,this.z*u]),this.shader.uniform("scale","vec3",[this.scale,this.scale,this.scale]),this.shader.uniform("rotation","float",this.rotation),this.shader.uniform("displace","float",d),this.shader.uniform("baseColorAmount","float",_),this.shader.uniform("diffuseColorAmount","float",m),this.shader.uniform("uExposure","uniform1f",v),this.shader.uniform("uGamma","uniform1f",h),this.shader.uniform("uAoStrength","uniform1f",b),this.shader.uniform("uGreenOffset","float",u),this.shader.uniform("uTime","float",this._time),this.shader.uniform("atmosphereIntensity","float",this.atmosphereIntensity),this.shader.uniform("fresnelBias","float",this.fresnelBias),this.shader.uniform("fresnelAmp","float",this.fresnelAmp),f.draw(this.mesh)}},{key:"position",set:function(e){this.x=e[0],this.y=e[1],this.z=e[2]}}])&&l(n.prototype,s),u&&l(n,u),t}();t.default=E},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=p(n(4)),r=n(10),i=v(n(134)),a=v(n(133)),s=v(n(132)),u=v(n(264)),l=v(n(258)),c=v(n(254)),f=v(n(250)),h=(p(n(6)),v(n(12))),d=v(n(20));function v(e){return e&&e.__esModule?e:{default:e}}function p(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var y=2*Math.PI,g=o.default.GL,x=function(e){function t(e){var n,o,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,n=!(r=(t.__proto__||Object.getPrototypeOf(t)).call(this))||"object"!==_(r)&&"function"!=typeof r?b(o):r,g.enableAlphaBlending(),n.orbitalControl=new i.default(n.camera,window,100),n.orbitalControl.lock(!0),n.anim=new s.default(n.orbitalControl,{}),n._initLights(),n._sceneTimeline=new TimelineMax({paused:!0,onComplete:n._sceneComplete.bind(b(n))}),n._scenes=e.scenes,n._sceneIndex=0,n._playScene(),n}var n,v,p;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.Scene),n=t,(v=[{key:"_initTextures",value:function(){this._textureDiffuse=new o.default.GLTexture((0,r.getAsset)("diffuse")),this._textureHeight=new o.default.GLTexture((0,r.getAsset)("height")),this._textureAo=new o.default.GLTexture((0,r.getAsset)("ao")),this._textureSpace=new o.default.GLTexture((0,r.getAsset)("space")),this._textureNebula=new o.default.GLTexture((0,r.getAsset)("nebula"))}},{key:"_initLights",value:function(){this._sun=new a.default({position:[-30,10,0]})}},{key:"_initViews",value:function(){this.meshes=[],this._mars=new u.default,this._mars.rotate(.5*Math.random()),this._sky=new l.default,this._out=new c.default,this._fbo=new f.default(1920,1080),this._nextSceneFbo=new f.default(1920,1080)}},{key:"_playScene",value:function(){var e=this,t=this._scenes[this._sceneIndex];this._mars.updateUniforms(t.marsUniforms),this.anim.positionTransfer=t.camera.position,setTimeout(function(){e._transitionScene(t)},1e3*t.duration),this._sceneAnimations(this._scenes[this._sceneIndex])}},{key:"_transitionScene",value:function(e){var t=this,n=this._scenes[this._sceneIndex+1];if(this._isTransition=!0,n){n.shake?this.startShake():this.stopShake();var o={val:0};TweenMax.to(o,e.transitionDuration,{val:1,ease:Linear.none,onUpdate:function(){t._out.transition=o.val},onComplete:function(){t._isTransition=!1,t._sceneComplete(n)}});var r=h.default.clone(e.marsUniforms);this._animateUniforms(r,e.transitionDuration,n.marsUniforms,this._mars);var i=h.default.clone(e.outUniforms);this._animateUniforms(i,e.transitionDuration,n.outUniforms,this._out)}else this._sceneIndex=0,this._out.transition=0,this.stopShake(),this._playScene(),console.log("DONE")}},{key:"_animateUniforms",value:function(e,t,n,o){var r=Object.assign({},n,{ease:Linear.none,onUpdate:function(){o.updateUniforms(e)}});TweenMax.to(e,t,r)}},{key:"_sceneComplete",value:function(e){this._sceneIndex++,this._out.transition=0,this._sceneIndex<this._scenes.length&&this._playScene()}},{key:"_sceneAnimations",value:function(e){var t=this;if(e.animations){h.default.forIn(e.animations,function(e,n){t.anim[n]&&t.anim[n](e.value,Object.assign({},e.props,{ease:Cubic.easeIn}))});var n=e.animations.outUniforms;this._animateUniforms({atmosphereIntensity:1},2,n,this._out)}}},{key:"_renderScene",value:function(e,t){var n=this._scenes[t];this.camera.reset(),e.clear(),e.bind();var o=n.camera;this.anim.positionTransfer=o.position;var r=this.anim.positionTransfer;this._isShaking&&(r=this._addShake(r,n.shakeIntensity)),this.camera.reset(),this.anim.setCamera(r),g.disable(g.CULL_FACE),this._sun.bind(),this._renderSky(),this._renderMars(),g.enable(g.CULL_FACE),this._sun.unbind(),e.unbind()}},{key:"_hasNextScene",value:function(){return this._sceneIndex<this._scenes.length}},{key:"_rotateAround",value:function(){this.orbitalControl.ry.value+=.01}},{key:"_renderMars",value:function(){this._mars.render(this._textureDiffuse,this._textureHeight,this._textureAo,this._fbo.getTexture())}},{key:"_renderSky",value:function(){this._sky.render(this._textureSpace,this._textureNebula)}},{key:"render",value:function(){this._stopRender||(g.clear(0,0,0,0),this._mars.rotate(5e-5),this._renderScene(this._fbo,this._sceneIndex),this._sceneIndex<this._scenes.length-1&&this._isTransition?this._renderScene(this._nextSceneFbo,this._sceneIndex+1):this._nextSceneFbo.clear(),this.anim.setCamera([0,0,0]),this.cameraOrtho.setBoundary(-1,1,-1,1),g.camera._projection=this.cameraOrtho.projection,this._out.render(this._fbo.getTexture(),this._nextSceneFbo.getTexture()))}},{key:"startShake",value:function(){this._isShaking=!0}},{key:"stopShake",value:function(){this._isShaking=!1}},{key:"_addShake",value:function(e,t){var n=Math.random(y);return[e[0]+Math.cos(n)*t,e[1]+Math.sin(n)*t,e[2]]}},{key:"zoomIn",value:function(){this.animate()}},{key:"animate",value:function(){this.anim.moveTo([30,10,-60],{duration:4,ease:Power1.easeIn,onComplete:function(){d.default.emit("intro:complete")}})}},{key:"resize",value:function(){g.setSize(window.innerWidth,window.innerHeight),this.camera.setAspectRatio(g.aspectRatio)}},{key:"destroy",value:function(){this.stop(),this.stopShake(),this.anim.destroy(),g.gl.deleteTexture(this._textureDiffuse.texture),g.gl.deleteTexture(this._textureHeight.texture),g.gl.deleteTexture(this._textureAo.texture),g.gl.deleteTexture(this._textureSpace.texture),g.gl.deleteTexture(this._textureNebula.texture),this._fbo.destroy(),this._nextSceneFbo.destroy()}},{key:"pause",set:function(e){this._stopRender=e}}])&&m(n.prototype,v),p&&m(n,p),t}();t.default=x},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}(n(53)),r=l(n(266)),i=l(n(249)),a=l(n(42)),s=(l(n(12)),l(n(20))),u=l(n(215));function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._sceneIndex=0,this._init()}var t,n,l;return t=e,(n=[{key:"_init",value:function(){var e=this;this._loadAssets(),s.default.on("sculpture:near",function(){return e._onNear()})}},{key:"_loadAssets",value:function(){this._sceneData=o.default[this._sceneIndex];var e=[];(0,o.findObjectsWithKey)(this._sceneData,"url").forEach(function(t){var n=t.id,o=t.url,r=t.type;o="https://storage.googleapis.com/samrad-mars/www-assets/assets/"+o,e.push({id:n,url:o,type:r,crossOrigin:"anonymous"})});new u.default({assets:e}).on("error",function(e){console.error(e)}).on("progress",function(e){}).on("complete",this._onAssetsLoaded.bind(this)).start()}},{key:"_onAssetsLoaded",value:function(e){switch(window.assets=e,this._sceneData.type){case"intro":this._scene=new r.default(this._sceneData);break;case"mars":this._scene=new i.default(this._sceneData)}this._scene.pause=!!this._pause,s.default.emit("exp:loaded")}},{key:"_loadMars",value:function(){this._scene.destroy(),this._sceneIndex=1,this._loadAssets()}},{key:"_onNear",value:function(){}},{key:"next",value:function(){s.default.emit("nav:sculptures:next")}},{key:"nextHotpot",value:function(){s.default.emit("nav:sculptures:nexthotspot")}},{key:"pauseMovement",value:function(){var e=a.default.pause;a.default.pause=!e}},{key:"on",value:function(e,t){s.default.on("exp:".concat(e),t)}},{key:"pause",set:function(e){this._pause=e,this._scene&&(this._scene.pause=e)}}])&&c(t.prototype,n),l&&c(t,l),e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;i(n(11));var o=i(n(139)),r=i(n(55));function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var s=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._fbo=new o.default(t,n,i),this._fboTarget=new o.default(t,n,i),this._mesh=r.default.bigTriangle(),this._passes=[]}var t,n,i;return t=e,(n=[{key:"addPass",value:function(e){this._passes.push(e)}},{key:"render",value:function(e){for(var t=0;t<this._passes.length;t++)this._swap()}},{key:"_swap",value:function(){var e=this._fbo;this._fbo=this._fboTarget,this._fboTarget=e}}])&&a(t.prototype,n),i&&a(t,i),e}();t.default=s},function(e,t){e.exports="// generalWithNormal.vert\n\n#define SHADER_NAME GENERAL_VERTEX\n\nprecision highp float;\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec3 aNormal;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uNormalMatrix;\n\nuniform vec3 position;\nuniform vec3 scale;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vNormal;\n\nvoid main(void) {\n\tvec3 pos      = aVertexPosition * scale;\n\tpos           += position;\n\tgl_Position   = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(pos, 1.0);\n\t\n\tvTextureCoord = aTextureCoord;\n\tvNormal       = normalize(uNormalMatrix * aNormal);\n}"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={simpleColorFrag:n(73),bigTriangleVert:n(136),generalVert:n(135),generalNormalVert:n(269)};t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(34))&&o.__esModule?o:{default:o};function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var a=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.shader=new r.default(t,n),this._init()}var t,n,o;return t=e,(n=[{key:"_init",value:function(){}},{key:"render",value:function(){}}])&&i(t.prototype,n),o&&i(t,o),e}();t.default=a},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=u(n(272)),r=u(n(11)),i=u(n(75)),a=u(n(137)),s=u(n(138));function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var c=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._init(),this._initTextures(),this._initViews(),this._efIndex=o.default.addEF(function(){return t._loop()}),window.addEventListener("resize",function(){return t.resize()})}var t,n,u;return t=e,(n=[{key:"render",value:function(){}},{key:"stop",value:function(){-1!==this._efIndex&&(this._efIndex=o.default.removeEF(this._efIndex))}},{key:"start",value:function(){var e=this;-1===this._efIndex&&(this._efIndex=o.default.addEF(function(){return e._loop()}))}},{key:"resize",value:function(){r.default.setSize(window.innerWidth,window.innerHeight),this.camera.setAspectRatio(r.default.aspectRatio)}},{key:"_initTextures",value:function(){}},{key:"_initViews",value:function(){}},{key:"_init",value:function(){this.camera=new i.default,this.camera.setPerspective(45*Math.PI/180,r.default.aspectRatio,.1,1e4),this.orbitalControl=new s.default(this.camera,window,15),this.orbitalControl.radius.value=10,this.cameraOrtho=new a.default}},{key:"_loop",value:function(){r.default.viewport(0,0,r.default.width,r.default.height),r.default.setMatrices(this.camera),this.render()}}])&&l(t.prototype,n),u&&l(t,u),e}();t.default=c},function(e,t){e.exports="// basic.vert\n\n#define SHADER_NAME DOTS_PLANE_VERTEX\n\nprecision highp float;\nattribute vec3 aVertexPosition;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n    gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\n}"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=s(n(11)),r=s(n(44)),i=s(n(34)),a=s(n(43));function s(e){return e&&e.__esModule?e:{default:e}}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var f=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a,s,u=[],l=[],f=0;for(a=-25;a<50;a+=.5)for(s=-25;s<50;s+=.5)u.push([a,s,0]),l.push(f),f++,u.push([a,0,s]),l.push(f),f++;var h=new r.default(o.default.POINTS);h.bufferVertex(u),h.bufferIndices(l);var d=new i.default(n(274),n(73));return(e=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,h,d))).color=[1,1,1],e.opacity=.5,e}var s,u,f;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),s=t,(u=[{key:"draw",value:function(){this.shader.bind(),this.shader.uniform("color","uniform3fv",this.color),this.shader.uniform("opacity","uniform1f",this.opacity),function e(t,n,o){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"draw",this).call(this)}}])&&l(s.prototype,u),f&&l(s,f),t}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(55)),r=a(n(34)),i=a(n(43));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var c=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=o.default.sphere(1,24),i=new r.default(n(135),n(73));return l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i))}var a,s,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),a=t,(s=[{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.shader.bind(),this.shader.uniform("position","uniform3fv",e),this.shader.uniform("scale","uniform3fv",n),this.shader.uniform("color","uniform3fv",o),this.shader.uniform("opacity","uniform1f",r),function e(t,n,o){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"draw",this).call(this)}}])&&u(a.prototype,s),c&&u(a,c),t}();t.default=c},function(e,t){e.exports="// axis.frag\n\n#define SHADER_NAME SIMPLE_TEXTURE\n\nprecision highp float;\nvarying vec3 vColor;\n\nvoid main(void) {\n    gl_FragColor = vec4(vColor, 1.0);\n}"},function(e,t){e.exports="// axis.vert\n\n#define SHADER_NAME BASIC_VERTEX\n\nprecision highp float;\nattribute vec3 aVertexPosition;\nattribute vec3 aColor;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying vec3 vColor;\n\nvoid main(void) {\n    gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\n    vColor = aColor;\n}"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=s(n(11)),r=s(n(44)),i=s(n(34)),a=s(n(43));function s(e){return e&&e.__esModule?e:{default:e}}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var c=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=[],a=[],s=9999;e.push([-s,0,0]),e.push([s,0,0]),e.push([0,-s,0]),e.push([0,s,0]),e.push([0,0,-s]),e.push([0,0,s]),a.push([1,0,0]),a.push([1,0,0]),a.push([0,1,0]),a.push([0,1,0]),a.push([0,0,1]),a.push([0,0,1]);var u=new r.default(o.default.LINES);u.bufferVertex(e),u.bufferIndices([0,1,2,3,4,5]),u.bufferData(a,"aColor",3);var c=new i.default(n(278),n(277));return l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,u,c))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),t}();t.default=c},function(e,t){e.exports="// copy.frag\n\n#define SHADER_NAME COPY_FRAGMENT\n\nprecision highp float;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D texture;\n\nvoid main(void) {\n    gl_FragColor = texture2D(texture, vTextureCoord);\n}"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(55)),r=a(n(34)),i=a(n(43));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var c=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=o.default.bigTriangle(),a=new r.default(n(136),n(280));return e=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i,a)),a.bind(),a.uniform("texture","uniform1i",0),e}var a,s,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),a=t,(s=[{key:"draw",value:function(e){this.shader.bind(),e.bind(0),function e(t,n,o){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"draw",this).call(this)}}])&&u(a.prototype,s),c&&u(a,c),t}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o="#\\?RADIANCE",r="#.*",i="EXPOSURE=\\s*([0-9]*[.][0-9]*)",a="FORMAT=32-bit_rle_rgbe",s="-Y ([0-9]+) \\+X ([0-9]+)";var u=function(e){e instanceof ArrayBuffer&&(e=new Uint8Array(e));var t=0,n=e.length,u=10;function l(){var o="";do{var r=e[t];if(r===u){++t;break}o+=String.fromCharCode(r)}while(++t<n);return o}for(var c=0,f=0,h=1,d=!1,v=0;v<20;v++){var p=l(),_=void 0;if(_=p.match(o));else if(_=p.match(a))d=!0;else if(_=p.match(i))h=Number(_[1]);else if(_=p.match(r));else if(_=p.match(s)){f=Number(_[1]),c=Number(_[2]);break}}if(!d)throw new Error("File is not run length encoded!");var m=new Uint8Array(c*f*4);!function(e,t,n,o,r,i){var a,s,u,l=new Array(4),c=null,f=new Array(2),h=e.length;function d(t){var n=0;do{t[n++]=e[o]}while(++o<h&&n<t.length);return n}function v(t,n,r){var i=0;do{t[n+i++]=e[o]}while(++o<h&&i<r);return i}function p(e,t,n,o){var r=4*o,i=v(t,n,r);if(i<r)throw new Error("Error reading raw pixels: got "+i+" bytes, expected "+r)}for(;i>0;){if(d(l)<l.length)throw new Error("Error reading bytes: expected "+l.length);if(2!==l[0]||2!==l[1]||0!=(128&l[2]))return t[n++]=l[0],t[n++]=l[1],t[n++]=l[2],t[n++]=l[3],void p(0,t,n,r*i-1);if(((255&l[2])<<8|255&l[3])!==r)throw new Error("Wrong scanline width "+((255&l[2])<<8|255&l[3])+", expected "+r);null===c&&(c=new Array(4*r)),a=0;for(var _=0;_<4;_++)for(s=(_+1)*r;a<s;){if(d(f)<f.length)throw new Error("Error reading 2-byte buffer");if((255&f[0])>128){if(0==(u=(255&f[0])-128)||u>s-a)throw new Error("Bad scanline data");for(;u-- >0;)c[a++]=f[1]}else{if(0==(u=255&f[0])||u>s-a)throw new Error("Bad scanline data");if(c[a++]=f[1],--u>0){if(v(c,a,u)<u)throw new Error("Error reading non-run data");a+=u}}}for(var m=0;m<r;m++)t[n+0]=c[m],t[n+1]=c[m+r],t[n+2]=c[m+2*r],t[n+3]=c[m+3*r],n+=4;i--}}(e,m,0,t,c,f);for(var b=new Float32Array(c*f*4),y=0;y<m.length;y+=4){var g=m[y+0]/255,x=m[y+1]/255,w=m[y+2]/255,E=m[y+3],O=Math.pow(2,E-128);g*=O,x*=O,w*=O;var M=y;b[M+0]=g,b[M+1]=x,b[M+2]=w,b[M+3]=1}return{shape:[c,f],exposure:h,gamma:1,data:b}};t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(74)),r=i(n(282));function i(e){return e&&e.__esModule?e:{default:e}}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,!0))}var n,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),n=t,(i=[{key:"parse",value:function(e){return(0,r.default)(e)}},{key:"_onLoaded",value:function(){var e=this.parse(this._req.response);this._callback&&this._callback(e)}}])&&s(n.prototype,i),a&&s(n,a),t}();l.parse=function(e){return(0,r.default)(e)};var c=l;t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(74)),r=i(n(44));function i(e){return e&&e.__esModule?e:{default:e}}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}var n,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),n=t,(i=[{key:"load",value:function(e,n){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4;this._ignoreNormals=o,this._drawType=r,function e(t,n,o){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"load",this).call(this,e,n)}},{key:"_onLoaded",value:function(){this._parseObj(this._req.response)}},{key:"_parseObj",value:function(e){var t,n=e.split("\n"),o=[],r=[],i=[],a=[],s=[],u=[],l=[],c=0,f=/v( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,h=/vn( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,d=/vt( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,v=/f( +-?\d+)( +-?\d+)( +-?\d+)( +-?\d+)?/,p=/f( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))?/,_=/f( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))?/,m=/f( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))?/;function b(e){var t=parseInt(e);return 3*(t>=0?t-1:t+a.length/3)}function y(e){var t=parseInt(e);return 3*(t>=0?t-1:t+s.length/3)}function g(e){var t=parseInt(e);return 2*(t>=0?t-1:t+u.length/2)}function x(e,t,n){o.push([a[e],a[e+1],a[e+2]]),o.push([a[t],a[t+1],a[t+2]]),o.push([a[n],a[n+1],a[n+2]]),l.push(3*c+0),l.push(3*c+1),l.push(3*c+2),c++}function w(e,t,n){r.push([u[e],u[e+1]]),r.push([u[t],u[t+1]]),r.push([u[n],u[n+1]])}function E(e,t,n){i.push([s[e],s[e+1],s[e+2]]),i.push([s[t],s[t+1],s[t+2]]),i.push([s[n],s[n+1],s[n+2]])}function O(e,t,n,o,r,i,a,s,u,l,c,f){var h,d=b(e),v=b(t),p=b(n);void 0===o?x(d,v,p):(x(d,v,h=b(o)),x(v,p,h)),void 0!==r&&(d=g(r),v=g(i),p=g(a),void 0===o?w(d,v,p):(w(d,v,h=g(s)),w(v,p,h))),void 0!==u&&(d=y(u),v=y(l),p=y(c),void 0===o?E(d,v,p):(E(d,v,h=y(f)),E(v,p,h)))}for(var M=0;M<n.length;M++){var P=n[M];0!==(P=P.trim()).length&&"#"!==P.charAt(0)&&(null!==(t=f.exec(P))?a.push(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])):null!==(t=h.exec(P))?s.push(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])):null!==(t=d.exec(P))?u.push(parseFloat(t[1]),parseFloat(t[2])):null!==(t=v.exec(P))?O(t[1],t[2],t[3],t[4]):null!==(t=p.exec(P))?O(t[2],t[5],t[8],t[11],t[3],t[6],t[9],t[12]):null!==(t=_.exec(P))?O(t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15],t[4],t[8],t[12],t[16]):null!==(t=m.exec(P))&&O(t[2],t[5],t[8],t[11],void 0,void 0,void 0,void 0,t[3],t[6],t[9],t[12]))}this._generateMeshes({positions:o,coords:r,normals:i,indices:l})}},{key:"_generateMeshes",value:function(e){var t=e.normals.length>0,n=e.coords.length>0;if(e.positions.length>65535){var o=[],i=0,a={};for(a.positions=e.positions.concat(),a.coords=e.coords.concat(),a.indices=e.indices.concat(),a.normals=e.normals.concat();e.indices.length>0;){for(var s=Math.min(65535,e.positions.length),u=e.indices.splice(0,s),l=[],c=[],f=[],h=void 0,d=0,v=0;v<u.length;v++)u[v]>d&&(d=u[v]),h=u[v],l.push(a.positions[h]),n&&c.push(a.coords[h]),t&&f.push(a.normals[h]),u[v]-=i;i=d+1;var p=new r.default(this._drawType);p.bufferVertex(l),n&&p.bufferTexCoords(c),p.bufferIndices(u),!this._ignoreNormals&&t&&p.bufferNormal(f),o.push(p)}this._callback&&this._callback(o,a)}else{var _=new r.default(this._drawType);_.bufferVertex(e.positions),n&&_.bufferTexCoords(e.coords),_.bufferIndices(e.indices),!this._ignoreNormals&&t&&_.bufferNormal(e.normals),this._callback&&this._callback(_,e)}}}])&&s(n.prototype,i),a&&s(n,a),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(75))&&o.__esModule?o:{default:o};function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}(n(6)).vec3,l=[[u.fromValues(0,0,0),u.fromValues(1,0,0),u.fromValues(0,-1,0)],[u.fromValues(0,0,0),u.fromValues(-1,0,0),u.fromValues(0,-1,0)],[u.fromValues(0,0,0),u.fromValues(0,1,0),u.fromValues(0,0,1)],[u.fromValues(0,0,0),u.fromValues(0,-1,0),u.fromValues(0,0,-1)],[u.fromValues(0,0,0),u.fromValues(0,0,1),u.fromValues(0,-1,0)],[u.fromValues(0,0,0),u.fromValues(0,0,-1),u.fromValues(0,-1,0)]],c=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))).setPerspective(Math.PI/2,1,.1,1e3),e}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),n=t,(o=[{key:"face",value:function(e){var t=l[e];this.lookAt(t[0],t[1],t[2])}}])&&a(n.prototype,o),i&&a(n,i),t}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}(n(6)),r=a(n(54)),i=a(n(33));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var u=function(e,t){var n=t||{};return e.touches?(n.x=e.touches[0].pageX,n.y=e.touches[0].pageY):(n.x=e.clientX,n.y=e.clientY),n},l=function(){function e(t){var n=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._target=t,this._listenerTarget=a,this.matrix=o.mat4.create(),this.m=o.mat4.create(),this._vZaxis=o.vec3.clone([0,0,0]),this._zAxis=o.vec3.clone([0,0,1]),this.preMouse={x:0,y:0},this.mouse={x:0,y:0},this._isMouseDown=!1,this._rotation=o.quat.create(),this.tempRotation=o.quat.create(),this._rotateZMargin=0,this._offset=.004,this._slerp=-1,this._isLocked=!1,this._diffX=new r.default(0,s),this._diffY=new r.default(0,s),this._listenerTarget.addEventListener("mousedown",function(e){return n._onDown(e)}),this._listenerTarget.addEventListener("touchstart",function(e){return n._onDown(e)}),this._listenerTarget.addEventListener("mousemove",function(e){return n._onMove(e)}),this._listenerTarget.addEventListener("touchmove",function(e){return n._onMove(e)}),window.addEventListener("touchend",function(){return n._onUp()}),window.addEventListener("mouseup",function(){return n._onUp()}),i.default.addEF(function(){return n._loop()})}var t,n,a;return t=e,(n=[{key:"inverseControl",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isInvert=e}},{key:"lock",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isLocked=e}},{key:"setCameraPos",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;if(this.easing=t,!(this._slerp>0)){var n=o.quat.clone(this._rotation);this._updateRotation(n),this._rotation=o.quat.clone(n),this._currDiffX=this.diffX=0,this._currDiffY=this.diffY=0,this._isMouseDown=!1,this._isRotateZ=0,this._targetQuat=o.quat.clone(e),this._slerp=1}}},{key:"resetQuat",value:function(){this._rotation=o.quat.clone([0,0,1,0]),this.tempRotation=o.quat.clone([0,0,0,0]),this._targetQuat=void 0,this._slerp=-1}},{key:"_onDown",value:function(e){if(!this._isLocked){var t=u(e),n=o.quat.clone(this._rotation);this._updateRotation(n),this._rotation=n,this._isMouseDown=!0,this._isRotateZ=0,this.preMouse={x:t.x,y:t.y},t.y<this._rotateZMargin||t.y>window.innerHeight-this._rotateZMargin?this._isRotateZ=1:(t.x<this._rotateZMargin||t.x>window.innerWidth-this._rotateZMargin)&&(this._isRotateZ=2),this._diffX.setTo(0),this._diffY.setTo(0)}}},{key:"_onMove",value:function(e){this._isLocked||u(e,this.mouse)}},{key:"_onUp",value:function(){this._isLocked||(this._isMouseDown=!1)}},{key:"_updateRotation",value:function(e){var t,n;if(this._isMouseDown&&!this._isLocked&&(this._diffX.value=-(this.mouse.x-this.preMouse.x),this._diffY.value=this.mouse.y-this.preMouse.y,this._isInvert&&(this._diffX.value=-this._diffX.targetValue,this._diffY.value=-this._diffY.targetValue)),this._isRotateZ>0)1===this._isRotateZ?(t=-this._diffX.value*this._offset,t*=this.preMouse.y<this._rotateZMargin?-1:1,n=o.quat.clone([0,0,Math.sin(t),Math.cos(t)]),o.quat.multiply(n,e,n)):(t=-this._diffY.value*this._offset,t*=this.preMouse.x<this._rotateZMargin?1:-1,n=o.quat.clone([0,0,Math.sin(t),Math.cos(t)]),o.quat.multiply(n,e,n));else{var r=o.vec3.clone([this._diffX.value,this._diffY.value,0]),i=o.vec3.create();o.vec3.cross(i,r,this._zAxis),o.vec3.normalize(i,i),t=o.vec3.length(r)*this._offset,n=o.quat.clone([Math.sin(t)*i[0],Math.sin(t)*i[1],Math.sin(t)*i[2],Math.cos(t)]),o.quat.multiply(e,n,e)}}},{key:"_loop",value:function(){o.mat4.identity(this.m),void 0===this._targetQuat?(o.quat.set(this.tempRotation,this._rotation[0],this._rotation[1],this._rotation[2],this._rotation[3]),this._updateRotation(this.tempRotation)):(this._slerp+=.1*(0-this._slerp),this._slerp<.001?(o.quat.set(this._rotation,this._targetQuat[0],this._targetQuat[1],this._targetQuat[2],this._targetQuat[3]),this._targetQuat=void 0,this._slerp=-1):(o.quat.set(this.tempRotation,0,0,0,0),o.quat.slerp(this.tempRotation,this._targetQuat,this._rotation,this._slerp))),o.vec3.transformQuat(this._vZaxis,this._vZaxis,this.tempRotation),o.mat4.fromQuat(this.matrix,this.tempRotation)}},{key:"easing",set:function(e){this._diffX.easing=e,this._diffY.easing=e},get:function(){return this._diffX.easing}}])&&s(t.prototype,n),a&&s(t,a),e}();t.default=l},function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=!0;try{document.createEvent("CustomEvent");null}catch(e){r=!1}var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,(n=[{key:"addEventListener",value:function(e,t){return null===this._eventListeners&&(this._eventListeners={}),this._eventListeners[e]||(this._eventListeners[e]=[]),this._eventListeners[e].push(t),this}},{key:"removeEventListener",value:function(e,t){null===this._eventListeners&&(this._eventListeners={});var n=this._eventListeners[e];if(void 0===n)return this;for(var o=n.length,r=0;r<o;r++)n[r]===t&&(n.splice(r,1),r--,o--);return this}},{key:"dispatchEvent",value:function(e){null===this._eventListeners&&(this._eventListeners={});var t=e.type;try{null===e.target&&(e.target=this),e.currentTarget=this}catch(o){var n={type:t,detail:e.detail,dispatcher:this};return this.dispatchEvent(n)}var o=this._eventListeners[t];if(null!==o&&void 0!==o)for(var r=this._copyArray(o),i=r.length,a=0;a<i;a++){r[a].call(this,e)}return this}},{key:"dispatchCustomEvent",value:function(e,t){var n;return r?((n=document.createEvent("CustomEvent")).dispatcher=this,n.initCustomEvent(e,!1,!1,t)):n={type:e,detail:t,dispatcher:this},this.dispatchEvent(n)}},{key:"_destroy",value:function(){if(null!==this._eventListeners){for(var e in this._eventListeners)if(this._eventListeners.hasOwnProperty(e)){for(var t=this._eventListeners[e],n=t.length,o=0;o<n;o++)t[o]=null;delete this._eventListeners[e]}this._eventListeners=null}}},{key:"_copyArray",value:function(e){for(var t=new Array(e.length),n=t.length,o=0;o<n;o++)t[o]=e[o];return t}}])&&o(t.prototype,n),i&&o(t,i),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=a(n(11)),i=a(n(140));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var u=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o=r.default.gl,this._size=t,this.magFilter=n.magFilter||o.LINEAR,this.minFilter=n.minFilter||o.LINEAR,this.wrapS=n.wrapS||o.CLAMP_TO_EDGE,this.wrapT=n.wrapT||o.CLAMP_TO_EDGE,this._init()}var t,n,a;return t=e,(n=[{key:"_init",value:function(){this.texture=o.createTexture(),this.glTexture=new i.default(this.texture,{},!0),o.bindTexture(o.TEXTURE_CUBE_MAP,this.texture),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MAG_FILTER,this.magFilter),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MIN_FILTER,this.minFilter),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_WRAP_S,this.wrapS),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_WRAP_T,this.wrapT);for(var e=[o.TEXTURE_CUBE_MAP_POSITIVE_X,o.TEXTURE_CUBE_MAP_NEGATIVE_X,o.TEXTURE_CUBE_MAP_POSITIVE_Y,o.TEXTURE_CUBE_MAP_NEGATIVE_Y,o.TEXTURE_CUBE_MAP_POSITIVE_Z,o.TEXTURE_CUBE_MAP_NEGATIVE_Z],t=0;t<e.length;t++)o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!1),o.texImage2D(e[t],0,o.RGBA,this.width,this.height,0,o.RGBA,o.FLOAT,null);this._frameBuffers=[];for(var n=0;n<e.length;n++){var r=o.createFramebuffer();o.bindFramebuffer(o.FRAMEBUFFER,r),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,e[n],this.texture,0);var a=o.checkFramebufferStatus(o.FRAMEBUFFER);a!==o.FRAMEBUFFER_COMPLETE&&console.log("gl.checkFramebufferStatus() returned "+a),this._frameBuffers.push(r)}o.bindFramebuffer(o.FRAMEBUFFER,null),o.bindRenderbuffer(o.RENDERBUFFER,null),o.bindTexture(o.TEXTURE_CUBE_MAP,null)}},{key:"bind",value:function(e){r.default.viewport(0,0,this.width,this.height),o.bindFramebuffer(o.FRAMEBUFFER,this._frameBuffers[e])}},{key:"unbind",value:function(){o.bindFramebuffer(o.FRAMEBUFFER,null),r.default.viewport(0,0,r.default.width,r.default.height)}},{key:"getTexture",value:function(){return this.glTexture}},{key:"width",get:function(){return this._size}},{key:"height",get:function(){return this._size}}])&&s(t.prototype,n),a&&s(t,a),e}();t.default=u},function(e,t){e.exports="// basic.frag\n\n#define SHADER_NAME BASIC_FRAGMENT\n\nprecision highp float;\nvarying vec2 vTextureCoord;\nuniform float time;\n// uniform sampler2D texture;\n\nvoid main(void) {\n    gl_FragColor = vec4(vTextureCoord, sin(time) * .5 + .5, 1.0);\n}"},function(e,t){e.exports="// basic.vert\n\n#define SHADER_NAME BASIC_VERTEX\n\nprecision highp float;\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n    gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\n    vTextureCoord = aTextureCoord;\n}"},,function(e,t){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(292);var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}(n(2)),r=(n(60),s(n(12)),n(90)),i=s(n(4)),a=s(n(267));function s(e){return e&&e.__esModule?e:{default:e}}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var f=i.default.GL,h=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.props.browser;f.init(this.refs.glCtx),this.scene=new a.default}},{key:"componentWillReceiveProps",value:function(e){this.props.browser}},{key:"render",value:function(){this.props.browser;return o.default.createElement("div",{ref:"mars-planet",className:"o-page mars-planet"},o.default.createElement("canvas",{ref:"glCtx"}))}}])&&l(n.prototype,r),i&&l(n,i),t}(),d=(0,r.connect)(function(e){return{browser:e.browser}},{})(h);t.default=d},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},,,,,,,,,function(e,t){},,function(e,t){},,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}(n(2));(o=n(154))&&o.__esModule;var i=function(e){return r.default.createElement("div",{key:e.id,className:"project"},r.default.createElement("a",{className:"project__title home__link",href:"".concat(e.href)},r.default.createElement("img",{className:"project__image",src:"".concat("https://storage.googleapis.com/samrad-mars/www-assets/assets/","images/").concat(e.id,".gif")}),r.default.createElement("div",{className:"title__text__wrapper"},r.default.createElement("span",{className:"title__text"},e.title))),r.default.createElement("div",{className:"project__desc"},e.projectNote))};t.default=i},function(e,t){},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetch=a,t.fetchJson=function(e){return a(e).then(function(e){var t=e.json();return t})};var o,r=(o=n(346))&&o.__esModule?o:{default:o};function i(e){if(e.status>=200&&e.status<300)return e;var t=new Error(e.statusText);throw t.response=e,t}function a(e){return(0,r.default)(e).then(i)}n(344).polyfill()},,,function(e,t){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(350);var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}(n(2)),r=(l(n(349)),n(60),n(90)),i=n(347),a=l(n(342)),s=l(n(154)),u=l(n(293));function l(e){return e&&e.__esModule?e:{default:e}}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function h(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var d=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))).state={copy:null,projects:[]},n}var n,r,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),n=t,(r=[{key:"componentDidMount",value:function(){var e=this,t="assets/json/projects.json?z=".concat(Math.random()),n=((0,i.fetchJson)(t).then(function(t){e.setState({projects:t.map(function(e){return(0,a.default)(e)})})}),"assets/json/copy.json?z=".concat(Math.random()));(0,i.fetchJson)(n).then(function(t){e.setState({copy:t})})}},{key:"render",value:function(){this.props.browser;var e=this.state.copy;return e?o.default.createElement("div",{className:"o-page"},o.default.createElement(u.default,null),o.default.createElement("div",{className:"o-page home"},o.default.createElement("h1",{className:"home__title"},e.pages.home.title),o.default.createElement("p",{className:"home__desc"},(0,s.default)(e.pages.home.titleDesc)),this.state.projects)):o.default.createElement("div",null)}}])&&f(n.prototype,r),l&&f(n,l),t}();Object.defineProperty(d,"propTypes",{configurable:!0,enumerable:!0,writable:!0,value:{browser:o.PropTypes.object.isRequired}});var v=(0,r.connect)(function(e){return{browser:e.browser}})(d);t.default=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return o.default.createElement(r.Route,{path:"/",component:i.default},o.default.createElement(r.IndexRoute,{component:i.default}))};var o=a(n(2)),r=n(60),i=a(n(351));function a(e){return e&&e.__esModule?e:{default:e}}},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case o.RESIZE:return e.set("width",t.payload.width).set("height",t.payload.height);case o.ORIENTATION_CHANGE:return e.set("orientation",t.payload);default:return e}};var o=n(156),r=new((0,n(356).Record)({width:window.innerWidth,height:window.innerHeight,orientation:window.orientation}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=n(83),i=n(72),a=n(155),s=(o=n(357))&&o.__esModule?o:{default:o};var u=(0,i.combineReducers)({routing:r.routerReducer,resize:s.default,browser:(0,a.createResponsiveStateReducer)({mobile:360,phablet:540,tablet:768,tabletH:1024,desktop:1280,desktopM:1440,desktopL:1680,desktopXL:1920})});t.default=u},,function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.initialState,n=void 0===t?{}:t,c=e.browserHistory,h=void 0===c?{}:c,d=[];d.push(r.default,(0,l.default)({promiseTypeSuffixes:["START","SUCCESS","ERROR"]}),(0,s.routerMiddleware)(h)),f&&d.push((0,a.default)());var v=(f?(0,o.compose)(u.responsiveStoreEnhancer,o.applyMiddleware.apply(void 0,d),window.devToolsExtension()):(0,o.compose)(u.responsiveStoreEnhancer,o.applyMiddleware.apply(void 0,d)))(o.createStore)(i.default,n);0;return v};var o=n(72),r=c(n(359)),i=c(n(358)),a=c(n(355)),s=n(83),u=n(155),l=c(n(354));function c(e){return e&&e.__esModule?e:{default:e}}var f=e.env.DEV}).call(this,n(36))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},,function(e,t,n){"use strict";n(486);var o=h(n(2)),r=h(n(478)),i=n(90),a=n(392),s=n(60),u=n(83),l=n(156),c=h(n(360)),f=h(n(352));function h(e){return e&&e.__esModule?e:{default:e}}h(n(211)).default.attach(document.body);var d=(0,s.useRouterHistory)(a.createHistory)({basename:"/mars.wtf"}),v=(0,c.default)({browserHistory:d}),p=(0,u.syncHistoryWithStore)(d,v),_=(0,f.default)();window.addEventListener("resize",function(){v.dispatch({type:l.RESIZE,payload:{width:window.innerWidth,height:window.innerHeight}})}),window.addEventListener("orientationchange",function(){v.dispatch({type:l.ORIENTATION_CHANGE,payload:window.orientation})}),r.default.render(o.default.createElement(i.Provider,{store:v},o.default.createElement(s.Router,{history:p},_)),document.getElementById("app"))}]]);